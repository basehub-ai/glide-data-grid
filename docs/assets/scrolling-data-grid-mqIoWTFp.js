import{j as B,a as he,F as me,s as Ce}from"./marked.esm-0svxPciP.js";import{r as t}from"./index-BMVQvedj.js";import{c as Re}from"./throttle-7EuXLZa7.js";import{Q as Se,R as we,u as ve}from"./image-window-loader-k34PkBh4.js";function de(e,h,R,o){return Re(Math.round(h-(e.growOffset??0)),Math.ceil(R),Math.floor(o))}const De=e=>{const[h,R]=t.useState(),[o,H]=t.useState(),[l,I]=t.useState(),[g,v]=t.useState(),[S,y]=t.useState(!1),[L,d]=t.useState(),[D,X]=t.useState(),[K,A]=t.useState(),[P,q]=t.useState(!1),[ce,ie]=t.useState(),{onHeaderMenuClick:G,onHeaderIndicatorClick:J,getCellContent:U,onColumnMoved:Z,onColumnResize:c,onColumnResizeStart:V,onColumnResizeEnd:T,gridRef:N,maxColumnWidth:F,minColumnWidth:W,onRowMoved:x,lockColumns:p,onColumnProposeMove:Y,onMouseDown:j,onMouseUp:_,onItemHovered:re,onDragStart:n,canvasRef:O}=e,z=(c??T??V)!==void 0,{columns:a,selection:$}=e,M=$.columns,s=t.useCallback(r=>{const[u,w]=r.location;l!==void 0&&g!==u&&u>=p?(y(!0),v(u)):D!==void 0&&w!==void 0?(q(!0),A(Math.max(0,w))):o===void 0&&!S&&!P&&(re==null||re(r))},[l,D,g,re,p,o,S,P]),i=Z!==void 0,m=t.useCallback(r=>{var u;if(r.button===0){const[w,f]=r.location;if(r.kind==="out-of-bounds"&&r.isEdge&&z){const b=(u=N==null?void 0:N.current)==null?void 0:u.getBounds(a.length-1,-1);b!==void 0&&(R(b.x),H(a.length-1))}else if(r.kind==="header"&&w>=p){const b=O==null?void 0:O.current;if(r.isEdge&&z&&b){R(r.bounds.x),H(w);const ue=b.getBoundingClientRect().width/b.offsetWidth,ae=r.bounds.width/ue;V==null||V(a[w],ae,w,ae+(a[w].growOffset??0))}else r.kind==="header"&&i&&(d(r.bounds.x),I(w))}else r.kind==="cell"&&p>0&&w===0&&f!==void 0&&x!==void 0&&(ie(r.bounds.y),X(f))}j==null||j(r)},[j,z,p,x,N,a,i,V,O]),ee=t.useCallback((r,u)=>{S||P||G==null||G(r,u)},[S,P,G]),te=t.useCallback((r,u)=>{S||P||J==null||J(r,u)},[S,P,J]),E=t.useRef(-1),Q=t.useCallback(()=>{E.current=-1,X(void 0),A(void 0),ie(void 0),q(!1),I(void 0),v(void 0),d(void 0),y(!1),H(void 0),R(void 0)},[]),C=t.useCallback((r,u)=>{if(r.button===0){if(o!==void 0){if((M==null?void 0:M.hasIndex(o))===!0)for(const f of M){if(f===o)continue;const b=a[f],ne=de(b,E.current,W,F);c==null||c(b,ne,f,ne+(b.growOffset??0))}const w=de(a[o],E.current,W,F);if(T==null||T(a[o],w,o,w+(a[o].growOffset??0)),M.hasIndex(o))for(const f of M){if(f===o)continue;const b=a[f],ne=de(b,E.current,W,F);T==null||T(b,ne,f,ne+(b.growOffset??0))}}Q(),l!==void 0&&g!==void 0&&(Z==null||Z(l,g)),D!==void 0&&K!==void 0&&(x==null||x(D,K))}_==null||_(r,u)},[_,o,l,g,D,K,M,T,a,W,F,c,Z,x,Q]),k=t.useMemo(()=>{if(!(l===void 0||g===void 0)&&l!==g&&(Y==null?void 0:Y(l,g))!==!1)return{src:l,dest:g}},[l,g,Y]),oe=t.useCallback(r=>{const u=O==null?void 0:O.current;if(l!==void 0&&L!==void 0)Math.abs(r.clientX-L)>20&&y(!0);else if(D!==void 0&&ce!==void 0)Math.abs(r.clientY-ce)>20&&q(!0);else if(o!==void 0&&h!==void 0&&u){const f=u.getBoundingClientRect().width/u.offsetWidth,b=(r.clientX-h)/f,ne=a[o],ue=de(ne,b,W,F);if(c==null||c(ne,ue,o,ue+(ne.growOffset??0)),E.current=b,(M==null?void 0:M.first())===o)for(const ae of M){if(ae===o)continue;const fe=a[ae],ge=de(fe,E.current,W,F);c==null||c(fe,ge,ae,ge+(fe.growOffset??0))}}},[l,L,D,ce,o,h,a,W,F,c,M,O]),le=t.useCallback((r,u)=>{if(D===void 0||K===void 0)return U(r,u);let[w,f]=r;return f===K?f=D:(f>K&&(f-=1),f>=D&&(f+=1)),U([w,f],u)},[D,K,U]),se=t.useCallback(r=>{n==null||n(r),r.defaultPrevented()||Q()},[Q,n]);return B(Se,{accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,enableGroups:e.enableGroups,eventTargetRef:e.eventTargetRef,experimental:e.experimental,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,headerIcons:e.headerIcons,height:e.height,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,resizeColumn:o,isDraggable:e.isDraggable,isFilling:e.isFilling,isFocused:e.isFocused,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDrop:e.onDrop,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,resizeIndicator:e.resizeIndicator,verticalBorder:e.verticalBorder,width:e.width,getCellContent:le,isResizing:o!==void 0,onHeaderMenuClick:ee,onHeaderIndicatorClick:te,isDragging:S,onItemHovered:s,onDragStart:se,onMouseDown:m,allowResize:z,onMouseUp:C,dragAndDropState:k,onMouseMoveRaw:oe,ref:N})},be=De;function He(e){const h=t.useRef(null),[R,o]=t.useState({width:e==null?void 0:e[0],height:e==null?void 0:e[1]});return t.useLayoutEffect(()=>{const H=I=>{for(const g of I){const{width:v,height:S}=g&&g.contentRect||{};o(y=>y.width===v&&y.height===S?y:{width:v,height:S})}},l=new window.ResizeObserver(H);return h.current&&l.observe(h.current,void 0),()=>{l.disconnect()}},[h.current]),{ref:h,...R}}const ye=(e,h,R)=>{const o=t.useRef(null),H=t.useRef(null),l=t.useRef(null),I=t.useRef(0),g=t.useRef(h);g.current=h;const v=R.current;t.useEffect(()=>{const S=()=>{var d,D;if(H.current===!1&&v!==null){const X=[v.scrollLeft,v.scrollTop];if(((d=l.current)==null?void 0:d[0])===X[0]&&((D=l.current)==null?void 0:D[1])===X[1])if(I.current>10){l.current=null,H.current=null;return}else I.current++;else I.current=0,g.current(X[0],X[1]),l.current=X;o.current=window.setTimeout(S,8.333333333333334)}},y=()=>{H.current=!0,l.current=null,o.current!==null&&(window.clearTimeout(o.current),o.current=null)},L=d=>{d.touches.length===0&&(H.current=!1,I.current=0,o.current=window.setTimeout(S,8.333333333333334))};if(e&&v!==null){const d=v;return d.addEventListener("touchstart",y),d.addEventListener("touchend",L),()=>{d.removeEventListener("touchstart",y),d.removeEventListener("touchend",L),o.current!==null&&window.clearTimeout(o.current)}}},[e,v])},xe=ye,Me=()=>e=>e.isSafari?"scroll":"auto",ke=Ce("div")({name:"ScrollRegionStyle",class:"sj2f20c",propsAsIs:!1,vars:{"sj2f20c-0":[Me()]}});function Te(e){const[h,R]=t.useState(!1),o=typeof window>"u"?null:window,H=t.useRef(0);return ve("touchstart",t.useCallback(()=>{window.clearTimeout(H.current),R(!0)},[]),o,!0,!1),ve("touchend",t.useCallback(l=>{l.touches.length===0&&(H.current=window.setTimeout(()=>R(!1),e))},[e]),o,!0,!1),h}const Oe=e=>{var $,M;const{children:h,clientHeight:R,scrollHeight:o,scrollWidth:H,update:l,draggable:I,className:g,preventDiagonalScrolling:v=!1,paddingBottom:S=0,paddingRight:y=0,rightElement:L,rightElementProps:d,kineticScrollPerfHack:D=!1,scrollRef:X,initialSize:K,scrollerRef:A,scrollOffsetTop:P}=e,q=[],ce=(d==null?void 0:d.sticky)??!1,ie=(d==null?void 0:d.fill)??!1,G=t.useRef(0),J=t.useRef(0),U=t.useRef((A==null?void 0:A.current)??null),Z=typeof window>"u"?1:window.devicePixelRatio,c=t.useRef({scrollLeft:0,scrollTop:0,lockDirection:void 0}),V=t.useRef(null),T=Te(200),[N,F]=t.useState(!0),W=t.useRef(0);t.useLayoutEffect(()=>{if(!N||T||c.current.lockDirection===void 0)return;const s=U.current;if(s===null)return;const[i,m]=c.current.lockDirection;i!==void 0?s.scrollLeft=i:m!==void 0&&(s.scrollTop=m),c.current.lockDirection=void 0},[T,N]);const x=t.useCallback((s,i)=>{var w;const m=U.current;if(m===null)return;i=i??m.scrollTop,s=s??m.scrollLeft;const ee=c.current.scrollTop,te=c.current.scrollLeft,E=s-te,Q=i-ee,C=P??0;C&&(i=Math.max(0,i-C)),T&&E!==0&&Q!==0&&(Math.abs(E)>3||Math.abs(Q)>3)&&v&&c.current.lockDirection===void 0&&(c.current.lockDirection=Math.abs(E)<Math.abs(Q)?[te,void 0]:[void 0,ee]);const k=c.current.lockDirection;s=(k==null?void 0:k[0])??s,i=(k==null?void 0:k[1])??i,c.current.scrollLeft=s,c.current.scrollTop=i;const oe=m.clientWidth,le=m.clientHeight,se=i,r=J.current-se,u=m.scrollHeight-le;if(J.current=se,u>0&&(Math.abs(r)>2e3||se===0||se===u)&&o>m.scrollHeight+5){const f=se/u,b=(o-le)*f;G.current=b-se}k!==void 0&&(window.clearTimeout(W.current),F(!1),W.current=window.setTimeout(()=>F(!0),200)),l({x:s,y:se+G.current,width:oe-y,height:le-S,paddingRight:((w=V.current)==null?void 0:w.clientWidth)??0})},[S,y,o,l,v,T,P]);xe(D&&we.value,x,U);const p=t.useRef(x);p.current=x;const Y=t.useRef(),j=t.useRef(!1);t.useLayoutEffect(()=>{j.current?x():j.current=!0},[x,S,y]);const _=t.useCallback(s=>{const i=(A==null?void 0:A.current)??s;U.current=i,X!==void 0&&(X.current=i)},[X,A]);let re=0,n=0;for(q.push(B("div",{style:{width:H,height:0}},re++));n<o;){const s=Math.min(5e6,o-n);q.push(B("div",{style:{width:0,height:s}},re++)),n+=s}const{ref:O,width:z,height:a}=He(K);return t.useEffect(()=>{const s=U.current;if(!s)return;const i=()=>{x()};return s.addEventListener("scroll",i),()=>{s.removeEventListener("scroll",i)}},[x]),typeof window<"u"&&((($=Y.current)==null?void 0:$.height)!==a||((M=Y.current)==null?void 0:M.width)!==z)&&(window.setTimeout(()=>p.current(),0),Y.current={width:z,height:a}),(z??0)===0||(a??0)===0?B("div",{ref:O}):B("div",{ref:O,children:he(ke,{isSafari:we.value,children:[B("div",{className:"dvn-underlay",children:h}),B("div",{ref:_,style:Y.current,draggable:I,onDragStart:s=>{I||(s.stopPropagation(),s.preventDefault())},className:"dvn-scroller "+(g??""),children:he("div",{className:"dvn-scroll-inner"+(L===void 0?" dvn-hidden":""),children:[B("div",{className:"dvn-stack",children:q}),L!==void 0&&he(me,{children:[!ie&&B("div",{className:"dvn-spacer"}),B("div",{ref:V,style:{height:a,maxHeight:R-Math.ceil(Z%1),position:"sticky",top:0,paddingLeft:1,marginBottom:-40,marginRight:y,flexGrow:ie?1:void 0,right:ce?y??0:void 0,pointerEvents:"auto"},children:L})]})]})})]})})},Ie=e=>{const{columns:h,rows:R,rowHeight:o,headerHeight:H,groupHeaderHeight:l,enableGroups:I,freezeColumns:g,experimental:v,nonGrowWidth:S,clientSize:y,className:L,onVisibleRegionChanged:d,scrollRef:D,preventDiagonalScrolling:X,rightElement:K,rightElementProps:A,overscrollX:P,overscrollY:q,initialSize:ce,smoothScrollX:ie=!1,smoothScrollY:G=!1,isDraggable:J,scrollerRef:U}=e,{paddingRight:Z,paddingBottom:c}=v??{},[V,T]=y,N=t.useRef(),F=t.useRef(),W=t.useRef(),x=t.useRef(),p=S+Math.max(0,P??0);let Y=I?H+l:H;if(typeof o=="number")Y+=R*o;else for(let n=0;n<R;n++)Y+=o(n);q!==void 0&&(Y+=q);const j=t.useRef(),_=t.useCallback(()=>{var E,Q;if(j.current===void 0)return;const n={...j.current};let O=0,z=n.x<0?-n.x:0,a=0,$=0;n.x=n.x<0?0:n.x;let M=0;for(let C=0;C<g;C++)M+=h[C].width;for(const C of h){const k=O-M;if(n.x>=k+C.width)O+=C.width,$++,a++;else if(n.x>k)O+=C.width,ie?z+=k-n.x:$++,a++;else if(n.x+n.width>k)O+=C.width,a++;else break}let s=0,i=0,m=0;if(typeof o=="number")G?(i=Math.floor(n.y/o),s=i*o-n.y):i=Math.ceil(n.y/o),m=Math.ceil(n.height/o)+i,s<0&&m++;else{let C=0;for(let k=0;k<R;k++){const oe=o(k),le=C+(G?0:oe/2);if(n.y>=C+oe)C+=oe,i++,m++;else if(n.y>le)C+=oe,G?s+=le-n.y:i++,m++;else if(n.y+n.height>oe/2+C)C+=oe,m++;else break}}const ee={x:$,y:i,width:a-$,height:m-i},te=N.current;(te===void 0||te.y!==ee.y||te.x!==ee.x||te.height!==ee.height||te.width!==ee.width||F.current!==z||W.current!==s||n.width!==((E=x.current)==null?void 0:E[0])||n.height!==((Q=x.current)==null?void 0:Q[1]))&&(d==null||d({x:$,y:i,width:a-$,height:m-i},n.width,n.height,n.paddingRight??0,z,s),N.current=ee,F.current=z,W.current=s,x.current=[n.width,n.height])},[h,o,R,d,g,ie,G]),re=t.useCallback(n=>{j.current=n,_()},[_]);return t.useEffect(()=>{_()},[_]),B(Oe,{scrollRef:D,className:L,kineticScrollPerfHack:v==null?void 0:v.kineticScrollPerfHack,preventDiagonalScrolling:X,draggable:J===!0||typeof J=="string",scrollWidth:p+(Z??0),scrollHeight:Y+(c??0),clientHeight:T,rightElement:K,paddingBottom:c,paddingRight:Z,rightElementProps:A,update:re,initialSize:ce,scrollerRef:U,scrollOffsetTop:e.scrollOffsetTop,children:B(be,{eventTargetRef:D,width:V,height:T,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,onColumnProposeMove:e.onColumnProposeMove,verticalBorder:e.verticalBorder,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator})})},ze=Ie;export{ze as G};
