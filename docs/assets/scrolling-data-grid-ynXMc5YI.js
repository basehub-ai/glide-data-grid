import{j as J,a as he,F as me,s as Ce}from"./marked.esm-0svxPciP.js";import{r as t}from"./index-BMVQvedj.js";import{c as Re}from"./throttle-7EuXLZa7.js";import{Q as Se,R as we,u as ve}from"./image-window-loader-70g6tesQ.js";function de(e,h,R,o){return Re(Math.round(h-(e.growOffset??0)),Math.ceil(R),Math.floor(o))}const De=e=>{const[h,R]=t.useState(),[o,b]=t.useState(),[l,I]=t.useState(),[g,v]=t.useState(),[S,H]=t.useState(!1),[K,a]=t.useState(),[D,X]=t.useState(),[Z,P]=t.useState(),[V,ne]=t.useState(!1),[re,le]=t.useState(),{onHeaderMenuClick:U,onHeaderIndicatorClick:te,getCellContent:se,onColumnMoved:Y,onColumnResize:M,onColumnResizeStart:y,onColumnResizeEnd:F,gridRef:W,maxColumnWidth:z,minColumnWidth:E,onRowMoved:L,lockColumns:O,onColumnProposeMove:N,onMouseDown:B,onMouseUp:j,onItemHovered:ie,onDragStart:n,canvasRef:k}=e,$=(M??F??y)!==void 0,{columns:d,selection:A}=e,x=A.columns,p=t.useCallback(s=>{const[c,m]=s.location;l!==void 0&&g!==c&&c>=O?(H(!0),v(c)):D!==void 0&&m!==void 0?(ne(!0),P(Math.max(0,m))):o===void 0&&!S&&!V&&(ie==null||ie(s))},[l,D,g,ie,O,o,S,V]),r=Y!==void 0,i=t.useCallback(s=>{var c;if(s.button===0){const[m,u]=s.location;if(s.kind==="out-of-bounds"&&s.isEdge&&$){const C=(c=W==null?void 0:W.current)==null?void 0:c.getBounds(d.length-1,-1);C!==void 0&&(R(C.x),b(d.length-1))}else if(s.kind==="header"&&m>=O){const C=k==null?void 0:k.current;if(s.isEdge&&$&&C){R(s.bounds.x),b(m);const ce=C.getBoundingClientRect().width/C.offsetWidth,ae=s.bounds.width/ce;y==null||y(d[m],ae,m,ae+(d[m].growOffset??0))}else s.kind==="header"&&r&&(a(s.bounds.x),I(m))}else s.kind==="cell"&&O>0&&m===0&&u!==void 0&&L!==void 0&&(le(s.bounds.y),X(u))}B==null||B(s)},[B,$,O,L,W,d,r,y,k]),f=t.useCallback((s,c)=>{S||V||U==null||U(s,c)},[S,V,U]),oe=t.useCallback((s,c)=>{S||V||te==null||te(s,c)},[S,V,te]),_=t.useRef(-1),ee=t.useCallback(()=>{_.current=-1,X(void 0),P(void 0),le(void 0),ne(!1),I(void 0),v(void 0),a(void 0),H(!1),b(void 0),R(void 0)},[]),w=t.useCallback((s,c)=>{if(s.button===0){if(o!==void 0){if((x==null?void 0:x.hasIndex(o))===!0)for(const u of x){if(u===o)continue;const C=d[u],G=de(C,_.current,E,z);M==null||M(C,G,u,G+(C.growOffset??0))}const m=de(d[o],_.current,E,z);if(F==null||F(d[o],m,o,m+(d[o].growOffset??0)),x.hasIndex(o))for(const u of x){if(u===o)continue;const C=d[u],G=de(C,_.current,E,z);F==null||F(C,G,u,G+(C.growOffset??0))}}ee(),l!==void 0&&g!==void 0&&(Y==null||Y(l,g)),D!==void 0&&Z!==void 0&&(L==null||L(D,Z))}j==null||j(s,c)},[j,o,l,g,D,Z,x,F,d,E,z,M,Y,L,ee]),T=t.useMemo(()=>{if(!(l===void 0||g===void 0)&&l!==g&&(N==null?void 0:N(l,g))!==!1)return{src:l,dest:g}},[l,g,N]),Q=t.useCallback(s=>{const c=k==null?void 0:k.current;if(l!==void 0&&K!==void 0)Math.abs(s.clientX-K)>20&&H(!0);else if(D!==void 0&&re!==void 0)Math.abs(s.clientY-re)>20&&ne(!0);else if(o!==void 0&&h!==void 0&&c){const u=c.getBoundingClientRect().width/c.offsetWidth,C=(s.clientX-h)/u,G=d[o],ce=de(G,C,E,z);if(M==null||M(G,ce,o,ce+(G.growOffset??0)),_.current=C,(x==null?void 0:x.first())===o)for(const ae of x){if(ae===o)continue;const fe=d[ae],ge=de(fe,_.current,E,z);M==null||M(fe,ge,ae,ge+(fe.growOffset??0))}}},[l,K,D,re,o,h,d,E,z,M,x,k]),q=t.useCallback((s,c)=>{if(D===void 0||Z===void 0)return se(s,c);let[m,u]=s;return u===Z?u=D:(u>Z&&(u-=1),u>=D&&(u+=1)),se([m,u],c)},[D,Z,se]),ue=t.useCallback(s=>{n==null||n(s),s.defaultPrevented()||ee()},[ee,n]);return J(Se,{accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,enableGroups:e.enableGroups,eventTargetRef:e.eventTargetRef,experimental:e.experimental,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,headerIcons:e.headerIcons,height:e.height,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,resizeColumn:o,isDraggable:e.isDraggable,isFilling:e.isFilling,isFocused:e.isFocused,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDrop:e.onDrop,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,resizeIndicator:e.resizeIndicator,verticalBorder:e.verticalBorder,width:e.width,getCellContent:q,isResizing:o!==void 0,onHeaderMenuClick:f,onHeaderIndicatorClick:oe,isDragging:S,onItemHovered:p,onDragStart:ue,onMouseDown:i,allowResize:$,onMouseUp:w,dragAndDropState:T,onMouseMoveRaw:Q,ref:W})},be=De;function He(e){const h=t.useRef(null),[R,o]=t.useState({width:e==null?void 0:e[0],height:e==null?void 0:e[1]});return t.useLayoutEffect(()=>{const b=I=>{for(const g of I){const{width:v,height:S}=g&&g.contentRect||{};o(H=>H.width===v&&H.height===S?H:{width:v,height:S})}},l=new window.ResizeObserver(b);return h.current&&l.observe(h.current,void 0),()=>{l.disconnect()}},[h.current]),{ref:h,...R}}const ye=(e,h,R)=>{const o=t.useRef(null),b=t.useRef(null),l=t.useRef(null),I=t.useRef(0),g=t.useRef(h);g.current=h;const v=R.current;t.useEffect(()=>{const S=()=>{var a,D;if(b.current===!1&&v!==null){const X=[v.scrollLeft,v.scrollTop];if(((a=l.current)==null?void 0:a[0])===X[0]&&((D=l.current)==null?void 0:D[1])===X[1])if(I.current>10){l.current=null,b.current=null;return}else I.current++;else I.current=0,g.current(X[0],X[1]),l.current=X;o.current=window.setTimeout(S,8.333333333333334)}},H=()=>{b.current=!0,l.current=null,o.current!==null&&(window.clearTimeout(o.current),o.current=null)},K=a=>{a.touches.length===0&&(b.current=!1,I.current=0,o.current=window.setTimeout(S,8.333333333333334))};if(e&&v!==null){const a=v;return a.addEventListener("touchstart",H),a.addEventListener("touchend",K),()=>{a.removeEventListener("touchstart",H),a.removeEventListener("touchend",K),o.current!==null&&window.clearTimeout(o.current)}}},[e,v])},xe=ye,Me=()=>e=>e.isSafari?"scroll":"auto",ke=Ce("div")({name:"ScrollRegionStyle",class:"sj2f20c",propsAsIs:!1,vars:{"sj2f20c-0":[Me()]}});function Oe(e){const[h,R]=t.useState(!1),o=typeof window>"u"?null:window,b=t.useRef(0);return ve("touchstart",t.useCallback(()=>{window.clearTimeout(b.current),R(!0)},[]),o,!0,!1),ve("touchend",t.useCallback(l=>{l.touches.length===0&&(b.current=window.setTimeout(()=>R(!1),e))},[e]),o,!0,!1),h}const Te=e=>{var x,p;const{children:h,clientHeight:R,scrollHeight:o,scrollWidth:b,update:l,draggable:I,className:g,preventDiagonalScrolling:v=!1,paddingBottom:S=0,paddingRight:H=0,rightElement:K,rightElementProps:a,kineticScrollPerfHack:D=!1,scrollRef:X,initialSize:Z,scrollerRef:P,scrollOffsetTop:V,scrollOffsetBottom:ne}=e,re=[],le=(a==null?void 0:a.sticky)??!1,U=(a==null?void 0:a.fill)??!1,te=t.useRef(0),se=t.useRef(0),Y=t.useRef((P==null?void 0:P.current)??null),M=typeof window>"u"?1:window.devicePixelRatio,y=t.useRef({scrollLeft:0,scrollTop:0,lockDirection:void 0}),F=t.useRef(null),W=Oe(200),[z,E]=t.useState(!0),L=t.useRef(0);t.useLayoutEffect(()=>{if(!z||W||y.current.lockDirection===void 0)return;const r=Y.current;if(r===null)return;const[i,f]=y.current.lockDirection;i!==void 0?r.scrollLeft=i:f!==void 0&&(r.scrollTop=f),y.current.lockDirection=void 0},[W,z]);const O=t.useCallback((r,i)=>{var C;const f=Y.current;if(f===null)return;i=i??f.scrollTop,r=r??f.scrollLeft;const oe=y.current.scrollTop,_=y.current.scrollLeft,ee=r-_,w=i-oe,T=V??0,Q=ne??0;T&&(i=Math.max(0,i-T)),Q&&f.scrollHeight-i-f.clientHeight-T<Q&&(i=f.scrollHeight-T-f.clientHeight-Q),W&&ee!==0&&w!==0&&(Math.abs(ee)>3||Math.abs(w)>3)&&v&&y.current.lockDirection===void 0&&(y.current.lockDirection=Math.abs(ee)<Math.abs(w)?[_,void 0]:[void 0,oe]);const q=y.current.lockDirection;r=(q==null?void 0:q[0])??r,i=(q==null?void 0:q[1])??i,y.current.scrollLeft=r,y.current.scrollTop=i;const ue=f.clientWidth,s=f.clientHeight,c=i,m=se.current-c,u=f.scrollHeight-s;if(se.current=c,u>0&&(Math.abs(m)>2e3||c===0||c===u)&&o>f.scrollHeight+5){const G=c/u,ce=(o-s)*G;te.current=ce-c}q!==void 0&&(window.clearTimeout(L.current),E(!1),L.current=window.setTimeout(()=>E(!0),200)),l({x:r,y:c+te.current,width:ue-H,height:s-S,paddingRight:((C=F.current)==null?void 0:C.clientWidth)??0})},[V,ne,W,v,o,l,H,S]);xe(D&&we.value,O,Y);const N=t.useRef(O);N.current=O;const B=t.useRef(),j=t.useRef(!1);t.useLayoutEffect(()=>{j.current?O():j.current=!0},[O,S,H]);const ie=t.useCallback(r=>{const i=(P==null?void 0:P.current)??r;Y.current=i,X!==void 0&&(X.current=r)},[X,P]);let n=0,k=0;for(re.push(J("div",{style:{width:b,height:0}},n++));k<o;){const r=Math.min(5e6,o-k);re.push(J("div",{style:{width:0,height:r}},n++)),k+=r}const{ref:$,width:d,height:A}=He(Z);return t.useEffect(()=>{const r=Y.current;if(!r)return;const i=()=>{O()};return r.addEventListener("scroll",i),()=>{r.removeEventListener("scroll",i)}},[O]),typeof window<"u"&&(((x=B.current)==null?void 0:x.height)!==A||((p=B.current)==null?void 0:p.width)!==d)&&(window.setTimeout(()=>N.current(),0),B.current={width:d,height:A}),(d??0)===0||(A??0)===0?J("div",{ref:$}):J("div",{ref:$,children:he(ke,{isSafari:we.value,children:[J("div",{className:"dvn-underlay",children:h}),J("div",{ref:ie,style:B.current,draggable:I,onDragStart:r=>{I||(r.stopPropagation(),r.preventDefault())},className:"dvn-scroller "+(g??""),children:he("div",{className:"dvn-scroll-inner"+(K===void 0?" dvn-hidden":""),children:[J("div",{className:"dvn-stack",children:re}),K!==void 0&&he(me,{children:[!U&&J("div",{className:"dvn-spacer"}),J("div",{ref:F,style:{height:A,maxHeight:R-Math.ceil(M%1),position:"sticky",top:0,paddingLeft:1,marginBottom:-40,marginRight:H,flexGrow:U?1:void 0,right:le?H??0:void 0,pointerEvents:"auto"},children:K})]})]})})]})})},Ie=e=>{const{columns:h,rows:R,rowHeight:o,headerHeight:b,groupHeaderHeight:l,enableGroups:I,freezeColumns:g,experimental:v,nonGrowWidth:S,clientSize:H,className:K,onVisibleRegionChanged:a,scrollRef:D,preventDiagonalScrolling:X,rightElement:Z,rightElementProps:P,overscrollX:V,overscrollY:ne,initialSize:re,smoothScrollX:le=!1,smoothScrollY:U=!1,isDraggable:te,scrollerRef:se}=e,{paddingRight:Y,paddingBottom:M}=v??{},[y,F]=H,W=t.useRef(),z=t.useRef(),E=t.useRef(),L=t.useRef(),O=S+Math.max(0,V??0);let N=I?b+l:b;if(typeof o=="number")N+=R*o;else for(let n=0;n<R;n++)N+=o(n);ne!==void 0&&(N+=ne);const B=t.useRef(),j=t.useCallback(()=>{var _,ee;if(B.current===void 0)return;const n={...B.current};let k=0,$=n.x<0?-n.x:0,d=0,A=0;n.x=n.x<0?0:n.x;let x=0;for(let w=0;w<g;w++)x+=h[w].width;for(const w of h){const T=k-x;if(n.x>=T+w.width)k+=w.width,A++,d++;else if(n.x>T)k+=w.width,le?$+=T-n.x:A++,d++;else if(n.x+n.width>T)k+=w.width,d++;else break}let p=0,r=0,i=0;if(typeof o=="number")U?(r=Math.floor(n.y/o),p=r*o-n.y):r=Math.ceil(n.y/o),i=Math.ceil(n.height/o)+r,p<0&&i++;else{let w=0;for(let T=0;T<R;T++){const Q=o(T),q=w+(U?0:Q/2);if(n.y>=w+Q)w+=Q,r++,i++;else if(n.y>q)w+=Q,U?p+=q-n.y:r++,i++;else if(n.y+n.height>Q/2+w)w+=Q,i++;else break}}const f={x:A,y:r,width:d-A,height:i-r},oe=W.current;(oe===void 0||oe.y!==f.y||oe.x!==f.x||oe.height!==f.height||oe.width!==f.width||z.current!==$||E.current!==p||n.width!==((_=L.current)==null?void 0:_[0])||n.height!==((ee=L.current)==null?void 0:ee[1]))&&(a==null||a({x:A,y:r,width:d-A,height:i-r},n.width,n.height,n.paddingRight??0,$,p),W.current=f,z.current=$,E.current=p,L.current=[n.width,n.height])},[h,o,R,a,g,le,U]),ie=t.useCallback(n=>{B.current=n,j()},[j]);return t.useEffect(()=>{j()},[j]),J(Te,{scrollRef:D,className:K,kineticScrollPerfHack:v==null?void 0:v.kineticScrollPerfHack,preventDiagonalScrolling:X,draggable:te===!0||typeof te=="string",scrollWidth:O+(Y??0),scrollHeight:N+(M??0),clientHeight:F,rightElement:Z,paddingBottom:M,paddingRight:Y,rightElementProps:P,update:ie,initialSize:re,scrollerRef:se,scrollOffsetTop:e.scrollOffsetTop,scrollOffsetBottom:e.scrollOffsetBottom,children:J(be,{eventTargetRef:D,width:y,height:F,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,onColumnProposeMove:e.onColumnProposeMove,verticalBorder:e.verticalBorder,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator})})},ze=Ie;export{ze as G};
