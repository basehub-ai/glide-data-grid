var pa=Object.defineProperty;var wa=(e,t,n)=>t in e?pa(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Oe=(e,t,n)=>(wa(e,typeof t!="symbol"?t+"":t,n),n);import{s as Wt,m as ya,j as Xt,a as Ei}from"./marked.esm-0svxPciP.js";import{r as a,R as lt,g as ba}from"./index-BMVQvedj.js";import{u as Ca}from"./index.esm-Ejw8GwRl.js";import{y as En}from"./index-PWBWJyi_.js";import{m as va,k as xa,x as ka,y as Sa,z as Ma,A as Ra,e as Zl,a as Ea,w as Wr}from"./_baseIteratee-WTHxv43n.js";import{h as Ia,d as Jl,j as Fa,v as Da,_ as Ha,g as Ta,c as an,r as In,t as Aa,e as Ba}from"./throttle-7EuXLZa7.js";import{_ as Ql}from"./iframe-vTKsg95g.js";import{u as za,f as sl}from"./flatten-qRvRBp6y.js";function es(e="This should not happen"){throw new Error(e)}function Jt(e,t="Assertion failed"){if(!e)return es(t)}function ur(e,t){return es(t??"Hell froze over")}function La(e,t){try{return e()}catch{return t}}const al=Object.prototype.hasOwnProperty;function $o(e,t){let n,o;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((o=e.length)===t.length)for(;o--&&$o(e[o],t[o]););return o===-1}if(!n||typeof e=="object"){o=0;for(n in e)if(al.call(e,n)&&++o&&!al.call(t,n)||!(n in t)||!$o(e[n],t[n]))return!1;return Object.keys(t).length===o}}return e!==e&&t!==t}const _r=null,Bi=void 0;var U;(function(e){e.Uri="uri",e.Text="text",e.Image="image",e.RowID="row-id",e.Number="number",e.Bubble="bubble",e.Boolean="boolean",e.Loading="loading",e.Markdown="markdown",e.Drilldown="drilldown",e.Protected="protected",e.Custom="custom"})(U||(U={}));var Pn;(function(e){e.HeaderRowID="headerRowID",e.HeaderCode="headerCode",e.HeaderNumber="headerNumber",e.HeaderString="headerString",e.HeaderBoolean="headerBoolean",e.HeaderAudioUri="headerAudioUri",e.HeaderVideoUri="headerVideoUri",e.HeaderEmoji="headerEmoji",e.HeaderImage="headerImage",e.HeaderUri="headerUri",e.HeaderPhone="headerPhone",e.HeaderMarkdown="headerMarkdown",e.HeaderDate="headerDate",e.HeaderTime="headerTime",e.HeaderEmail="headerEmail",e.HeaderReference="headerReference",e.HeaderIfThenElse="headerIfThenElse",e.HeaderSingleValue="headerSingleValue",e.HeaderLookup="headerLookup",e.HeaderTextTemplate="headerTextTemplate",e.HeaderMath="headerMath",e.HeaderRollup="headerRollup",e.HeaderJoinStrings="headerJoinStrings",e.HeaderSplitString="headerSplitString",e.HeaderGeoDistance="headerGeoDistance",e.HeaderArray="headerArray",e.RowOwnerOverlay="rowOwnerOverlay",e.ProtectedColumnOverlay="protectedColumnOverlay"})(Pn||(Pn={}));var Kr;(function(e){e.Triangle="triangle",e.Dots="dots"})(Kr||(Kr={}));function Or(e){return"width"in e&&typeof e.width=="number"}async function cl(e){return typeof e=="object"?e:await e()}function eo(e){return!(e.kind===U.Loading||e.kind===U.Bubble||e.kind===U.RowID||e.kind===U.Protected||e.kind===U.Drilldown)}function Pa(e){return!(e.kind===U.Loading||e.kind===U.Bubble||e.kind===U.RowID||e.kind===U.Protected||e.kind===U.Drilldown||e.kind===U.Boolean||e.kind===U.Image||e.kind===U.Custom)}function Bo(e){return e.kind===dn.Marker||e.kind===dn.NewRow}function lr(e){if(!eo(e)||e.kind===U.Image)return!1;if(e.kind===U.Text||e.kind===U.Number||e.kind===U.Markdown||e.kind===U.Uri||e.kind===U.Custom||e.kind===U.Boolean)return e.readonly!==!0;ur(e,"A cell was passed with an invalid kind")}function $a(e){return Ia(e,"editor")}function zi(e){return!(e.readonly??!1)}var dn;(function(e){e.NewRow="new-row",e.Marker="marker"})(dn||(dn={}));function Wa(e){if(e.length===0)return[];const t=[...e],n=[];t.sort(function(o,r){return o[0]-r[0]}),n.push([...t[0]]);for(const o of t.slice(1)){const r=n[n.length-1];r[1]<o[0]?n.push([...o]):r[1]<o[1]&&(r[1]=o[1])}return n}let dl;const Ln=class Ln{constructor(t){Oe(this,"items");this.items=t}offset(t){if(t===0)return this;const n=this.items.map(o=>[o[0]+t,o[1]+t]);return new Ln(n)}add(t){const n=typeof t=="number"?[t,t+1]:t,o=Wa([...this.items,n]);return new Ln(o)}remove(t){const n=[...this.items],o=typeof t=="number"?t:t[0],r=typeof t=="number"?t+1:t[1];for(const[i,l]of n.entries()){const[s,c]=l;if(s<=r&&o<=c){const f=[];s<o&&f.push([s,o]),r<c&&f.push([r,c]),n.splice(i,1,...f)}}return new Ln(n)}first(){if(this.items.length!==0)return this.items[0][0]}last(){if(this.items.length!==0)return this.items.slice(-1)[0][1]-1}hasIndex(t){for(let n=0;n<this.items.length;n++){const[o,r]=this.items[n];if(t>=o&&t<r)return!0}return!1}hasAll(t){for(let n=t[0];n<t[1];n++)if(!this.hasIndex(n))return!1;return!0}some(t){for(const n of this)if(t(n))return!0;return!1}equals(t){if(t===this)return!0;if(t.items.length!==this.items.length)return!1;for(let n=0;n<this.items.length;n++){const o=t.items[n],r=this.items[n];if(o[0]!==r[0]||o[1]!==r[1])return!1}return!0}toArray(){const t=[];for(const[n,o]of this.items)for(let r=n;r<o;r++)t.push(r);return t}get length(){let t=0;for(const[n,o]of this.items)t+=o-n;return t}*[Symbol.iterator](){for(const[t,n]of this.items)for(let o=t;o<n;o++)yield o}};Oe(Ln,"empty",()=>dl??(dl=new Ln([]))),Oe(Ln,"fromSingleSelection",t=>Ln.empty().add(t));let it=Ln;const Oa=Wt("div")({name:"ImageOverlayEditorStyle",class:"gdg-i2iowwq",propsAsIs:!1});function $t(e,t,n,o,r=!1){const i=a.useRef();i.current=t,a.useEffect(()=>{if(n===null||n.addEventListener===void 0)return;const l=n,s=c=>{var f;(f=i.current)==null||f.call(l,c)};return l.addEventListener(e,s,{passive:o,capture:r}),()=>{l.removeEventListener(e,s,{capture:r})}},[e,n,o,r])}function go(e,t){return e===void 0?void 0:t}const Na=Math.PI;function ul(e){return e*Na/180}const ts=(e,t,n)=>({x1:e-n/2,y1:t-n/2,x2:e+n/2,y2:t+n/2}),ns=(e,t,n,o,r)=>{switch(e){case"left":return Math.floor(t)+o+r/2;case"center":return Math.floor(t+n/2);case"right":return Math.floor(t+n)-o-r/2}},os=(e,t,n)=>Math.min(e,t-n*2),rs=(e,t,n)=>n.x1<=e&&e<=n.x2&&n.y1<=t&&t<=n.y2,Li=e=>{const t=e.fgColor??"currentColor";return a.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M12.7073 7.05029C7.87391 11.8837 10.4544 9.30322 6.03024 13.7273C5.77392 13.9836 5.58981 14.3071 5.50189 14.6587L4.52521 18.5655C4.38789 19.1148 4.88543 19.6123 5.43472 19.475L9.34146 18.4983C9.69313 18.4104 10.0143 18.2286 10.2706 17.9722L16.9499 11.2929",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}),a.createElement("path",{d:"M20.4854 4.92901L19.0712 3.5148C18.2901 2.73375 17.0238 2.73375 16.2428 3.5148L14.475 5.28257C15.5326 7.71912 16.4736 8.6278 18.7176 9.52521L20.4854 7.75744C21.2665 6.97639 21.2665 5.71006 20.4854 4.92901Z",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}))},Xa=e=>{const t=e.fgColor??"currentColor";return a.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M19 6L10.3802 17L5.34071 11.8758",vectorEffect:"non-scaling-stroke",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))};function Ga(e,t,n){const[o,r]=a.useState(e),i=a.useRef(!0);a.useEffect(()=>()=>{i.current=!1},[]);const l=a.useRef(Jl(s=>{i.current&&r(s)},n));return a.useLayoutEffect(()=>{i.current&&l.current(()=>e())},t),o}const Ua="֑-߿יִ-﷽ﹰ-ﻼ",Ya="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",_a=new RegExp("^[^"+Ya+"]*["+Ua+"]");function Pi(e){return _a.test(e)?"rtl":"not-rtl"}let Nr;function Ii(){if(typeof document>"u")return 0;if(Nr!==void 0)return Nr;const e=document.createElement("p");e.style.width="100%",e.style.height="200px";const t=document.createElement("div");t.id="testScrollbar",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.append(e),document.body.append(t);const n=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return n===o&&(o=t.clientWidth),t.remove(),Nr=n-o,Nr}const ho=Symbol();function Ka(e){const t=a.useRef([ho,e]);t.current[1]!==e&&(t.current[0]=e),t.current[1]=e;const[n,o]=a.useState(e),[,r]=a.useState(),i=a.useCallback(s=>{const c=t.current[0];c!==ho&&(s=typeof s=="function"?s(c):s,s===c)||(c!==ho&&r({}),o(f=>typeof s=="function"?s(c===ho?f:c):s),t.current[0]=ho)},[]),l=a.useCallback(()=>{t.current[0]=ho,r({})},[]);return[t.current[0]===ho?n:t.current[0],i,l]}function is(e){if(e.length===0)return"";let t=0,n=0;for(const o of e){if(n+=o.length,n>1e4)break;t++}return e.slice(0,t).join(", ")}function Va(e){const t=a.useRef(e);return $o(e,t.current)||(t.current=e),t.current}const ja=e=>{const{urls:t,canWrite:n,onEditClick:o,renderImage:r}=e,i=t.filter(s=>s!=="");if(i.length===0)return null;const l=i.length>1;return a.createElement(Oa,{"data-testid":"GDG-default-image-overlay-editor"},a.createElement(Fa.Carousel,{showArrows:l,showThumbs:!1,swipeable:l,emulateTouch:l,infiniteLoop:l},i.map(s=>{const c=(r==null?void 0:r(s))??a.createElement("img",{draggable:!1,src:s});return a.createElement("div",{className:"gdg-centering-container",key:s},c)})),n&&o&&a.createElement("button",{className:"gdg-edit-icon",onClick:o},a.createElement(Li,null)))},qa=Wt("div")({name:"MarkdownContainer",class:"gdg-mnuv029",propsAsIs:!1});class Za extends lt.PureComponent{constructor(){super(...arguments);Oe(this,"targetElement",null);Oe(this,"containerRefHook",n=>{this.targetElement=n,this.renderMarkdownIntoDiv()})}renderMarkdownIntoDiv(){const{targetElement:n,props:o}=this;if(n===null)return;const{contents:r,createNode:i}=o,l=ya(r),s=document.createRange();s.selectNodeContents(n),s.deleteContents();let c=i==null?void 0:i(l);if(c===void 0){const d=document.createElement("template");d.innerHTML=l,c=d.content}n.append(c);const f=n.getElementsByTagName("a");for(const d of f)d.target="_blank",d.rel="noreferrer noopener"}render(){return this.renderMarkdownIntoDiv(),lt.createElement(qa,{ref:this.containerRefHook})}}const Ja=Wt("textarea")({name:"InputBox",class:"gdg-izpuzkl",propsAsIs:!1}),Qa=Wt("div")({name:"ShadowBox",class:"gdg-s69h75o",propsAsIs:!1}),ec=Wt("div")({name:"GrowingEntryStyle",class:"gdg-g1y0xocz",propsAsIs:!1});let fl=0;const Jr=e=>{const{placeholder:t,value:n,onKeyDown:o,highlight:r,altNewline:i,validatedSelection:l,...s}=e,{onChange:c,className:f}=s,d=a.useRef(null),p=n??"";Jt(c!==void 0,"GrowingEntry must be a controlled input area");const[w]=a.useState(()=>"input-box-"+(fl=(fl+1)%1e7));a.useEffect(()=>{const h=d.current;if(h===null||h.disabled)return;const m=p.toString().length;h.focus(),h.setSelectionRange(r?0:m,m)},[]),a.useLayoutEffect(()=>{var h;if(l!==void 0){const m=typeof l=="number"?[l,null]:l;(h=d.current)==null||h.setSelectionRange(m[0],m[1])}},[l]);const g=a.useCallback(h=>{h.key==="Enter"&&h.shiftKey&&i===!0||o==null||o(h)},[i,o]);return a.createElement(ec,{className:"gdg-growing-entry"},a.createElement(Qa,{className:f},p+`
`),a.createElement(Ja,{...s,className:(f??"")+" gdg-input",id:w,ref:d,onKeyDown:g,value:p,placeholder:t,dir:"auto"}))},bi={};let Zn=null;function tc(){const e=document.createElement("div");return e.style.opacity="0",e.style.pointerEvents="none",e.style.position="fixed",document.body.append(e),e}function Fi(e){const t=e.toLowerCase().trim();if(bi[t]!==void 0)return bi[t];Zn=Zn||tc(),Zn.style.color="#000",Zn.style.color=t;const n=getComputedStyle(Zn).color;Zn.style.color="#fff",Zn.style.color=t;const o=getComputedStyle(Zn).color;if(o!==n)return[0,0,0,1];let r=o.replace(/[^\d.,]/g,"").split(",").map(Number.parseFloat);return r.length<4&&r.push(1),r=r.map(i=>Number.isNaN(i)?0:i),bi[t]=r,r}function wo(e,t){const[n,o,r]=Fi(e);return`rgba(${n}, ${o}, ${r}, ${t})`}const hl=new Map;function gl(e,t){const n=`${e}-${t}`,o=hl.get(n);if(o!==void 0)return o;const r=Qt(e,t);return hl.set(n,r),r}function Qt(e,t){if(t===void 0)return e;const[n,o,r,i]=Fi(e);if(i===1)return e;const[l,s,c,f]=Fi(t),d=i+f*(1-i),p=(i*n+f*l*(1-i))/d,w=(i*o+f*s*(1-i))/d,g=(i*r+f*c*(1-i))/d;return`rgba(${p}, ${w}, ${g}, ${d})`}function nc(e,t){return lt.useMemo(()=>e.map((n,o)=>({group:n.group,grow:n.grow,hasMenu:n.hasMenu,icon:n.icon,id:n.id,menuIcon:n.menuIcon,overlayIcon:n.overlayIcon,sourceIndex:o,sticky:o<t,indicatorIcon:n.indicatorIcon,style:n.style,themeOverride:n.themeOverride,title:n.title,trailingRowOptions:n.trailingRowOptions,width:n.width,growOffset:n.growOffset,rowMarker:n.rowMarker,rowMarkerChecked:n.rowMarkerChecked,headerRowMarkerTheme:n.headerRowMarkerTheme,headerRowMarkerAlwaysVisible:n.headerRowMarkerAlwaysVisible,headerRowMarkerDisabled:n.headerRowMarkerDisabled})),[e,t])}function oc(e,t){const[n,o]=t;if(e.columns.hasIndex(n)||e.rows.hasIndex(o))return!0;if(e.current!==void 0){if(sr(e.current.cell,t))return!0;const r=[e.current.range,...e.current.rangeStack];for(const i of r)if(n>=i.x&&n<i.x+i.width&&o>=i.y&&o<i.y+i.height)return!0}return!1}function fr(e,t){return(e??"")===(t??"")}function rc(e,t,n){return n.current===void 0||e[1]!==n.current.cell[1]?!1:t.span===void 0?n.current.cell[0]===e[0]:n.current.cell[0]>=t.span[0]&&n.current.cell[0]<=t.span[1]}function ls(e,t){const[n,o]=e;return n>=t.x&&n<t.x+t.width&&o>=t.y&&o<t.y+t.height}function sr(e,t){return(e==null?void 0:e[0])===(t==null?void 0:t[0])&&(e==null?void 0:e[1])===(t==null?void 0:t[1])}function ss(e){return[e.x+e.width-1,e.y+e.height-1]}function ml(e,t,n){const o=n.x,r=n.x+n.width-1,i=n.y,l=n.y+n.height-1,[s,c]=e;if(c<i||c>l)return!1;if(t.span===void 0)return s>=o&&s<=r;const[f,d]=t.span;return f>=o&&f<=r||d>=o&&f<=r||f<o&&d>r}function ic(e,t,n,o){let r=0;if(n.current===void 0)return r;const i=n.current.range;(o||i.height*i.width>1)&&ml(e,t,i)&&r++;for(const l of n.current.rangeStack)ml(e,t,l)&&r++;return r}function as(e,t){let n=e;if(t!==void 0){let o=[...e];const r=n[t.src];t.src>t.dest?(o.splice(t.src,1),o.splice(t.dest,0,r)):(o.splice(t.dest+1,0,r),o.splice(t.src,1)),o=o.map((i,l)=>({...i,sticky:e[l].sticky})),n=o}return n}function Wo(e,t){let n=0;const o=as(e,t);for(let r=0;r<o.length;r++){const i=o[r];if(i.sticky)n+=i.width;else break}return n}function yo(e,t,n){if(typeof n=="number")return t*n;{let o=0;for(let r=e-t;r<e;r++)o+=n(r);return o}}function Di(e,t,n,o,r){const i=as(e,o),l=[];for(const f of i)if(f.sticky)l.push(f);else break;if(l.length>0)for(const f of l)n-=f.width;let s=t,c=r??0;for(;c<=n&&s<i.length;)c+=i[s].width,s++;for(let f=t;f<s;f++){const d=i[f];d.sticky||l.push(d)}return l}function lc(e,t,n){let o=0;for(const r of t){const i=r.sticky?o:o+(n??0);if(e<=i+r.width)return r.sourceIndex;o+=r.width}return-1}function sc(e,t,n,o,r,i,l,s,c,f){const d=o+r;if(n&&e<=r)return-2;if(e<=d)return-1;let p=t;for(let h=0;h<f;h++){const m=i-1-h,C=typeof l=="number"?l:l(m);if(p-=C,e>=p)return m}const w=i-f,g=e-(c??0);if(typeof l=="number"){const h=Math.floor((g-d)/l)+s;return h>=w?void 0:h}else{let h=d;for(let m=s;m<w;m++){const C=l(m);if(g<=h+C)return m;h+=C}return}}let Yr=0,ar={};const ac=typeof window>"u";async function cc(){var e;ac||((e=document==null?void 0:document.fonts)==null?void 0:e.ready)===void 0||(await document.fonts.ready,Yr=0,ar={},Da())}cc();function cs(e,t,n,o){return`${e}_${o??(t==null?void 0:t.font)}_${n}`}function Oo(e,t,n,o="middle"){const r=cs(e,t,o,n);let i=ar[r];return i===void 0&&(i=t.measureText(e),ar[r]=i,Yr++),Yr>1e4&&(ar={},Yr=0),i}function ds(e,t){const n=cs(e,void 0,"middle",t);return ar[n]}function to(e,t){return typeof t!="string"&&(t=t.baseFontFull),dc(e,t)}function pl(e,t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";e.save(),e.textBaseline=t;const o=e.measureText(n);return e.restore(),o}const wl=[];function dc(e,t){for(const i of wl)if(i.key===t)return i.val;const n=pl(e,"alphabetic"),r=-(pl(e,"middle").actualBoundingBoxDescent-n.actualBoundingBoxDescent)+n.actualBoundingBoxAscent/2;return wl.push({key:t,val:r}),r}function uc(e,t,n,o,r,i){const{ctx:l,rect:s,theme:c}=e;let f=Number.MAX_SAFE_INTEGER;const d=500;if(t!==void 0&&(f=n-t,f<d)){const p=1-f/d;l.globalAlpha=p,l.fillStyle=c.bgSearchResult,l.fillRect(s.x+1,s.y+1,s.width-(r?2:1),s.height-(i?2:1)),l.globalAlpha=1,o!==void 0&&(o.fillStyle=c.bgSearchResult)}return f<d}function gr(e,t,n){const{ctx:o,theme:r}=e,i=t??{},l=n??r.textDark;return l!==i.fillStyle&&(o.fillStyle=l,i.fillStyle=l),i}function us(e,t,n,o,r,i,l,s,c){c==="right"?e.fillText(t,n+r-(s.cellHorizontalPadding+.5),o+i/2+l):c==="center"?e.fillText(t,n+r/2,o+i/2+l):e.fillText(t,n+s.cellHorizontalPadding+.5,o+i/2+l)}function fs(e,t){const n=Oo("ABCi09jgqpy",e,t);return n.actualBoundingBoxAscent+n.actualBoundingBoxDescent}function fc(e,t){e.includes(`
`)&&(e=e.split(/\r?\n/,1)[0]);const n=t/4;return e.length>n&&(e=e.slice(0,n)),e}function hc(e,t,n,o,r,i,l,s,c,f){const d=s.baseFontFull,p=Ha(e,t,d,r-s.cellHorizontalPadding*2,f??!1),w=fs(e,d),g=s.lineHeight*w,h=w+g*(p.length-1),m=h+s.cellVerticalPadding>i;m&&(e.save(),e.rect(n,o,r,i),e.clip());const C=o+i/2-h/2;let b=Math.max(o+s.cellVerticalPadding,C);for(const y of p)if(us(e,y,n,b,r,w,l,s,c),b+=g,b>o+i)break;m&&e.restore()}function $n(e,t,n,o,r){const{ctx:i,rect:l,theme:s}=e,{x:c,y:f,width:d,height:p}=l;o=o??!1,o||(t=fc(t,d));const w=to(i,s),g=Pi(t)==="rtl";if(n===void 0&&g&&(n="right"),g&&(i.direction="rtl"),t.length>0){let h=!1;n==="right"?(i.textAlign="right",h=!0):n!==void 0&&n!=="left"&&(i.textAlign=n,h=!0),o?hc(i,t,c,f,d,p,w,s,n,r):us(i,t,c,f,d,p,w,s,n),h&&(i.textAlign="start"),g&&(i.direction="inherit")}}function Fn(e,t,n,o,r,i){typeof i=="number"&&(i={tl:i,tr:i,br:i,bl:i}),i={tl:Math.max(0,Math.min(i.tl,r/2,o/2)),tr:Math.max(0,Math.min(i.tr,r/2,o/2)),bl:Math.max(0,Math.min(i.bl,r/2,o/2)),br:Math.max(0,Math.min(i.br,r/2,o/2))},e.moveTo(t+i.tl,n),e.arcTo(t+o,n,t+o,n+i.tr,i.tr),e.arcTo(t+o,n+r,t+o-i.br,n+r,i.br),e.arcTo(t,n+r,t,n+r-i.bl,i.bl),e.arcTo(t,n,t+i.tl,n,i.tl)}function gc(e,t,n){e.arc(t,n-1.25*3.5,1.25,0,2*Math.PI,!1),e.arc(t,n,1.25,0,2*Math.PI,!1),e.arc(t,n+1.25*3.5,1.25,0,2*Math.PI,!1)}function mc(e,t,n){const o=function(s,c){const f=c.x-s.x,d=c.y-s.y,p=Math.sqrt(f*f+d*d),w=f/p,g=d/p;return{x:f,y:c.y-s.y,len:p,nx:w,ny:g,ang:Math.atan2(g,w)}};let r;const i=t.length;let l=t[i-1];for(let s=0;s<i;s++){let c=t[s%i];const f=t[(s+1)%i],d=o(c,l),p=o(c,f),w=d.nx*p.ny-d.ny*p.nx,g=d.nx*p.nx-d.ny*-p.ny;let h=Math.asin(w<-1?-1:w>1?1:w),m=1,C=!1;g<0?h<0?h=Math.PI+h:(h=Math.PI-h,m=-1,C=!0):h>0&&(m=-1,C=!0),r=c.radius!==void 0?c.radius:n;const b=h/2;let y=Math.abs(Math.cos(b)*r/Math.sin(b)),k;y>Math.min(d.len/2,p.len/2)?(y=Math.min(d.len/2,p.len/2),k=Math.abs(y*Math.sin(b)/Math.cos(b))):k=r;let z=c.x+p.nx*y,L=c.y+p.ny*y;z+=-p.ny*k*m,L+=p.nx*k*m,e.arc(z,L,k,d.ang+Math.PI/2*m,p.ang-Math.PI/2*m,C),l=c,c=f}e.closePath()}function Hi(e,t,n,o,r,i,l,s,c,f,d,p,w,g,h){const m={x:0,y:i+f,width:0,height:0};if(e>=g.length||t>=d||t<-2||e<0)return m;const C=i-r;if(e>=p){const b=l>e?-1:1,y=Wo(g);m.x+=y+c;for(let k=l;k!==e;k+=b)m.x+=g[b===1?k:k-1].width*b}else for(let b=0;b<e;b++)m.x+=g[b].width;if(m.width=g[e].width+1,t===-1)m.y=r,m.height=C;else if(t===-2){m.y=0,m.height=r;let b=e;const y=g[e].group,k=g[e].sticky;for(;b>0&&fr(g[b-1].group,y)&&g[b-1].sticky===k;){const L=g[b-1];m.x-=L.width,m.width+=L.width,b--}let z=e;for(;z+1<g.length&&fr(g[z+1].group,y)&&g[z+1].sticky===k;){const L=g[z+1];m.width+=L.width,z++}if(!k){const L=Wo(g),H=m.x-L;H<0&&(m.x-=H,m.width+=H),m.x+m.width>n&&(m.width=n-m.x)}}else if(t>=d-w){let b=d-t;for(m.y=o;b>0;){const y=t+b-1;m.height=typeof h=="number"?h:h(y),m.y-=m.height,b--}m.height+=1}else{const b=s>t?-1:1;if(typeof h=="number"){const y=t-s;m.y+=y*h}else for(let y=s;y!==t;y+=b)m.y+=h(y)*b;m.height=(typeof h=="number"?h:h(t))+1}return m}const $i=1<<21;function yn(e,t){return(t+2)*$i+e}function hs(e){return e%$i}function Wi(e){return Math.floor(e/$i)-2}function Oi(e){const t=hs(e),n=Wi(e);return[t,n]}class gs{constructor(){Oe(this,"visibleWindow",{x:0,y:0,width:0,height:0});Oe(this,"freezeCols",0);Oe(this,"freezeRows",[]);Oe(this,"isInWindow",t=>{const n=hs(t),o=Wi(t),r=this.visibleWindow,i=n>=r.x&&n<=r.x+r.width||n<this.freezeCols,l=o>=r.y&&o<=r.y+r.height||this.freezeRows.includes(o);return i&&l})}setWindow(t,n,o){this.visibleWindow.x===t.x&&this.visibleWindow.y===t.y&&this.visibleWindow.width===t.width&&this.visibleWindow.height===t.height&&this.freezeCols===n&&$o(this.freezeRows,o)||(this.visibleWindow=t,this.freezeCols=n,this.freezeRows=o,this.clearOutOfWindow())}}class pc extends gs{constructor(){super(...arguments);Oe(this,"cache",new Map);Oe(this,"setValue",(n,o)=>{this.cache.set(yn(n[0],n[1]),o)});Oe(this,"getValue",n=>this.cache.get(yn(n[0],n[1])));Oe(this,"clearOutOfWindow",()=>{for(const[n]of this.cache.entries())this.isInWindow(n)||this.cache.delete(n)})}}class cr{constructor(t=[]){Oe(this,"cells");this.cells=new Set(t.map(n=>yn(n[0],n[1])))}add(t){this.cells.add(yn(t[0],t[1]))}has(t){return t===void 0?!1:this.cells.has(yn(t[0],t[1]))}remove(t){this.cells.delete(yn(t[0],t[1]))}clear(){this.cells.clear()}get size(){return this.cells.size}hasHeader(){for(const t of this.cells)if(Wi(t)<0)return!0;return!1}hasItemInRectangle(t){for(let n=t.y;n<t.y+t.height;n++)for(let o=t.x;o<t.x+t.width;o++)if(this.cells.has(yn(o,n)))return!0;return!1}hasItemInRegion(t){for(const n of t)if(this.hasItemInRectangle(n))return!0;return!1}*values(){for(const t of this.cells)yield Oi(t)}}function wc(e){return{"--gdg-accent-color":e.accentColor,"--gdg-accent-fg":e.accentFg,"--gdg-accent-light":e.accentLight,"--gdg-text-dark":e.textDark,"--gdg-text-medium":e.textMedium,"--gdg-text-light":e.textLight,"--gdg-text-bubble":e.textBubble,"--gdg-bg-icon-header":e.bgIconHeader,"--gdg-fg-icon-header":e.fgIconHeader,"--gdg-text-header":e.textHeader,"--gdg-text-group-header":e.textGroupHeader??e.textHeader,"--gdg-text-header-selected":e.textHeaderSelected,"--gdg-bg-cell":e.bgCell,"--gdg-bg-cell-medium":e.bgCellMedium,"--gdg-bg-header":e.bgHeader,"--gdg-bg-header-has-focus":e.bgHeaderHasFocus,"--gdg-bg-header-hovered":e.bgHeaderHovered,"--gdg-bg-bubble":e.bgBubble,"--gdg-bg-bubble-selected":e.bgBubbleSelected,"--gdg-bg-search-result":e.bgSearchResult,"--gdg-border-color":e.borderColor,"--gdg-horizontal-border-color":e.horizontalBorderColor??e.borderColor,"--gdg-drilldown-border":e.drilldownBorder,"--gdg-link-color":e.linkColor,"--gdg-cell-horizontal-padding":`${e.cellHorizontalPadding}px`,"--gdg-cell-vertical-padding":`${e.cellVerticalPadding}px`,"--gdg-header-font-style":e.headerFontStyle,"--gdg-base-font-style":e.baseFontStyle,"--gdg-marker-font-style":e.markerFontStyle,"--gdg-font-family":e.fontFamily,"--gdg-editor-font-size":e.editorFontSize,...e.resizeIndicatorColor===void 0?{}:{"--gdg-resize-indicator-color":e.resizeIndicatorColor},...e.headerBottomBorderColor===void 0?{}:{"--gdg-header-bottom-border-color":e.headerBottomBorderColor},...e.roundingRadius===void 0?{}:{"--gdg-rounding-radius":`${e.roundingRadius}px`}}}const ms={accentColor:"#4F5DFF",accentFg:"#FFFFFF",accentLight:"rgba(62, 116, 253, 0.1)",textDark:"#313139",textMedium:"#737383",textLight:"#B2B2C0",textBubble:"#313139",bgIconHeader:"#737383",fgIconHeader:"#FFFFFF",textHeader:"#313139",textGroupHeader:"#313139BB",textHeaderSelected:"#FFFFFF",bgCell:"#FFFFFF",bgCellMedium:"#FAFAFB",bgHeader:"#F7F7F8",bgHeaderHasFocus:"#E9E9EB",bgHeaderHovered:"#EFEFF1",bgBubble:"#EDEDF3",bgBubbleSelected:"#FFFFFF",bgSearchResult:"#fff9e3",borderColor:"rgba(115, 116, 131, 0.16)",drilldownBorder:"rgba(0, 0, 0, 0)",linkColor:"#353fb5",cellHorizontalPadding:8,cellVerticalPadding:3,headerIconSize:18,headerFontStyle:"600 13px",baseFontStyle:"13px",markerFontStyle:"9px",fontFamily:"Inter, Roboto, -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, noto, arial, sans-serif",editorFontSize:"13px",lineHeight:1.4};function ps(){return ms}const yc=lt.createContext(ms);function Wn(e,...t){const n={...e};for(const o of t)if(o!==void 0)for(const r in o)o.hasOwnProperty(r)&&(r==="bgCell"?n[r]=Qt(o[r],n[r]):n[r]=o[r]);return(n.headerFontFull===void 0||e.fontFamily!==n.fontFamily||e.headerFontStyle!==n.headerFontStyle)&&(n.headerFontFull=`${n.headerFontStyle} ${n.fontFamily}`),(n.baseFontFull===void 0||e.fontFamily!==n.fontFamily||e.baseFontStyle!==n.baseFontStyle)&&(n.baseFontFull=`${n.baseFontStyle} ${n.fontFamily}`),(n.markerFontFull===void 0||e.fontFamily!==n.fontFamily||e.markerFontStyle!==n.markerFontStyle)&&(n.markerFontFull=`${n.markerFontStyle} ${n.fontFamily}`),n}const Ti=150;function bc(e,t,n,o){var i;const r=o(t);return((i=r==null?void 0:r.measure)==null?void 0:i.call(r,e,t,n))??Ti}function ws(e,t,n,o,r,i,l,s,c){let f=0;const d=r===void 0?[]:r.map(w=>{const g=bc(e,w[o],t,c);return f=Math.max(f,g),g});if(d.length>5&&s){f=0;let w=0;for(const h of d)w+=h;const g=w/d.length;for(let h=0;h<d.length;h++)d[h]>=g*2?d[h]=0:f=Math.max(f,d[h])}f=Math.max(f,e.measureText(n.title).width+t.cellHorizontalPadding*2+(n.icon===void 0?0:28));const p=Math.max(Math.ceil(i),Math.min(Math.floor(l),Math.ceil(f)));return{...n,width:p}}function Cc(e,t,n,o,r,i,l,s,c){const f=a.useRef(t),d=a.useRef(n),p=a.useRef(l);f.current=t,d.current=n,p.current=l;const[w,g]=a.useMemo(()=>{if(typeof window>"u")return[null,null];const y=document.createElement("canvas");return y.style.display="none",y.style.opacity="0",y.style.position="fixed",[y,y.getContext("2d",{alpha:!1})]},[]);a.useLayoutEffect(()=>(w&&document.documentElement.append(w),()=>{w==null||w.remove()}),[w]);const h=a.useRef({}),m=a.useRef(),[C,b]=a.useState();return a.useLayoutEffect(()=>{const y=d.current;if(y===void 0||e.every(Or))return;let k=Math.max(1,10-Math.floor(e.length/1e4)),z=0;k<f.current&&k>1&&(k--,z=1);const L={x:0,y:0,width:e.length,height:Math.min(f.current,k)},H={x:0,y:f.current-1,width:e.length,height:1};(async()=>{const _=y(L,c.signal),M=z>0?y(H,c.signal):void 0;let N;typeof _=="object"?N=_:N=await cl(_),M!==void 0&&(typeof M=="object"?N=[...N,...M]:N=[...N,...await cl(M)]),m.current=e,b(N)})()},[c.signal,e]),a.useMemo(()=>{let k=e.every(Or)?e:g===null?e.map(A=>Or(A)?A:{...A,width:Ti}):(g.font=p.current.baseFontFull,e.map((A,_)=>{if(Or(A))return A;if(h.current[A.id]!==void 0)return{...A,width:h.current[A.id]};if(C===void 0||m.current!==e||A.id===void 0)return{...A,width:Ti};const M=ws(g,l,A,_,C,r,i,!0,s);return h.current[A.id]=M.width,M})),z=0,L=0;const H=[];for(const[A,_]of k.entries())z+=_.width,_.grow!==void 0&&_.grow>0&&(L+=_.grow,H.push(A));if(z<o&&H.length>0){const A=[...k],_=o-z;let M=_;for(let N=0;N<H.length;N++){const O=H[N],F=(k[O].grow??0)/L,E=N===H.length-1?M:Math.min(M,Math.floor(_*F));A[O]={...k[O],growOffset:E,width:k[O].width+E},M-=E}k=A}return{sizedColumns:k,nonGrowWidth:z}},[o,e,g,C,l,r,i,s])}const ct='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',vc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${ct}<rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${t}"/></svg>`},xc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${ct}<rect x="2" y="2" width="16" height="16" rx="4" fill="${n}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${t}"/></svg>`},kc=e=>{const t=e.fgColor,n=e.bgColor;return`${ct}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${t}"/>
  </svg>`},Sc=e=>{const t=e.fgColor,n=e.bgColor;return`${ct}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${t}"/>
</svg>`},Mc=e=>{const t=e.fgColor,n=e.bgColor;return`${ct}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${n}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${t}"
    />
</svg>`},ys=e=>{const t=e.fgColor,n=e.bgColor;return`${ct}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${t}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${t}"/>
</svg>
  `},Rc=e=>{const t=e.bgColor;return`${ct}
    <path stroke="${t}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${t}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${t}"/>
  </svg>
`},Ec=ys,Ic=e=>{const t=e.fgColor,n=e.bgColor;return`${ct}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${t}"/>
</svg>`},Fc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${ct}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${t}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${t}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
  </svg>`},Dc=e=>{const t=e.fgColor,n=e.bgColor;return`${ct}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${t}"/>
</svg>`},Hc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${ct}
    <path fill="${t}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${n}"/>
  </svg>`},Tc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${ct}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${t}"/>
  </svg>`},Ac=e=>{const t=e.fgColor,n=e.bgColor;return`${ct}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${t}"/>
</svg>`},Bc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${ct}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${t}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${t}"/>
  </svg>`},zc=e=>{const t=e.fgColor,n=e.bgColor;return`${ct}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${t}"/>
</svg>`},Lc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${ct}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${n}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${n}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${t}"/>
  </svg>`},Pc=e=>{const t=e.fgColor,n=e.bgColor;return`${ct}
  <path fill="${t}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${n}"/>
</svg>`},$c=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${ct}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${t}"/>
  </svg>`},Wc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${ct}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${t}"/>
  </svg>`},Oc=e=>{const t=e.fgColor,n=e.bgColor;return`${ct}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${t}"/>
</svg>`},Nc=e=>{const t=e.fgColor,n=e.bgColor;return`${ct}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${t}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${t}"/>
</svg>`},Xc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${ct}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${t}"/>
  </svg>`},Gc=e=>{const t=e.fgColor,n=e.bgColor;return`${ct}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${t}"/>
</svg>`},Uc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${ct}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${t}"/>
  </svg>`},Yc=e=>{const t=e.fgColor,n=e.bgColor;return`${ct}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${t}"/>
</svg>`},_c=e=>{const t=e.fgColor,n=e.bgColor;return`${ct}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${t}"/>
</svg>`},Kc=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>`},Vc=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>
`},jc={headerRowID:vc,headerNumber:kc,headerCode:xc,headerString:Sc,headerBoolean:Mc,headerAudioUri:Ec,headerVideoUri:Ic,headerEmoji:Fc,headerImage:Dc,headerUri:ys,headerPhone:Hc,headerMarkdown:Tc,headerDate:Ac,headerTime:Bc,headerEmail:zc,headerReference:Lc,headerIfThenElse:Pc,headerSingleValue:$c,headerLookup:Wc,headerTextTemplate:Oc,headerMath:Nc,headerRollup:Xc,headerJoinStrings:Gc,headerSplitString:Uc,headerGeoDistance:Yc,headerArray:_c,rowOwnerOverlay:Kc,protectedColumnOverlay:Vc,renameIcon:Rc};function qc(e,t){return e==="normal"?[t.bgIconHeader,t.fgIconHeader]:e==="selected"?["white",t.accentColor]:[t.accentColor,t.bgHeader]}class Zc{constructor(t,n){Oe(this,"onSettled");Oe(this,"spriteMap",new Map);Oe(this,"headerIcons");Oe(this,"inFlight",0);this.onSettled=n,this.headerIcons=t??{}}drawSprite(t,n,o,r,i,l,s,c=1){const[f,d]=qc(n,s),p=l*Math.ceil(window.devicePixelRatio),w=`${f}_${d}_${p}_${t}`;let g=this.spriteMap.get(w);if(g===void 0){const h=this.headerIcons[t];if(h===void 0)return;g=document.createElement("canvas");const m=g.getContext("2d");if(m===null)return;const C=new Image;C.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(h({fgColor:d,bgColor:f}))}`,this.spriteMap.set(w,g);const b=C.decode();if(b===void 0)return;this.inFlight++,b.then(()=>{m.drawImage(C,0,0,p,p)}).finally(()=>{this.inFlight--,this.inFlight===0&&this.onSettled()})}else c<1&&(o.globalAlpha=c),o.drawImage(g,0,0,p,p,r,i,l,l),c<1&&(o.globalAlpha=1)}}function bs(e){if(e.length===0)return;let t;for(const n of e)t=Math.min(t??n.y,n.y)}function Qr(e,t,n,o,r,i,l,s,c){s=s??t;let f=t,d=e;const p=o-i;let w=!1;for(;f<n&&d<p;){const g=r(d);if(f+g>s&&c(f,d,g,!1,l&&d===o-1)===!0){w=!0;break}f+=g,d++}if(!w){f=n;for(let g=0;g<i;g++){d=o-1-g;const h=r(d);f-=h,c(f,d,h,!0,l&&d===o-1)}}}function no(e,t,n,o,r,i){let l=0,s=0;const c=r+o;for(const f of e){const d=f.sticky?s:l+n;if(i(f,d,c,f.sticky?0:s,t)===!0)break;l+=f.width,s+=f.sticky?f.width:0}}function Cs(e,t,n,o,r){let i=0,l=0;for(let s=0;s<e.length;s++){const c=e[s];let f=s+1,d=c.width;for(c.sticky&&(l+=d);f<e.length&&fr(e[f].group,c.group)&&e[f].sticky===e[s].sticky;){const m=e[f];d+=m.width,f++,s++,m.sticky&&(l+=m.width)}const p=c.sticky?0:n,w=i+p,g=c.sticky?0:Math.max(0,l-w),h=Math.min(d-g,t-(w+g));r([c.sourceIndex,e[f-1].sourceIndex],c.group??"",w+g,0,h,o),i+=d}}function vs(e,t,n,o,r,i,l){var w;const[s,c]=e;let f,d;const p=((w=l.find(g=>!g.sticky))==null?void 0:w.sourceIndex)??0;if(c>p){const g=Math.max(s,p);let h=t,m=o;for(let C=i.sourceIndex-1;C>=g;C--)h-=l[C].width,m+=l[C].width;for(let C=i.sourceIndex+1;C<=c;C++)m+=l[C].width;d={x:h,y:n,width:m,height:r}}if(p>s){const g=Math.min(c,p-1);let h=t,m=o;for(let C=i.sourceIndex-1;C>=s;C--)h-=l[C].width,m+=l[C].width;for(let C=i.sourceIndex+1;C<=g;C++)m+=l[C].width;f={x:h,y:n,width:m,height:r}}return[f,d]}function Jc(e,t,n,o){if(o==="any")return xs(e,{x:t,y:n,width:1,height:1});if(o==="vertical"&&(t=e.x),o==="horizontal"&&(n=e.y),ls([t,n],e))return;const r=t-e.x,i=e.x+e.width-t,l=n-e.y+1,s=e.y+e.height-n,c=Math.min(o==="vertical"?Number.MAX_SAFE_INTEGER:r,o==="vertical"?Number.MAX_SAFE_INTEGER:i,o==="horizontal"?Number.MAX_SAFE_INTEGER:l,o==="horizontal"?Number.MAX_SAFE_INTEGER:s);return c===s?{x:e.x,y:e.y+e.height,width:e.width,height:n-e.y-e.height+1}:c===l?{x:e.x,y:n,width:e.width,height:e.y-n}:c===i?{x:e.x+e.width,y:e.y,width:t-e.x-e.width+1,height:e.height}:{x:t,y:e.y,width:e.x-t,height:e.height}}function hr(e,t,n,o,r,i,l,s){return e<=r+l&&r<=e+n&&t<=i+s&&i<=t+o}function po(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function xs(e,t){const n=Math.min(e.x,t.x),o=Math.min(e.y,t.y),r=Math.max(e.x+e.width,t.x+t.width)-n,i=Math.max(e.y+e.height,t.y+t.height)-o;return{x:n,y:o,width:r,height:i}}function Qc(e,t){return e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height}function ed(e,t,n,o){if(e.x>t||e.y>n||e.x<0&&e.y<0&&e.x+e.width>t&&e.y+e.height>n)return;if(e.x>=0&&e.y>=0&&e.x+e.width<=t&&e.y+e.height<=n)return e;const r=-4,i=-4,l=t+4,s=n+4,c=r-e.x,f=e.x+e.width-l,d=i-e.y,p=e.y+e.height-s,w=c>0?e.x+Math.floor(c/o)*o:e.x,g=f>0?e.x+e.width-Math.floor(f/o)*o:e.x+e.width,h=d>0?e.y+Math.floor(d/o)*o:e.y,m=p>0?e.y+e.height-Math.floor(p/o)*o:e.y+e.height;return{x:w,y:h,width:g-w,height:m-h}}function td(e,t,n,o,r){const[i,l,s,c]=t,[f,d,p,w]=r,{x:g,y:h,width:m,height:C}=e,b=[];if(m<=0||C<=0)return b;const y=g+m,k=h+C,z=g<i,L=h<l,H=g+m>s,A=h+C>c,_=g>=i&&g<s||y>i&&y<=s||g<i&&y>s,M=h>=l&&h<c||k>l&&k<=c||h<l&&k>c;if(_&&M){const O=Math.max(g,i),F=Math.max(h,l),E=Math.min(y,s),R=Math.min(k,c);b.push({rect:{x:O,y:F,width:E-O,height:R-F},clip:{x:f,y:d,width:p-f+1,height:w-d+1}})}if(z&&L){const O=g,F=h,E=Math.min(y,i),R=Math.min(k,l);b.push({rect:{x:O,y:F,width:E-O,height:R-F},clip:{x:0,y:0,width:f+1,height:d+1}})}if(L&&_){const O=Math.max(g,i),F=h,E=Math.min(y,s),R=Math.min(k,l);b.push({rect:{x:O,y:F,width:E-O,height:R-F},clip:{x:f,y:0,width:p-f+1,height:d+1}})}if(L&&H){const O=Math.max(g,s),F=h,E=y,R=Math.min(k,l);b.push({rect:{x:O,y:F,width:E-O,height:R-F},clip:{x:p,y:0,width:n-p+1,height:d+1}})}if(z&&M){const O=g,F=Math.max(h,l),E=Math.min(y,i),R=Math.min(k,c);b.push({rect:{x:O,y:F,width:E-O,height:R-F},clip:{x:0,y:d,width:f+1,height:w-d+1}})}if(H&&M){const O=Math.max(g,s),F=Math.max(h,l),E=y,R=Math.min(k,c);b.push({rect:{x:O,y:F,width:E-O,height:R-F},clip:{x:p,y:d,width:n-p+1,height:w-d+1}})}if(z&&A){const O=g,F=Math.max(h,c),E=Math.min(y,i),R=k;b.push({rect:{x:O,y:F,width:E-O,height:R-F},clip:{x:0,y:w,width:f+1,height:o-w+1}})}if(A&&_){const O=Math.max(g,i),F=Math.max(h,c),E=Math.min(y,s),R=k;b.push({rect:{x:O,y:F,width:E-O,height:R-F},clip:{x:f,y:w,width:p-f+1,height:o-w+1}})}if(H&&A){const O=Math.max(g,s),F=Math.max(h,c),E=y,R=k;b.push({rect:{x:O,y:F,width:E-O,height:R-F},clip:{x:p,y:w,width:n-p+1,height:o-w+1}})}return b}const nd={kind:U.Loading,allowOverlay:!1};function yl(e,t,n,o,r,i,l,s,c,f,d,p,w,g,h,m,C,b,y,k,z,L,H,A,_,M,N,O,F,E,R,ce,te,le,Ie){let be=(k==null?void 0:k.size)??Number.MAX_SAFE_INTEGER;const Z=performance.now();let K=E.baseFontFull;e.font=K;const me={ctx:e},ne=[0,0],pe=C>0?yo(c,C,f):0;let ue,V;const ve=bs(y);return no(t,s,i,l,r,(Ce,Ke,ot,wt,rt)=>{const Be=Math.max(0,wt-Ke),Ve=Ke+Be,Me=r+1,yt=Ce.width-Be,dt=o-r-1;if(y.length>0){let Ge=!1;for(let $e=0;$e<y.length;$e++){const We=y[$e];if(hr(Ve,Me,yt,dt,We.x,We.y,We.width,We.height)){Ge=!0;break}}if(!Ge)return}const Ze=()=>{e.save(),e.beginPath(),e.rect(Ve,Me,yt,dt),e.clip()},j=z.columns.hasIndex(Ce.sourceIndex),Ne=p(Ce.group??"").overrideTheme,Fe=Ce.themeOverride===void 0&&Ne===void 0?E:Wn(E,Ne,Ce.themeOverride),De=Fe.baseFontFull;De!==K&&(K=De,e.font=De),Ze();let fe;return Qr(rt,ot,o,c,f,C,b,ve,(Ge,$e,We,de,xe)=>{var Cn,en,tn;if($e<0||(ne[0]=Ce.sourceIndex,ne[1]=$e,k!==void 0&&!k.has(ne)))return;if(y.length>0){let ze=!1;for(let Mt=0;Mt<y.length;Mt++){const ft=y[Mt];if(hr(Ke,Ge,Ce.width,We,ft.x,ft.y,ft.width,ft.height)){ze=!0;break}}if(!ze)return}const tt=z.rows.hasIndex($e),Ue=g.hasIndex($e),_e=$e<c?d(ne):nd;let ut=Ke,Je=Ce.width,Te=!1,kt=!1;if(_e.span!==void 0){const[ze,Mt]=_e.span,ft=`${$e},${ze},${Mt},${Ce.sticky}`;if(V===void 0&&(V=new Set),V.has(ft)){be--;return}else{const Ot=vs(_e.span,Ke,Ge,Ce.width,We,Ce,n),Tt=Ce.sticky?Ot[0]:Ot[1];if(!Ce.sticky&&Ot[0]!==void 0&&(kt=!0),Tt!==void 0){ut=Tt.x,Je=Tt.width,V.add(ft),e.restore(),fe=void 0,e.save(),e.beginPath();const Yt=Math.max(0,wt-Tt.x);e.rect(Tt.x+Yt,Ge,Tt.width-Yt,We),ue===void 0&&(ue=[]),ue.push({x:Tt.x+Yt,y:Ge,width:Tt.width-Yt,height:We}),e.clip(),Te=!0}}}const zt=w==null?void 0:w($e),Ct=xe&&((Cn=Ce.trailingRowOptions)==null?void 0:Cn.themeOverride)!==void 0?(en=Ce.trailingRowOptions)==null?void 0:en.themeOverride:void 0,St=_e.themeOverride===void 0&&zt===void 0&&Ct===void 0?Fe:Wn(Fe,zt,Ct,_e.themeOverride);e.beginPath();const Pt=rc(ne,_e,z);let gt=ic(ne,_e,z,m);const bn=_e.span!==void 0&&z.columns.some(ze=>_e.span!==void 0&&ze>=_e.span[0]&&ze<=_e.span[1]);Pt&&!h&&m?gt=0:Pt&&m&&(gt=Math.max(gt,1)),bn&&gt++,Pt||(tt&&gt++,j&&!xe&&gt++);const On=_e.kind===U.Protected?St.bgCellMedium:St.bgCell;let st;if((de||On!==E.bgCell)&&(st=Qt(On,st)),gt>0||Ue){Ue&&(st=Qt(St.bgHeader,st));for(let ze=0;ze<gt;ze++)st=Qt(St.accentLight,st)}else if(L!==void 0){for(const ze of L)if(ze[0]===Ce.sourceIndex&&ze[1]===$e){st=Qt(St.bgSearchResult,st);break}}if(H!==void 0)for(let ze=0;ze<H.length;ze++){const Mt=H[ze],ft=Mt.range;Mt.style!=="solid-outline"&&ft.x<=Ce.sourceIndex&&Ce.sourceIndex<ft.x+ft.width&&ft.y<=$e&&$e<ft.y+ft.height&&(st=Qt(Mt.color,st))}let Dn=!1;if(k!==void 0){const ze=Ge+1,ft=(de?ze+We-1:Math.min(ze+We-1,o-pe))-ze;(ft!==We-1||ut+1<=wt)&&(Dn=!0,e.save(),e.beginPath(),e.rect(ut+1,ze,Je-1,ft),e.clip()),st=st===void 0?St.bgCell:Qt(st,St.bgCell)}const un=Ce.sourceIndex===n.length-1,ye=$e===c-1;st!==void 0&&(e.fillStyle=st,fe!==void 0&&(fe.fillStyle=st),k!==void 0?e.fillRect(ut+1,Ge+1,Je-(un?2:1),We-(ye?2:1)):e.fillRect(ut,Ge,Je,We)),_e.style==="faded"&&(e.globalAlpha=.6);let mt;for(let ze=0;ze<M.length;ze++){const Mt=M[ze];if(Mt.item[0]===Ce.sourceIndex&&Mt.item[1]===$e){mt=Mt;break}}if(Je>Ie&&!kt){const ze=St.baseFontFull;ze!==K&&(e.font=ze,K=ze),fe=ks(e,_e,Ce.sourceIndex,$e,un,ye,ut,Ge,Je,We,gt>0,St,st??St.bgCell,A,_,(mt==null?void 0:mt.hoverAmount)??0,N,F,Z,O,fe,R,ce,te,le)}return Dn&&e.restore(),_e.style==="faded"&&(e.globalAlpha=1),be--,Te&&(e.restore(),(tn=fe==null?void 0:fe.deprep)==null||tn.call(fe,me),fe=void 0,Ze(),K=De,e.font=De),be<=0}),e.restore(),be<=0}),ue}const nr=[0,0],or={x:0,y:0,width:0,height:0},Ci=[void 0,()=>{}];let Ai=!1;function od(){Ai=!0}function ks(e,t,n,o,r,i,l,s,c,f,d,p,w,g,h,m,C,b,y,k,z,L,H,A,_){var ce,te;let M,N;C!==void 0&&C[0][0]===n&&C[0][1]===o&&(M=C[1][0],N=C[1][1]);let O;nr[0]=n,nr[1]=o,or.x=l,or.y=s,or.width=c,or.height=f,Ci[0]=H.getValue(nr),Ci[1]=le=>H.setValue(nr,le),Ai=!1;const F={ctx:e,theme:p,col:n,row:o,cell:t,rect:or,highlighted:d,cellFillColor:w,hoverAmount:m,frameTime:y,hoverX:M,drawState:Ci,hoverY:N,imageLoader:g,spriteManager:h,hyperWrapping:b,overrideCursor:M!==void 0?_:void 0,requestAnimationFrame:od},E=uc(F,t.lastUpdated,y,z,r,i),R=A(t);if(R!==void 0){(z==null?void 0:z.renderer)!==R&&((ce=z==null?void 0:z.deprep)==null||ce.call(z,F),z=void 0);const le=(te=R.drawPrep)==null?void 0:te.call(R,F,z);k!==void 0&&!Bo(F.cell)?k(F,()=>R.draw(F,t)):R.draw(F,t),O=le===void 0?void 0:{deprep:le==null?void 0:le.deprep,fillStyle:le==null?void 0:le.fillStyle,font:le==null?void 0:le.font,renderer:R}}return(E||Ai)&&(L==null||L(nr)),O}function Ni(e,t,n,o,r,i,l,s,c=-20,f=-20,d=32,p="center",w="square"){const g=Math.floor(r+l/2),h=w==="circle"?1e4:t.roundingRadius??4;let m=os(d,l,t.cellVerticalPadding),C=m/2;const b=ns(p,o,i,t.cellHorizontalPadding,m),y=ts(b,g,m),k=rs(o+c,r+f,y);switch(n){case!0:{e.beginPath(),Fn(e,b-m/2,g-m/2,m,m,h),w==="circle"&&(C*=.8,m*=.8),e.fillStyle=s?t.accentColor:t.textMedium,e.fill(),e.beginPath(),e.moveTo(b-C+m/4.23,g-C+m/1.97),e.lineTo(b-C+m/2.42,g-C+m/1.44),e.lineTo(b-C+m/1.29,g-C+m/3.25),e.strokeStyle=t.bgCell,e.lineJoin="round",e.lineCap="round",e.lineWidth=1.9,e.stroke();break}case _r:case!1:{e.beginPath(),Fn(e,b-m/2+.5,g-m/2+.5,m-1,m-1,h),e.lineWidth=1,e.strokeStyle=k?t.textDark:t.textMedium,e.stroke();break}case Bi:{e.beginPath(),Fn(e,b-m/2,g-m/2,m,m,h),e.fillStyle=k?t.textMedium:t.textLight,e.fill(),w==="circle"&&(C*=.8,m*=.8),e.beginPath(),e.moveTo(b-m/3,g),e.lineTo(b+m/3,g),e.strokeStyle=t.bgCell,e.lineCap="round",e.lineWidth=1.9,e.stroke();break}default:ur()}}function rd(e,t,n,o,r,i,l,s,c,f,d,p,w,g,h,m,C,b,y){var M,N,O,F;const k=l+s;if(k<=0)return;e.fillStyle=p.bgHeader,e.fillRect(0,0,r,k);const z=(M=o==null?void 0:o[0])==null?void 0:M[0],L=(N=o==null?void 0:o[0])==null?void 0:N[1],H=(O=o==null?void 0:o[1])==null?void 0:O[0],A=(F=o==null?void 0:o[1])==null?void 0:F[1],_=p.headerFontFull;e.font=_,no(t,0,i,0,k,(E,R,ce,te)=>{var Ce;if(C!==void 0&&!C.has([E.sourceIndex,-1]))return;const le=Math.max(0,te-R);e.save(),e.beginPath(),e.rect(R+le,s,E.width-le,l),e.clip();const Ie=m(E.group??"").overrideTheme,be=E.themeOverride===void 0&&Ie===void 0?p:Wn(p,Ie,E.themeOverride);be.bgHeader!==p.bgHeader&&(e.fillStyle=be.bgHeader,e.fill()),be!==p&&(e.font=be.baseFontFull);const Z=d.columns.hasIndex(E.sourceIndex),K=c!==void 0||f,me=!K&&L===-1&&z===E.sourceIndex,ne=K?0:((Ce=g.find(Ke=>Ke.item[0]===E.sourceIndex&&Ke.item[1]===-1))==null?void 0:Ce.hoverAmount)??0,pe=(d==null?void 0:d.current)!==void 0&&d.current.cell[0]===E.sourceIndex,ue=Z?be.accentColor:pe?be.bgHeaderHasFocus:be.bgHeader,V=n?s:0,ve=E.sourceIndex===0?0:1;Z?(e.fillStyle=ue,e.fillRect(R+ve,V,E.width-ve,l)):(pe||ne>0)&&(e.beginPath(),e.rect(R+ve,V,E.width-ve,l),pe&&(e.fillStyle=be.bgHeaderHasFocus,e.fill()),ne>0&&(e.globalAlpha=ne,e.fillStyle=be.bgHeaderHovered,e.fill(),e.globalAlpha=1)),Rs(e,R,V,E.width,l,E,Z,be,me,me?H:void 0,me?A:void 0,pe,ne,w,b,y),e.restore()}),n&&id(e,t,r,i,s,o,p,w,g,h,m,C)}function id(e,t,n,o,r,i,l,s,c,f,d,p){const[g,h]=(i==null?void 0:i[0])??[];let m=0;Cs(t,n,o,r,(C,b,y,k,z,L)=>{if(p!==void 0&&!p.hasItemInRectangle({x:C[0],y:-2,width:C[1]-C[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(y,k,z,L),e.clip();const H=d(b),A=(H==null?void 0:H.overrideTheme)===void 0?l:Wn(l,H.overrideTheme),_=h===-2&&g!==void 0&&g>=C[0]&&g<=C[1],M=_?A.bgHeaderHovered:A.bgHeader;if(M!==l.bgHeader&&(e.fillStyle=M,e.fill()),e.fillStyle=A.textGroupHeader??A.textHeader,H!==void 0){let N=y;if(H.icon!==void 0&&(s.drawSprite(H.icon,"normal",e,N+8,(r-20)/2,20,A),N+=26),e.fillText(H.name,N+8,r/2+to(e,l.headerFontFull)),H.actions!==void 0&&_){const O=Ss({x:y,y:k,width:z,height:L},H.actions);e.beginPath();const F=O[0].x-10,E=y+z-F;e.rect(F,0,E,r);const R=e.createLinearGradient(F,0,F+E,0),ce=wo(M,0);R.addColorStop(0,ce),R.addColorStop(10/E,M),R.addColorStop(1,M),e.fillStyle=R,e.fill(),e.globalAlpha=.6;const[te,le]=(i==null?void 0:i[1])??[-1,-1];for(let Ie=0;Ie<H.actions.length;Ie++){const be=H.actions[Ie],Z=O[Ie],K=po(Z,te+y,le);K&&(e.globalAlpha=1),s.drawSprite(be.icon,"normal",e,Z.x+Z.width/2-10,Z.y+Z.height/2-10,20,A),K&&(e.globalAlpha=.6)}e.globalAlpha=1}}y!==0&&f(C[0])&&(e.beginPath(),e.moveTo(y+.5,0),e.lineTo(y+.5,r),e.strokeStyle=l.borderColor,e.lineWidth=1,e.stroke()),e.restore(),m=y+z}),e.beginPath(),e.moveTo(m+.5,0),e.lineTo(m+.5,r),e.moveTo(0,r+.5),e.lineTo(n,r+.5),e.strokeStyle=l.borderColor,e.lineWidth=1,e.stroke()}const Ao=30;function ld(e,t,n,o,r){return r?{x:e,y:t,width:Ao,height:Math.min(Ao,o)}:{x:e+n-Ao,y:Math.max(t,t+o/2-Ao/2),width:Ao,height:Math.min(Ao,o)}}function Ss(e,t){const n=[];let o=e.x+e.width-26*t.length;const r=e.y+e.height/2-13,i=26,l=26;for(let s=0;s<t.length;s++)n.push({x:o,y:r,width:l,height:i}),o+=26;return n}function rr(e,t,n){return!n||e===void 0||(e.x=t-(e.x-t)-e.width),e}function Ms(e,t,n,o,r,i,l,s){var b;const c=l.cellHorizontalPadding,f=l.headerIconSize,d=ld(n,o,r,i,!1);let p=n+c;const w=t.icon===void 0?void 0:{x:p,y:o+(i-f)/2,width:f,height:f},g=w===void 0||t.overlayIcon===void 0?void 0:{x:w.x+9,y:w.y+6,width:18,height:18};w!==void 0&&(p+=Math.ceil(f*1.3));const h={x:p,y:o,width:r-p,height:i};let m;if(t.indicatorIcon!==void 0){const y=e===void 0?((b=ds(t.title,l.headerFontFull))==null?void 0:b.width)??0:Oo(t.title,e,l.headerFontFull).width;h.width=y,p+=y+c,m={x:p,y:o+(i-f)/2,width:f,height:f}}const C=n+r/2;return{menuBounds:rr(d,C,s),iconBounds:rr(w,C,s),iconOverlayBounds:rr(g,C,s),textBounds:rr(h,C,s),indicatorIconBounds:rr(m,C,s)}}function bl(e,t,n,o,r,i,l,s,c,f,d,p,w,g,h,m){if(i.rowMarker!==void 0&&i.headerRowMarkerDisabled!==!0){const y=i.rowMarkerChecked;y!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=p);const k=i.headerRowMarkerTheme!==void 0?Wn(s,i.headerRowMarkerTheme):s;Ni(e,k,y,t,n,o,r,!1,void 0,void 0,18,"center",i.rowMarker),y!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=1);return}const C=l?s.textHeaderSelected:s.textHeader,b=i.hasMenu===!0&&(c||g&&l)&&m.menuBounds!==void 0;if(i.icon!==void 0&&m.iconBounds!==void 0){let y=l?"selected":"normal";i.style==="highlight"&&(y=l?"selected":"special"),w.drawSprite(i.icon,y,e,m.iconBounds.x,m.iconBounds.y,m.iconBounds.width,s),i.overlayIcon!==void 0&&m.iconOverlayBounds!==void 0&&w.drawSprite(i.overlayIcon,l?"selected":"special",e,m.iconOverlayBounds.x,m.iconOverlayBounds.y,m.iconOverlayBounds.width,s)}if(b&&o>35){const k=h?35:o-35,z=h?35*.7:o-35*.7,L=k/o,H=z/o,A=e.createLinearGradient(t,0,t+o,0),_=wo(C,0);A.addColorStop(h?1:0,C),A.addColorStop(L,C),A.addColorStop(H,_),A.addColorStop(h?0:1,_),e.fillStyle=A}else e.fillStyle=C;if(h&&(e.textAlign="right"),m.textBounds!==void 0&&e.fillText(i.title,h?m.textBounds.x+m.textBounds.width:m.textBounds.x,n+r/2+to(e,s.headerFontFull)),h&&(e.textAlign="left"),i.indicatorIcon!==void 0&&m.indicatorIconBounds!==void 0&&(!b||!hr(m.menuBounds.x,m.menuBounds.y,m.menuBounds.width,m.menuBounds.height,m.indicatorIconBounds.x,m.indicatorIconBounds.y,m.indicatorIconBounds.width,m.indicatorIconBounds.height))){let y=l?"selected":"normal";i.style==="highlight"&&(y=l?"selected":"special"),w.drawSprite(i.indicatorIcon,y,e,m.indicatorIconBounds.x,m.indicatorIconBounds.y,m.indicatorIconBounds.width,s)}if(b&&m.menuBounds!==void 0){const y=m.menuBounds,k=f!==void 0&&d!==void 0&&po(y,f+t,d+n);if(k||(e.globalAlpha=.7),i.menuIcon===void 0||i.menuIcon===Kr.Triangle){e.beginPath();const z=y.x+y.width/2-5.5,L=y.y+y.height/2-3;mc(e,[{x:z,y:L},{x:z+11,y:L},{x:z+5.5,y:L+6}],1),e.fillStyle=C,e.fill()}else if(i.menuIcon===Kr.Dots){e.beginPath();const z=y.x+y.width/2,L=y.y+y.height/2;gc(e,z,L),e.fillStyle=C,e.fill()}else{const z=y.x+(y.width-s.headerIconSize)/2,L=y.y+(y.height-s.headerIconSize)/2;w.drawSprite(i.menuIcon,"normal",e,z,L,s.headerIconSize,s)}k||(e.globalAlpha=1)}}function Rs(e,t,n,o,r,i,l,s,c,f,d,p,w,g,h,m){const C=Pi(i.title)==="rtl",b=Ms(e,i,t,n,o,r,s,C);h!==void 0?h({ctx:e,theme:s,rect:{x:t,y:n,width:o,height:r},column:i,columnIndex:i.sourceIndex,isSelected:l,hoverAmount:w,isHovered:c,hasSelectedCell:p,spriteManager:g,menuBounds:(b==null?void 0:b.menuBounds)??{x:0,y:0,height:0,width:0}},()=>bl(e,t,n,o,r,i,l,s,c,f,d,w,g,m,C,b)):bl(e,t,n,o,r,i,l,s,c,f,d,w,g,m,C,b)}function sd(e,t,n,o,r,i,l,s,c,f,d,p,w,g,h,m,C,b,y){if(b!==void 0||t[t.length-1]!==n[t.length-1])return;const k=bs(C);no(t,c,l,s,i,(z,L,H,A,_)=>{if(z!==t[t.length-1])return;L+=z.width;const M=Math.max(L,A);M>o||(e.save(),e.beginPath(),e.rect(M,i+1,1e4,r-i-1),e.clip(),Qr(_,H,r,f,d,h,m,k,(N,O,F,E)=>{if(!E&&C.length>0&&!C.some(Ie=>hr(L,N,1e4,F,Ie.x,Ie.y,Ie.width,Ie.height)))return;const R=w.hasIndex(O),ce=g.hasIndex(O);e.beginPath();const te=p==null?void 0:p(O),le=te===void 0?y:Wn(y,te);le.bgCell!==y.bgCell&&(e.fillStyle=le.bgCell,e.fillRect(L,N,1e4,F)),ce&&(e.fillStyle=le.bgHeader,e.fillRect(L,N,1e4,F)),R&&(e.fillStyle=le.accentLight,e.fillRect(L,N,1e4,F))}),e.restore())})}function ad(e,t,n,o,r,i,l,s,c){let f=!1;for(const h of t)if(!h.sticky){f=l(h.sourceIndex);break}const d=c.horizontalBorderColor??c.borderColor,p=c.borderColor,w=f?Wo(t):0;let g;if(w!==0&&(g=gl(p,c.bgCell),e.beginPath(),e.moveTo(w+.5,0),e.lineTo(w+.5,o),e.strokeStyle=g,e.stroke()),r>0){const h=p===d&&g!==void 0?g:gl(d,c.bgCell),m=yo(i,r,s);e.beginPath(),e.moveTo(0,o-m+.5),e.lineTo(n,o-m+.5),e.strokeStyle=h,e.stroke()}}const Es=(e,t,n)=>{let o=0,r=t,i=0,l=n;if(e!==void 0&&e.length>0){o=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,l=Number.MIN_SAFE_INTEGER;for(const s of e)o=Math.min(o,s.x-1),r=Math.max(r,s.x+s.width+1),i=Math.min(i,s.y-1),l=Math.max(l,s.y+s.height+1)}return{minX:o,maxX:r,minY:i,maxY:l}};function cd(e,t,n,o,r,i,l,s,c,f,d,p,w,g,h){var F;const m=h.bgCell,{minX:C,maxX:b,minY:y,maxY:k}=Es(s,i,l),z=[],L=l-yo(g,w,f);let H=c,A=n,_=0;for(;H+r<L;){const E=H+r,R=f(A);if(E>=y&&E<=k-1){const ce=d==null?void 0:d(A),te=ce==null?void 0:ce.bgCell;te!==void 0&&te!==m&&A>=g-w&&z.push({x:C,y:E,w:b-C,h:R,color:te})}H+=R,A<g-w&&(_=H),A++}let M=0;const N=Math.min(L,k)-_;if(N>0)for(let E=0;E<t.length;E++){const R=t[E];if(R.width===0)continue;const ce=R.sticky?M:M+o,te=(F=R.themeOverride)==null?void 0:F.bgCell;te!==void 0&&te!==m&&ce>=C&&ce<=b&&p(E+1)&&z.push({x:ce,y:_,w:R.width,h:N,color:te}),M+=R.width}if(z.length===0)return;let O;e.beginPath();for(let E=z.length-1;E>=0;E--){const R=z[E];O===void 0?O=R.color:R.color!==O&&(e.fillStyle=O,e.fill(),e.beginPath(),O=R.color),e.rect(R.x,R.y,R.w,R.h)}O!==void 0&&(e.fillStyle=O,e.fill()),e.beginPath()}function Cl(e,t,n,o,r,i,l,s,c,f,d,p,w,g,h,m,C,b=!1){if(c!==void 0){e.beginPath(),e.save(),e.rect(0,0,i,l);for(const F of c)e.rect(F.x+1,F.y+1,F.width-1,F.height-1);e.clip("evenodd")}const y=C.horizontalBorderColor??C.borderColor,k=C.borderColor,{minX:z,maxX:L,minY:H,maxY:A}=Es(s,i,l),_=[];e.beginPath();let M=.5;for(let F=0;F<t.length;F++){const E=t[F];if(E.width===0)continue;M+=E.width;const R=E.sticky?M:M+o;R>=z&&R<=L&&g(F+1)&&_.push({x1:R,y1:Math.max(f,H),x2:R,y2:Math.min(l,A),color:k})}let N=l+.5;for(let F=m-h;F<m;F++){const E=p(F);N-=E,_.push({x1:z,y1:N,x2:L,y2:N,color:y})}if(b!==!0){let F=d+.5,E=n;const R=N;for(;F+r<R;){const ce=F+r;if(ce>=H&&ce<=A-1){const te=w==null?void 0:w(E);_.push({x1:z,y1:ce,x2:L,y2:ce,color:(te==null?void 0:te.horizontalBorderColor)??(te==null?void 0:te.borderColor)??y})}F+=p(E),E++}}const O=Ta(_,F=>F.color);for(const F of Object.keys(O)){e.strokeStyle=F;for(const E of O[F])e.moveTo(E.x1,E.y1),e.lineTo(E.x2,E.y2);e.stroke(),e.beginPath()}c!==void 0&&e.restore()}function dd(e,t,n,o,r,i,l,s,c,f,d,p,w,g,h,m,C,b,y){const k=[];e.imageSmoothingEnabled=!1;const z=Math.min(r.cellYOffset,l),L=Math.max(r.cellYOffset,l);let H=0;if(typeof b=="number")H+=(L-z)*b;else for(let R=z;R<L;R++)H+=b(R);l>r.cellYOffset&&(H=-H),H+=c-r.translateY;const A=Math.min(r.cellXOffset,i),_=Math.max(r.cellXOffset,i);let M=0;for(let R=A;R<_;R++)M+=m[R].width;i>r.cellXOffset&&(M=-M),M+=s-r.translateX;const N=Wo(C);if(M!==0&&H!==0)return{regions:[]};const O=f>0?yo(w,f,b):0,F=d-N-Math.abs(M),E=p-g-O-Math.abs(H)-1;if(F>150&&E>150){const R={sx:0,sy:0,sw:d*h,sh:p*h,dx:0,dy:0,dw:d*h,dh:p*h};if(H>0?(R.sy=(g+1)*h,R.sh=E*h,R.dy=(H+g+1)*h,R.dh=E*h,k.push({x:0,y:g,width:d,height:H+1})):H<0&&(R.sy=(-H+g+1)*h,R.sh=E*h,R.dy=(g+1)*h,R.dh=E*h,k.push({x:0,y:p+H-O,width:d,height:-H+O})),M>0?(R.sx=N*h,R.sw=F*h,R.dx=(M+N)*h,R.dw=F*h,k.push({x:N-1,y:0,width:M+2,height:p})):M<0&&(R.sx=(N-M)*h,R.sw=F*h,R.dx=N*h,R.dw=F*h,k.push({x:d+M,y:0,width:-M,height:p})),e.setTransform(1,0,0,1,0,0),y){if(N>0&&M!==0&&H===0&&(o===void 0||(n==null?void 0:n[1])!==!1)){const ce=N*h,te=p*h;e.drawImage(t,0,0,ce,te,0,0,ce,te)}if(O>0&&M===0&&H!==0&&(o===void 0||(n==null?void 0:n[0])!==!1)){const ce=(p-O)*h,te=d*h,le=O*h;e.drawImage(t,0,ce,te,le,0,ce,te,le)}}e.drawImage(t,R.sx,R.sy,R.sw,R.sh,R.dx,R.dy,R.dw,R.dh),e.scale(h,h)}return e.imageSmoothingEnabled=!0,{regions:k}}function ud(e,t,n,o,r,i,l,s,c,f){const d=[];return t!==e.cellXOffset||n!==e.cellYOffset||o!==e.translateX||r!==e.translateY||no(c,n,o,r,s,(p,w,g,h)=>{if(p.sourceIndex===f){const m=Math.max(w,h)+1;return d.push({x:m,y:0,width:i-m,height:l}),!0}}),d}function fd(e,t){if(t===void 0||e.width!==t.width||e.height!==t.height||e.theme!==t.theme||e.headerHeight!==t.headerHeight||e.rowHeight!==t.rowHeight||e.rows!==t.rows||e.freezeColumns!==t.freezeColumns||e.getRowThemeOverride!==t.getRowThemeOverride||e.isFocused!==t.isFocused||e.isResizing!==t.isResizing||e.verticalBorder!==t.verticalBorder||e.getCellContent!==t.getCellContent||e.highlightRegions!==t.highlightRegions||e.selection!==t.selection||e.dragAndDropState!==t.dragAndDropState||e.prelightCells!==t.prelightCells||e.touchMode!==t.touchMode||e.maxScaleFactor!==t.maxScaleFactor)return!1;if(e.mappedColumns!==t.mappedColumns){if(e.mappedColumns.length>100||e.mappedColumns.length!==t.mappedColumns.length)return!1;let n;for(let o=0;o<e.mappedColumns.length;o++){const r=e.mappedColumns[o],i=t.mappedColumns[o];if($o(r,i))continue;if(n!==void 0||r.width===i.width)return!1;const{width:l,...s}=r,{width:c,...f}=i;if(!$o(s,f))return!1;n=o}return n===void 0?!0:n}return!0}function vl(e,t,n,o,r,i,l,s,c,f,d,p,w,g,h,m){const C=h==null?void 0:h.filter(A=>A.style!=="no-outline");if(C===void 0||C.length===0)return;const b=Wo(s),y=yo(g,w,p),k=[c,0,s.length,g-w],z=[b,0,t,n-y],L=C.map(A=>{const _=A.range,M=A.style??"dashed";return td(_,k,t,n,z).map(N=>{const O=N.rect,F=Hi(O.x,O.y,t,n,d,f+d,o,r,i,l,g,c,w,s,p),E=O.width===1&&O.height===1?F:Hi(O.x+O.width-1,O.y+O.height-1,t,n,d,f+d,o,r,i,l,g,c,w,s,p);return O.x+O.width>=s.length&&(E.width-=1),O.y+O.height>=g&&(E.height-=1),{color:A.color,style:M,clip:N.clip,rect:ed({x:F.x,y:F.y,width:E.x+E.width-F.x,height:E.y+E.height-F.y},t,n,8)}})}),H=()=>{e.lineWidth=1;let A=!1;for(const _ of L)for(const M of _)if((M==null?void 0:M.rect)!==void 0&&hr(0,0,t,n,M.rect.x,M.rect.y,M.rect.width,M.rect.height)){const N=A,O=!Qc(M.clip,M.rect);O&&(e.save(),e.rect(M.clip.x,M.clip.y,M.clip.width,M.clip.height),e.clip()),M.style==="dashed"&&!A?(e.setLineDash([5,3]),A=!0):(M.style==="solid"||M.style==="solid-outline")&&A&&(e.setLineDash([]),A=!1),e.strokeStyle=M.style==="solid-outline"?Qt(Qt(M.color,m.borderColor),m.bgCell):wo(M.color,1),e.strokeRect(M.rect.x+.5,M.rect.y+.5,M.rect.width-1,M.rect.height-1),O&&(e.restore(),A=N)}A&&e.setLineDash([])};return H(),H}function xl(e,t,n,o,r){e.beginPath(),e.moveTo(t,n),e.lineTo(t,o),e.lineWidth=2,e.strokeStyle=r,e.stroke(),e.globalAlpha=1}function vi(e,t,n,o,r,i,l,s,c,f,d,p,w,g,h,m,C){if(d.current===void 0)return;const b=d.current.range,y=d.current.cell,k=[b.x+b.width-1,b.y+b.height-1];if(y[1]>=C&&k[1]>=C||!l.some(R=>R.sourceIndex===y[0]||R.sourceIndex===k[0]))return;const[L,H]=d.current.cell,A=w(d.current.cell),_=A.span??[L,L],M=H>=C-g,N=g>0&&!M?yo(C,g,p)-1:0,O=k[1];let F;if(no(l,o,r,i,f,(R,ce,te,le,Ie)=>{if(R.sticky&&L>R.sourceIndex)return;const be=R.sourceIndex<_[0],Z=R.sourceIndex>_[1],K=R.sourceIndex===k[0];if(!(!K&&(be||Z)))return Qr(Ie,te,n,C,p,g,h,void 0,(me,ne,pe)=>{if(ne!==H&&ne!==O)return;let ue=ce,V=R.width;if(A.span!==void 0){const Ce=vs(A.span,ce,me,R.width,pe,R,s),Ke=R.sticky?Ce[0]:Ce[1];Ke!==void 0&&(ue=Ke.x,V=Ke.width)}return ne===O&&K&&m&&(F=()=>{var Ce;le>ue&&!R.sticky&&(e.beginPath(),e.rect(le,0,t-le,n),e.clip()),e.beginPath(),e.rect(ue+V-4,me+pe-4,4,4),e.fillStyle=((Ce=R.themeOverride)==null?void 0:Ce.accentColor)??c.accentColor,e.fill()}),F!==void 0}),F!==void 0}),F===void 0)return;const E=()=>{e.save(),e.beginPath(),e.rect(0,f,t,n-f-N),e.clip(),F==null||F(),e.restore()};return E(),E}function hd(e,t,n,o,r,i,l,s,c){c===void 0||c.size===0||(e.beginPath(),Cs(t,n,i,o,(f,d,p,w,g,h)=>{c.hasItemInRectangle({x:f[0],y:-2,width:f[1]-f[0]+1,height:1})&&e.rect(p,w,g,h)}),no(t,s,i,l,r,(f,d,p,w)=>{const g=Math.max(0,w-d),h=d+g+1,m=f.width-g-1;c.has([f.sourceIndex,-1])&&e.rect(h,o,m,r-o)}),e.clip())}function gd(e,t,n,o,r,i,l,s,c,f){let d=0;return no(e,i,o,r,n,(p,w,g,h,m)=>(Qr(m,g,t,l,s,c,f,void 0,(C,b,y,k)=>{k||(d=Math.max(b,d))}),!0)),d}function kl(e,t){var un;const{canvasCtx:n,headerCanvasCtx:o,width:r,height:i,cellXOffset:l,cellYOffset:s,translateX:c,translateY:f,mappedColumns:d,enableGroups:p,freezeColumns:w,dragAndDropState:g,theme:h,drawFocus:m,headerHeight:C,groupHeaderHeight:b,disabledRows:y,rowHeight:k,verticalBorder:z,overrideCursor:L,isResizing:H,selection:A,fillHandle:_,freezeTrailingRows:M,rows:N,getCellContent:O,getGroupDetails:F,getRowThemeOverride:E,isFocused:R,drawHeaderCallback:ce,prelightCells:te,drawCellCallback:le,highlightRegions:Ie,resizeCol:be,imageLoader:Z,lastBlitData:K,hoverValues:me,hyperWrapping:ne,hoverInfo:pe,spriteManager:ue,maxScaleFactor:V,hasAppendRow:ve,touchMode:Ce,enqueue:Ke,renderStateProvider:ot,getCellRenderer:wt,renderStrategy:rt,bufferACtx:Be,bufferBCtx:Ve,damage:Me,minimumCellWidth:yt,resizeIndicator:dt}=e;if(r===0||i===0)return;const Ze=rt==="double-buffer",j=Math.min(V,Math.ceil(window.devicePixelRatio??1)),Ne=rt!=="direct"&&fd(e,t),Fe=n.canvas;(Fe.width!==r*j||Fe.height!==i*j)&&(Fe.width=r*j,Fe.height=i*j,Fe.style.width=r+"px",Fe.style.height=i+"px");const De=o.canvas,fe=p?b+C:C,Ge=fe+1;(De.width!==r*j||De.height!==Ge*j)&&(De.width=r*j,De.height=Ge*j,De.style.width=r+"px",De.style.height=Ge+"px");const $e=Be.canvas,We=Ve.canvas;Ze&&($e.width!==r*j||$e.height!==i*j)&&($e.width=r*j,$e.height=i*j,K.current!==void 0&&(K.current.aBufferScroll=void 0)),Ze&&(We.width!==r*j||We.height!==i*j)&&(We.width=r*j,We.height=i*j,K.current!==void 0&&(K.current.bBufferScroll=void 0));const de=K.current;if(Ne===!0&&l===(de==null?void 0:de.cellXOffset)&&s===(de==null?void 0:de.cellYOffset)&&c===(de==null?void 0:de.translateX)&&f===(de==null?void 0:de.translateY))return;let xe=null;Ze&&(xe=n);const tt=o;let Ue;Ze?Me!==void 0?Ue=(de==null?void 0:de.lastBuffer)==="b"?Ve:Be:Ue=(de==null?void 0:de.lastBuffer)==="b"?Be:Ve:Ue=n;const _e=Ue.canvas,ut=Ze?_e===$e?We:$e:Fe,Je=typeof k=="number"?()=>k:k;tt.save(),Ue.save(),tt.beginPath(),Ue.beginPath(),tt.textBaseline="middle",Ue.textBaseline="middle",j!==1&&(tt.scale(j,j),Ue.scale(j,j));const Te=Di(d,l,r,g,c);let kt=[];const zt=m&&((un=A.current)==null?void 0:un.cell[1])===s&&f===0;let Ct=!1;if(Ie!==void 0){for(const ye of Ie)if(ye.style!=="no-outline"&&ye.range.y===s&&f===0){Ct=!0;break}}const St=()=>{rd(tt,Te,p,pe,r,c,C,b,g,H,A,h,ue,me,z,F,Me,ce,Ce),Cl(tt,Te,s,c,f,r,i,void 0,void 0,b,fe,Je,E,z,M,N,h,!0),tt.beginPath(),tt.moveTo(0,Ge-.5),tt.lineTo(r,Ge-.5),tt.strokeStyle=Qt(h.headerBottomBorderColor??h.horizontalBorderColor??h.borderColor,h.bgHeader),tt.stroke(),Ct&&vl(tt,r,i,l,s,c,f,d,w,C,b,k,M,N,Ie,h),zt&&vi(tt,r,i,s,c,f,Te,d,h,fe,A,Je,O,M,ve,_,N)};if(Me!==void 0){const ye=Te[Te.length-1].sourceIndex+1,mt=Me.hasItemInRegion([{x:l,y:-2,width:ye,height:2},{x:l,y:s,width:ye,height:300},{x:0,y:s,width:w,height:300},{x:0,y:-2,width:w,height:2},{x:l,y:N-M,width:ye,height:M,when:M>0}]),Cn=en=>{yl(en,Te,d,i,fe,c,f,s,N,Je,O,F,E,y,R,m,M,ve,kt,Me,A,te,Ie,Z,ue,me,pe,le,ne,h,Ke,ot,wt,L,yt);const tn=A.current;_&&m&&tn!==void 0&&Me.has(ss(tn.range))&&vi(en,r,i,s,c,f,Te,d,h,fe,A,Je,O,M,ve,_,N)};mt&&(Cn(Ue),xe!==null&&(xe.save(),xe.scale(j,j),xe.textBaseline="middle",Cn(xe),xe.restore()),Me.hasHeader()&&(hd(tt,Te,r,b,fe,c,f,s,Me),St())),Ue.restore(),tt.restore();return}if((Ne!==!0||l!==(de==null?void 0:de.cellXOffset)||c!==(de==null?void 0:de.translateX)||zt!==(de==null?void 0:de.mustDrawFocusOnHeader)||Ct!==(de==null?void 0:de.mustDrawHighlightRingsOnHeader))&&St(),Ne===!0){Jt(ut!==void 0&&de!==void 0);const{regions:ye}=dd(Ue,ut,ut===$e?de.aBufferScroll:de.bBufferScroll,ut===$e?de.bBufferScroll:de.aBufferScroll,de,l,s,c,f,M,r,i,N,fe,j,d,Te,k,Ze);kt=ye}else Ne!==!1&&(Jt(de!==void 0),kt=ud(de,l,s,c,f,r,i,fe,Te,Ne));ad(Ue,Te,r,i,M,N,z,Je,h);const Pt=vl(Ue,r,i,l,s,c,f,d,w,C,b,k,M,N,Ie,h),gt=m?vi(Ue,r,i,s,c,f,Te,d,h,fe,A,Je,O,M,ve,_,N):void 0;if(Ue.fillStyle=h.bgCell,kt.length>0){Ue.beginPath();for(const ye of kt)Ue.rect(ye.x,ye.y,ye.width,ye.height);Ue.clip(),Ue.fill(),Ue.beginPath()}else Ue.fillRect(0,0,r,i);const bn=yl(Ue,Te,d,i,fe,c,f,s,N,Je,O,F,E,y,R,m,M,ve,kt,Me,A,te,Ie,Z,ue,me,pe,le,ne,h,Ke,ot,wt,L,yt);sd(Ue,Te,d,r,i,fe,c,f,s,N,Je,E,A.rows,y,M,ve,kt,Me,h),cd(Ue,Te,s,c,f,r,i,kt,fe,Je,E,z,M,N,h),Cl(Ue,Te,s,c,f,r,i,kt,bn,b,fe,Je,E,z,M,N,h),Pt==null||Pt(),gt==null||gt(),H&&dt!=="none"&&no(Te,0,c,0,fe,(ye,mt)=>ye.sourceIndex===be?(xl(tt,mt+ye.width,0,fe+1,Qt(h.resizeIndicatorColor??h.accentLight,h.bgHeader)),dt==="full"&&xl(Ue,mt+ye.width,fe,i,Qt(h.resizeIndicatorColor??h.accentLight,h.bgCell)),!0):!1),xe!==null&&(xe.fillStyle=h.bgCell,xe.fillRect(0,0,r,i),xe.drawImage(Ue.canvas,0,0));const On=gd(Te,i,fe,c,f,s,N,Je,M,ve);Z==null||Z.setWindow({x:l,y:s,width:Te.length,height:On-s},w,Array.from({length:M},(ye,mt)=>N-1-mt));const st=de!==void 0&&(l!==de.cellXOffset||c!==de.translateX),Dn=de!==void 0&&(s!==de.cellYOffset||f!==de.translateY);K.current={cellXOffset:l,cellYOffset:s,translateX:c,translateY:f,mustDrawFocusOnHeader:zt,mustDrawHighlightRingsOnHeader:Ct,lastBuffer:Ze?_e===$e?"a":"b":void 0,aBufferScroll:_e===$e?[st,Dn]:de==null?void 0:de.aBufferScroll,bBufferScroll:_e===We?[st,Dn]:de==null?void 0:de.bBufferScroll},Ue.restore(),tt.restore()}const md=80;function pd(e){const t=e-1;return t*t*t+1}class wd{constructor(t){Oe(this,"callback");Oe(this,"currentHoveredItem");Oe(this,"leavingItems",[]);Oe(this,"lastAnimationTime");Oe(this,"addToLeavingItems",t=>{this.leavingItems.some(o=>sr(o.item,t.item))||this.leavingItems.push(t)});Oe(this,"removeFromLeavingItems",t=>{const n=this.leavingItems.find(o=>sr(o.item,t));return this.leavingItems=this.leavingItems.filter(o=>o!==n),(n==null?void 0:n.hoverAmount)??0});Oe(this,"cleanUpLeavingElements",()=>{this.leavingItems=this.leavingItems.filter(t=>t.hoverAmount>0)});Oe(this,"shouldStep",()=>{const t=this.leavingItems.length>0,n=this.currentHoveredItem!==void 0&&this.currentHoveredItem.hoverAmount<1;return t||n});Oe(this,"getAnimatingItems",()=>this.currentHoveredItem!==void 0?[...this.leavingItems,this.currentHoveredItem]:this.leavingItems.map(t=>({...t,hoverAmount:pd(t.hoverAmount)})));Oe(this,"step",t=>{if(this.lastAnimationTime===void 0)this.lastAnimationTime=t;else{const o=(t-this.lastAnimationTime)/md;for(const i of this.leavingItems)i.hoverAmount=an(i.hoverAmount-o,0,1);this.currentHoveredItem!==void 0&&(this.currentHoveredItem.hoverAmount=an(this.currentHoveredItem.hoverAmount+o,0,1));const r=this.getAnimatingItems();this.callback(r),this.cleanUpLeavingElements()}this.shouldStep()?(this.lastAnimationTime=t,window.requestAnimationFrame(this.step)):this.lastAnimationTime=void 0});Oe(this,"setHovered",t=>{var n;if(!sr((n=this.currentHoveredItem)==null?void 0:n.item,t)){if(this.currentHoveredItem!==void 0&&this.addToLeavingItems(this.currentHoveredItem),t!==void 0){const o=this.removeFromLeavingItems(t);this.currentHoveredItem={item:t,hoverAmount:o}}else this.currentHoveredItem=void 0;this.lastAnimationTime===void 0&&window.requestAnimationFrame(this.step)}});this.callback=t}}class yd{constructor(t){Oe(this,"fn");Oe(this,"val");this.fn=t}get value(){return this.val??(this.val=this.fn())}}function Xi(e){return new yd(e)}const bd=Xi(()=>window.navigator.userAgent.includes("Firefox")),Vr=Xi(()=>window.navigator.userAgent.includes("Mac OS")&&window.navigator.userAgent.includes("Safari")&&!window.navigator.userAgent.includes("Chrome")),jr=Xi(()=>window.navigator.platform.toLowerCase().startsWith("mac"));function Cd(e){const t=a.useRef([]),n=a.useRef(0),o=a.useRef(e);o.current=e;const r=a.useCallback(()=>{const i=()=>window.requestAnimationFrame(l),l=()=>{const s=t.current.map(Oi);t.current=[],o.current(new cr(s)),t.current.length>0?n.current++:n.current=0};window.requestAnimationFrame(n.current>600?i:l)},[]);return a.useCallback(i=>{t.current.length===0&&r();const l=yn(i[0],i[1]);t.current.includes(l)||t.current.push(l)},[r])}const Qn="header",cn="group-header",qr="out-of-bounds";var zo;(function(e){e[e.Start=-2]="Start",e[e.StartPadding=-1]="StartPadding",e[e.Center=0]="Center",e[e.EndPadding=1]="EndPadding",e[e.End=2]="End"})(zo||(zo={}));function Is(e,t){return e===t?!0:(e==null?void 0:e.kind)==="out-of-bounds"?(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])&&(e==null?void 0:e.region[0])===(t==null?void 0:t.region[0])&&(e==null?void 0:e.region[1])===(t==null?void 0:t.region[1]):(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])}const Sl=6,vd=(e,t)=>{if(e.kind===U.Custom)return e.copyData;const n=t==null?void 0:t(e);return(n==null?void 0:n.getAccessibilityString(e))??""},xd=(e,t)=>{const{width:n,height:o,accessibilityHeight:r,columns:i,cellXOffset:l,cellYOffset:s,headerHeight:c,fillHandle:f=!1,groupHeaderHeight:d,rowHeight:p,rows:w,getCellContent:g,getRowThemeOverride:h,onHeaderMenuClick:m,onHeaderIndicatorClick:C,enableGroups:b,isFilling:y,onCanvasFocused:k,onCanvasBlur:z,isFocused:L,selection:H,freezeColumns:A,onContextMenu:_,freezeTrailingRows:M,fixedShadowX:N=!0,fixedShadowY:O=!0,drawFocusRing:F,onMouseDown:E,onMouseUp:R,onMouseMoveRaw:ce,onMouseMove:te,onItemHovered:le,dragAndDropState:Ie,firstColAccessible:be,onKeyDown:Z,onKeyUp:K,highlightRegions:me,canvasRef:ne,onDragStart:pe,onDragEnd:ue,eventTargetRef:V,isResizing:ve,resizeColumn:Ce,isDragging:Ke,isDraggable:ot=!1,allowResize:wt,disabledRows:rt,hasAppendRow:Be,getGroupDetails:Ve,theme:Me,prelightCells:yt,headerIcons:dt,verticalBorder:Ze,drawCell:j,drawHeader:Ne,onCellFocused:Fe,onDragOverCell:De,onDrop:fe,onDragLeave:Ge,imageWindowLoader:$e,smoothScrollX:We=!1,smoothScrollY:de=!1,experimental:xe,getCellRenderer:tt,resizeIndicator:Ue="full"}=e,_e=e.translateX??0,ut=e.translateY??0,Je=Math.max(A,Math.min(i.length-1,l)),Te=a.useRef(null),kt=a.useRef(window),zt=kt.current,Ct=$e,St=a.useRef(),[Pt,gt]=a.useState(!1),bn=a.useRef([]),On=a.useRef(),[st,Dn]=a.useState(),[un,ye]=a.useState(),mt=a.useRef(null),[Cn,en]=a.useState(),[tn,ze]=a.useState(!1),Mt=a.useRef(tn);Mt.current=tn;const ft=a.useMemo(()=>new Zc(dt,()=>{bo.current=void 0,ro.current()}),[dt]),Ot=b?d+c:c,Tt=a.useRef(-1),Yt=((xe==null?void 0:xe.enableFirefoxRescaling)??!1)&&bd.value,Nn=((xe==null?void 0:xe.enableSafariRescaling)??!1)&&Vr.value;a.useLayoutEffect(()=>{window.devicePixelRatio===1||!Yt&&!Nn||(Tt.current!==-1&&gt(!0),window.clearTimeout(Tt.current),Tt.current=window.setTimeout(()=>{gt(!1),Tt.current=-1},200))},[s,Je,_e,ut,Yt,Nn]);const Rt=nc(i,A),Ft=N?Wo(Rt,Ie):0,Dt=a.useCallback((S,Y,ee)=>{const oe=S.getBoundingClientRect();if(Y>=Rt.length||ee>=w)return;const q=oe.width/n,ie=Hi(Y,ee,n,o,d,Ot,Je,s,_e,ut,w,A,M,Rt,p);return q!==1&&(ie.x*=q,ie.y*=q,ie.width*=q,ie.height*=q),ie.x+=oe.x,ie.y+=oe.y,ie},[n,o,d,Ot,Je,s,_e,ut,w,A,M,Rt,p]),Lt=a.useCallback((S,Y,ee,oe)=>{const q=S.getBoundingClientRect(),ie=q.width/n,He=(Y-q.left)/ie,Ae=(ee-q.top)/ie,se=5,Qe=Di(Rt,Je,n,void 0,_e);let re=0,Ee=0;oe instanceof MouseEvent&&(re=oe.button,Ee=oe.buttons);const ke=lc(He,Qe,_e),Xe=sc(Ae,o,b,c,d,w,p,s,ut,M),Ht=(oe==null?void 0:oe.shiftKey)===!0,Kt=(oe==null?void 0:oe.ctrlKey)===!0,je=(oe==null?void 0:oe.metaKey)===!0,bt=oe!==void 0&&!(oe instanceof MouseEvent)||(oe==null?void 0:oe.pointerType)==="touch",hn=[He<0?-1:n<He?1:0,Ae<Ot?-1:o<Ae?1:0];let Gt;if(ke===-1||Ae<0||He<0||Xe===void 0||He>n||Ae>o){const nt=He>n?1:He<0?-1:0,Vt=Ae>o?1:Ae<0?-1:0;let qt=nt*2,qe=Vt*2;nt===0&&(qt=ke===-1?zo.EndPadding:zo.Center),Vt===0&&(qe=Xe===void 0?zo.EndPadding:zo.Center);let xt=!1;if(ke===-1&&Xe===-1){const Vn=Dt(S,Rt.length-1,-1);Jt(Vn!==void 0),xt=Y<Vn.x+Vn.width+se}const Kn=He>n&&He<n+Ii()||Ae>o&&Ae<o+Ii();Gt={kind:qr,location:[ke!==-1?ke:He<0?0:Rt.length-1,Xe??w-1],region:[qt,qe],shiftKey:Ht,ctrlKey:Kt,metaKey:je,isEdge:xt,isTouch:bt,button:re,buttons:Ee,scrollEdge:hn,isMaybeScrollbar:Kn}}else if(Xe<=-1){let nt=Dt(S,ke,Xe);Jt(nt!==void 0);let Vt=nt!==void 0&&nt.x+nt.width-Y<=se;const qt=ke-1;Y-nt.x<=se&&qt>=0?(Vt=!0,nt=Dt(S,qt,Xe),Jt(nt!==void 0),Gt={kind:b&&Xe===-2?cn:Qn,location:[qt,Xe],bounds:nt,group:Rt[qt].group??"",isEdge:Vt,shiftKey:Ht,ctrlKey:Kt,metaKey:je,isTouch:bt,localEventX:Y-nt.x,localEventY:ee-nt.y,button:re,buttons:Ee,scrollEdge:hn}):Gt={kind:b&&Xe===-2?cn:Qn,group:Rt[ke].group??"",location:[ke,Xe],bounds:nt,isEdge:Vt,shiftKey:Ht,ctrlKey:Kt,metaKey:je,isTouch:bt,localEventX:Y-nt.x,localEventY:ee-nt.y,button:re,buttons:Ee,scrollEdge:hn}}else{const nt=Dt(S,ke,Xe);Jt(nt!==void 0);const Vt=nt!==void 0&&nt.x+nt.width-Y<se;let qt=!1;if(f&&H.current!==void 0){const qe=ss(H.current.range),xt=Dt(S,qe[0],qe[1]);if(xt!==void 0){const Kn=xt.x+xt.width-2,Vn=xt.y+xt.height-2;qt=Math.abs(Kn-Y)<Sl&&Math.abs(Vn-ee)<Sl}}Gt={kind:"cell",location:[ke,Xe],bounds:nt,isEdge:Vt,shiftKey:Ht,ctrlKey:Kt,isFillHandle:qt,metaKey:je,isTouch:bt,localEventX:Y-nt.x,localEventY:ee-nt.y,button:re,buttons:Ee,scrollEdge:hn}}return Gt},[n,Rt,Je,_e,o,b,c,d,w,p,s,ut,M,Dt,f,H,Ot]),[Hn]=st??[],mr=a.useRef(()=>{}),Xn=a.useRef(st);Xn.current=st;const[Tn,An]=a.useMemo(()=>{const S=document.createElement("canvas"),Y=document.createElement("canvas");return S.style.display="none",S.style.opacity="0",S.style.position="fixed",Y.style.display="none",Y.style.opacity="0",Y.style.position="fixed",[S.getContext("2d",{alpha:!1}),Y.getContext("2d",{alpha:!1})]},[]);a.useLayoutEffect(()=>{if(!(Tn===null||An===null))return document.documentElement.append(Tn.canvas),document.documentElement.append(An.canvas),()=>{Tn.canvas.remove(),An.canvas.remove()}},[Tn,An]);const vn=a.useMemo(()=>new pc,[]),pr=Yt&&Pt?1:Nn&&Pt?2:5,wr=(xe==null?void 0:xe.disableMinimumCellWidth)===!0?1:10,bo=a.useRef(),Co=a.useRef(null),vo=a.useRef(null),oo=a.useCallback(()=>{var He;const S=Te.current,Y=mt.current;if(S===null||Y===null||(Co.current===null&&(Co.current=S.getContext("2d",{alpha:!1}),S.width=0,S.height=0),vo.current===null&&(vo.current=Y.getContext("2d",{alpha:!1}),Y.width=0,Y.height=0),Co.current===null||vo.current===null||Tn===null||An===null))return;let ee=!1;const oe=Ae=>{ee=!0,en(Ae)},q=bo.current,ie={headerCanvasCtx:vo.current,canvasCtx:Co.current,bufferACtx:Tn,bufferBCtx:An,width:n,height:o,cellXOffset:Je,cellYOffset:s,translateX:Math.round(_e),translateY:Math.round(ut),mappedColumns:Rt,enableGroups:b,freezeColumns:A,dragAndDropState:Ie,theme:Me,headerHeight:c,groupHeaderHeight:d,disabledRows:rt??it.empty(),rowHeight:p,verticalBorder:Ze,isResizing:ve,resizeCol:Ce,isFocused:L,selection:H,fillHandle:f,drawCellCallback:j,hasAppendRow:Be,overrideCursor:oe,maxScaleFactor:pr,freezeTrailingRows:M,rows:w,drawFocus:F,getCellContent:g,getGroupDetails:Ve??(Ae=>({name:Ae})),getRowThemeOverride:h,drawHeaderCallback:Ne,prelightCells:yt,highlightRegions:me,imageLoader:Ct,lastBlitData:On,damage:St.current,hoverValues:bn.current,hoverInfo:Xn.current,spriteManager:ft,scrolling:Pt,hyperWrapping:(xe==null?void 0:xe.hyperWrapping)??!1,touchMode:tn,enqueue:mr.current,renderStateProvider:vn,renderStrategy:(xe==null?void 0:xe.renderStrategy)??(Vr.value?"double-buffer":"single-buffer"),getCellRenderer:tt,minimumCellWidth:wr,resizeIndicator:Ue};ie.damage===void 0?(bo.current=ie,kl(ie,q)):kl(ie,void 0),!ee&&(ie.damage===void 0||ie.damage.has((He=Xn==null?void 0:Xn.current)==null?void 0:He[0]))&&en(void 0)},[Tn,An,n,o,Je,s,_e,ut,Rt,b,A,Ie,Me,c,d,rt,p,Ze,ve,Be,Ce,L,H,f,M,w,F,pr,g,Ve,h,j,Ne,yt,me,Ct,ft,Pt,xe==null?void 0:xe.hyperWrapping,xe==null?void 0:xe.renderStrategy,tn,vn,tt,wr,Ue]),ro=a.useRef(oo);a.useLayoutEffect(()=>{oo(),ro.current=oo},[oo]),a.useLayoutEffect(()=>{(async()=>{var Y;((Y=document==null?void 0:document.fonts)==null?void 0:Y.ready)!==void 0&&(await document.fonts.ready,bo.current=void 0,ro.current())})()},[]);const Gn=a.useCallback(S=>{St.current=S,ro.current(),St.current=void 0},[]),ei=Cd(Gn);mr.current=ei;const yr=a.useCallback(S=>{Gn(new cr(S.map(Y=>Y.cell)))},[Gn]);Ct.setCallback(Gn);const[br,ti]=a.useState(!1),[xo,Un]=Hn??[],No=xo!==void 0&&Un===-1,ni=xo!==void 0&&Un===-2;let Xo=!1,Go=!1,io=Cn;if(io===void 0&&xo!==void 0&&Un!==void 0&&Un>-1&&Un<w){const S=g([xo,Un],!0);Xo=S.kind===dn.NewRow||S.kind===dn.Marker&&S.markerKind!=="number",Go=S.kind===U.Boolean&&zi(S),io=S.cursor}const _t=Ke?"grabbing":(un??!1)||ve?"col-resize":br||y?"crosshair":io!==void 0?io:No||Xo||Go||ni?"pointer":"default",Uo=a.useMemo(()=>({contain:"strict",display:"block",cursor:_t}),[_t]),Yo=a.useRef("default"),ko=V==null?void 0:V.current;ko!=null&&Yo.current!==Uo.cursor&&(ko.style.cursor=Yo.current=Uo.cursor);const Bn=a.useCallback((S,Y,ee,oe)=>{if(Ve===void 0)return;const q=Ve(S);if(q.actions!==void 0){const ie=Ss(Y,q.actions);for(const[He,Ae]of ie.entries())if(po(Ae,ee+Y.x,oe+Ae.y))return q.actions[He]}},[Ve]),zn=a.useCallback((S,Y,ee,oe)=>{const q=Rt[Y];if(!Ke&&!ve&&!(un??!1)){const ie=Dt(S,Y,-1);Jt(ie!==void 0);const He=Ms(void 0,q,ie.x,ie.y,ie.width,ie.height,Me,Pi(q.title)==="rtl");if(q.hasMenu===!0&&He.menuBounds!==void 0&&po(He.menuBounds,ee,oe))return{area:"menu",bounds:He.menuBounds};if(q.indicatorIcon!==void 0&&He.indicatorIconBounds!==void 0&&po(He.indicatorIconBounds,ee,oe))return{area:"indicator",bounds:He.indicatorIconBounds}}},[Rt,Dt,un,Ke,ve,Me]),So=a.useRef(0),xn=a.useRef(),kn=a.useRef(!1),lo=a.useCallback(S=>{const Y=Te.current,ee=V==null?void 0:V.current;if(Y===null||S.target!==Y&&S.target!==ee)return;kn.current=!0;let oe,q;if(S instanceof MouseEvent?(oe=S.clientX,q=S.clientY):(oe=S.touches[0].clientX,q=S.touches[0].clientY),S.target===ee&&ee!==null){const He=ee.getBoundingClientRect();if(oe>He.right||q>He.bottom)return}const ie=Lt(Y,oe,q,S);xn.current=ie.location,ie.isTouch&&(So.current=Date.now()),Mt.current!==ie.isTouch&&ze(ie.isTouch),!(ie.kind===Qn&&zn(Y,ie.location[0],oe,q)!==void 0)&&(ie.kind===cn&&Bn(ie.group,ie.bounds,ie.localEventX,ie.localEventY)!==void 0||(E==null||E(ie),!ie.isTouch&&ot!==!0&&ot!==ie.kind&&ie.button<3&&ie.button!==1&&S.preventDefault()))},[V,ot,Lt,Bn,zn,E]);$t("touchstart",lo,zt,!1),$t("mousedown",lo,zt,!1);const Cr=a.useRef(0),_o=a.useCallback(S=>{var Ee,ke;const Y=Cr.current;Cr.current=Date.now();const ee=Te.current;if(kn.current=!1,R===void 0||ee===null)return;const oe=V==null?void 0:V.current,q=S.target!==ee&&S.target!==oe;let ie,He,Ae=!0;if(S instanceof MouseEvent){if(ie=S.clientX,He=S.clientY,Ae=S.button<3,S.pointerType==="touch")return}else ie=S.changedTouches[0].clientX,He=S.changedTouches[0].clientY;let se=Lt(ee,ie,He,S);se.isTouch&&So.current!==0&&Date.now()-So.current>500&&(se={...se,isLongTouch:!0}),Y!==0&&Date.now()-Y<(se.isTouch?1e3:500)&&(se={...se,isDoubleClick:!0}),Mt.current!==se.isTouch&&ze(se.isTouch),!q&&S.cancelable&&Ae&&S.preventDefault();const[Qe]=se.location,re=zn(ee,Qe,ie,He);if(se.kind===Qn&&re!==void 0){(se.button!==0||((Ee=xn.current)==null?void 0:Ee[0])!==Qe||((ke=xn.current)==null?void 0:ke[1])!==-1)&&R(se,!0);return}else if(se.kind===cn){const Xe=Bn(se.group,se.bounds,se.localEventX,se.localEventY);if(Xe!==void 0){se.button===0&&Xe.onClick(se);return}}R(se,q)},[R,V,Lt,zn,Bn]);$t("mouseup",_o,zt,!1),$t("touchend",_o,zt,!1);const Re=a.useCallback(S=>{var Qe,re;const Y=Te.current;if(Y===null)return;const ee=V==null?void 0:V.current,oe=S.target!==Y&&S.target!==ee;let q,ie,He=!0;S instanceof MouseEvent?(q=S.clientX,ie=S.clientY,He=S.button<3):(q=S.changedTouches[0].clientX,ie=S.changedTouches[0].clientY);const Ae=Lt(Y,q,ie,S);Mt.current!==Ae.isTouch&&ze(Ae.isTouch),!oe&&S.cancelable&&He&&S.preventDefault();const[se]=Ae.location;if(Ae.kind===Qn){const Ee=zn(Y,se,q,ie);Ee!==void 0&&Ae.button===0&&((Qe=xn.current)==null?void 0:Qe[0])===se&&((re=xn.current)==null?void 0:re[1])===-1&&(Ee.area==="menu"?m==null||m(se,Ee.bounds):Ee.area==="indicator"&&(C==null||C(se,Ee.bounds)))}else if(Ae.kind===cn){const Ee=Bn(Ae.group,Ae.bounds,Ae.localEventX,Ae.localEventY);Ee!==void 0&&Ae.button===0&&Ee.onClick(Ae)}},[V,Lt,zn,m,C,Bn]);$t("click",Re,zt,!1);const vr=a.useCallback(S=>{const Y=Te.current,ee=V==null?void 0:V.current;if(Y===null||S.target!==Y&&S.target!==ee||_===void 0)return;const oe=Lt(Y,S.clientX,S.clientY,S);_(oe,()=>{S.cancelable&&S.preventDefault()})},[V,Lt,_]);$t("contextmenu",vr,(V==null?void 0:V.current)??null,!1);const xr=a.useCallback(S=>{St.current=new cr(S.map(Y=>Y.item)),bn.current=S,ro.current(),St.current=void 0},[]),nn=a.useMemo(()=>new wd(xr),[xr]),kr=a.useRef(nn);kr.current=nn,a.useLayoutEffect(()=>{const S=kr.current;if(Hn===void 0||Hn[1]<0){S.setHovered(Hn);return}const Y=g(Hn,!0),ee=tt(Y),oe=ee===void 0&&Y.kind===U.Custom||(ee==null?void 0:ee.needsHover)!==void 0&&(typeof ee.needsHover=="boolean"?ee.needsHover:ee.needsHover(Y));S.setHovered(oe?Hn:void 0)},[g,tt,Hn]);const fn=a.useRef(),Ko=a.useCallback(S=>{var Ae;const Y=Te.current;if(Y===null)return;const ee=V==null?void 0:V.current,oe=S.target!==Y&&S.target!==ee,q=Lt(Y,S.clientX,S.clientY,S);if(q.kind!=="out-of-bounds"&&oe&&!kn.current&&!q.isTouch)return;const ie=(se,Qe)=>{Dn(re=>re===se||(re==null?void 0:re[0][0])===(se==null?void 0:se[0][0])&&(re==null?void 0:re[0][1])===(se==null?void 0:se[0][1])&&((re==null?void 0:re[1][0])===(se==null?void 0:se[1][0])&&(re==null?void 0:re[1][1])===(se==null?void 0:se[1][1])||!Qe)?re:se)};if(!Is(q,fn.current))en(void 0),le==null||le(q),ie(q.kind===qr?void 0:[q.location,[q.localEventX,q.localEventY]],!0),fn.current=q;else if(q.kind==="cell"||q.kind===Qn||q.kind===cn){let se=!1,Qe=!0;if(q.kind==="cell"){const Ee=g(q.location);Qe=((Ae=tt(Ee))==null?void 0:Ae.needsHoverPosition)??Ee.kind===U.Custom,se=Qe}else se=!0;const re=[q.location,[q.localEventX,q.localEventY]];ie(re,Qe),Xn.current=re,se&&Gn(new cr([q.location]))}const He=q.location[0]>=(be?0:1);ye(q.kind===Qn&&q.isEdge&&He&&wt===!0),ti(q.kind==="cell"&&q.isFillHandle),ce==null||ce(S),te(q)},[V,Lt,be,wt,ce,te,le,g,tt,Gn]);$t("mousemove",Ko,zt,!0);const Sr=a.useCallback(S=>{const Y=Te.current;if(Y===null)return;let ee,oe;H.current!==void 0&&(ee=Dt(Y,H.current.cell[0],H.current.cell[1]),oe=H.current.cell),Z==null||Z({bounds:ee,stopPropagation:()=>S.stopPropagation(),preventDefault:()=>S.preventDefault(),cancel:()=>{},ctrlKey:S.ctrlKey,metaKey:S.metaKey,shiftKey:S.shiftKey,altKey:S.altKey,key:S.key,keyCode:S.keyCode,rawEvent:S,location:oe})},[Z,H,Dt]),Mr=a.useCallback(S=>{const Y=Te.current;if(Y===null)return;let ee,oe;H.current!==void 0&&(ee=Dt(Y,H.current.cell[0],H.current.cell[1]),oe=H.current.cell),K==null||K({bounds:ee,stopPropagation:()=>S.stopPropagation(),preventDefault:()=>S.preventDefault(),cancel:()=>{},ctrlKey:S.ctrlKey,metaKey:S.metaKey,shiftKey:S.shiftKey,altKey:S.altKey,key:S.key,keyCode:S.keyCode,rawEvent:S,location:oe})},[K,H,Dt]),oi=a.useCallback(S=>{if(Te.current=S,ne!==void 0&&(ne.current=S),S===null)kt.current=window;else{const Y=S.getRootNode();Y===document&&(kt.current=window),kt.current=Y}},[ne]),ri=a.useCallback(S=>{const Y=Te.current;if(Y===null||ot===!1||ve){S.preventDefault();return}let ee,oe;const q=Lt(Y,S.clientX,S.clientY);if(ot!==!0&&q.kind!==ot){S.preventDefault();return}const ie=(Ee,ke)=>{ee=Ee,oe=ke};let He,Ae,se;const Qe=(Ee,ke,Xe)=>{He=Ee,Ae=ke,se=Xe};let re=!1;if(pe==null||pe({...q,setData:ie,setDragImage:Qe,preventDefault:()=>re=!0,defaultPrevented:()=>re}),!re&&ee!==void 0&&oe!==void 0&&S.dataTransfer!==null)if(S.dataTransfer.setData(ee,oe),S.dataTransfer.effectAllowed="copyLink",He!==void 0&&Ae!==void 0&&se!==void 0)S.dataTransfer.setDragImage(He,Ae,se);else{const[Ee,ke]=q.location;if(ke!==void 0){const Xe=document.createElement("canvas"),Ht=Dt(Y,Ee,ke);Jt(Ht!==void 0);const Kt=Math.ceil(window.devicePixelRatio??1);Xe.width=Ht.width*Kt,Xe.height=Ht.height*Kt;const je=Xe.getContext("2d");je!==null&&(je.scale(Kt,Kt),je.textBaseline="middle",ke===-1?(je.font=Me.headerFontFull,je.fillStyle=Me.bgHeader,je.fillRect(0,0,Xe.width,Xe.height),Rs(je,0,0,Ht.width,Ht.height,Rt[Ee],!1,Me,!1,void 0,void 0,!1,0,ft,Ne,!1)):(je.font=Me.baseFontFull,je.fillStyle=Me.bgCell,je.fillRect(0,0,Xe.width,Xe.height),ks(je,g([Ee,ke]),0,ke,!1,!1,0,0,Ht.width,Ht.height,!1,Me,Me.bgCell,Ct,ft,1,void 0,!1,0,void 0,void 0,void 0,vn,tt,()=>{}))),Xe.style.left="-100%",Xe.style.position="absolute",Xe.style.width=`${Ht.width}px`,Xe.style.height=`${Ht.height}px`,document.body.append(Xe),S.dataTransfer.setDragImage(Xe,Ht.width/2,Ht.height/2),window.setTimeout(()=>{Xe.remove()},0)}}else S.preventDefault()},[ot,ve,Lt,pe,Dt,Me,Rt,ft,Ne,g,Ct,vn,tt]);$t("dragstart",ri,(V==null?void 0:V.current)??null,!1,!1);const on=a.useRef(),Yn=a.useCallback(S=>{const Y=Te.current;if(fe!==void 0&&S.preventDefault(),Y===null||De===void 0)return;const ee=Lt(Y,S.clientX,S.clientY),[oe,q]=ee.location,ie=oe-(be?0:1),[He,Ae]=on.current??[];(He!==ie||Ae!==q)&&(on.current=[ie,q],De([ie,q],S.dataTransfer))},[be,Lt,De,fe]);$t("dragover",Yn,(V==null?void 0:V.current)??null,!1,!1);const rn=a.useCallback(()=>{on.current=void 0,ue==null||ue()},[ue]);$t("dragend",rn,(V==null?void 0:V.current)??null,!1,!1);const T=a.useCallback(S=>{const Y=Te.current;if(Y===null||fe===void 0)return;S.preventDefault();const ee=Lt(Y,S.clientX,S.clientY),[oe,q]=ee.location,ie=oe-(be?0:1);fe([ie,q],S.dataTransfer)},[be,Lt,fe]);$t("drop",T,(V==null?void 0:V.current)??null,!1,!1);const pt=a.useCallback(()=>{Ge==null||Ge()},[Ge]);$t("dragleave",pt,(V==null?void 0:V.current)??null,!1,!1);const _n=a.useRef(H);_n.current=H;const Mo=a.useRef(null),Ro=a.useCallback(S=>{var Y;Te.current===null||!Te.current.contains(document.activeElement)||(S===null&&_n.current.current!==void 0?(Y=ne==null?void 0:ne.current)==null||Y.focus({preventScroll:!0}):S!==null&&S.focus({preventScroll:!0}),Mo.current=S)},[ne]);a.useImperativeHandle(t,()=>({focus:()=>{var Y;const S=Mo.current;S===null||!document.contains(S)?(Y=ne==null?void 0:ne.current)==null||Y.focus({preventScroll:!0}):S.focus({preventScroll:!0})},getBounds:(S,Y)=>{if(!(ne===void 0||ne.current===null))return Dt(ne.current,S??0,Y??-1)},damage:yr}),[ne,yr,Dt]);const Vo=a.useRef(),ii=Ga(()=>{var Ae,se,Qe;if(n<50||(xe==null?void 0:xe.disableAccessibilityTree)===!0)return null;let S=Di(Rt,Je,n,Ie,_e);const Y=be?0:-1;!be&&((Ae=S[0])==null?void 0:Ae.sourceIndex)===0&&(S=S.slice(1));const[ee,oe]=((se=H.current)==null?void 0:se.cell)??[],q=(Qe=H.current)==null?void 0:Qe.range,ie=S.map(re=>re.sourceIndex),He=In(s,Math.min(w,s+r));return ee!==void 0&&oe!==void 0&&!(ie.includes(ee)&&He.includes(oe))&&Ro(null),a.createElement("table",{key:"access-tree",role:"grid","aria-rowcount":w+1,"aria-multiselectable":"true","aria-colcount":Rt.length+Y},a.createElement("thead",{role:"rowgroup"},a.createElement("tr",{role:"row","aria-rowindex":1},S.map(re=>a.createElement("th",{role:"columnheader","aria-selected":H.columns.hasIndex(re.sourceIndex),"aria-colindex":re.sourceIndex+1+Y,tabIndex:-1,onFocus:Ee=>{if(Ee.target!==Mo.current)return Fe==null?void 0:Fe([re.sourceIndex,-1])},key:re.sourceIndex},re.title)))),a.createElement("tbody",{role:"rowgroup"},He.map(re=>a.createElement("tr",{role:"row","aria-selected":H.rows.hasIndex(re),key:re,"aria-rowindex":re+2},S.map(Ee=>{const ke=Ee.sourceIndex,Xe=yn(ke,re),Ht=ee===ke&&oe===re,Kt=q!==void 0&&ke>=q.x&&ke<q.x+q.width&&re>=q.y&&re<q.y+q.height,je=`glide-cell-${ke}-${re}`,bt=[ke,re],hn=g(bt,!0);return a.createElement("td",{key:Xe,role:"gridcell","aria-colindex":ke+1+Y,"aria-selected":Kt,"aria-readonly":Bo(hn)||!lr(hn),id:je,"data-testid":je,onClick:()=>{const Gt=ne==null?void 0:ne.current;if(Gt!=null)return Z==null?void 0:Z({bounds:Dt(Gt,ke,re),cancel:()=>{},preventDefault:()=>{},stopPropagation:()=>{},ctrlKey:!1,key:"Enter",keyCode:13,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:bt})},onFocusCapture:Gt=>{var nt,Vt;if(!(Gt.target===Mo.current||((nt=Vo.current)==null?void 0:nt[0])===ke&&((Vt=Vo.current)==null?void 0:Vt[1])===re))return Vo.current=bt,Fe==null?void 0:Fe(bt)},ref:Ht?Ro:void 0,tabIndex:-1},vd(hn,tt))})))))},[n,Rt,Je,Ie,_e,w,s,r,H,Ro,g,ne,Z,Dt,Fe],200),jo=A===0||!N?0:Je>A?1:an(-_e/100,0,1),P=-s*32+ut,At=O?an(-P/100,0,1):0,Bt=a.useMemo(()=>{if(!jo&&!At)return null;const S={position:"absolute",top:0,left:Ft,width:n-Ft,height:o,opacity:jo,pointerEvents:"none",transition:We?void 0:"opacity 0.2s",boxShadow:"inset 13px 0 10px -13px rgba(0, 0, 0, 0.2)"},Y={position:"absolute",top:Ot,left:0,width:n,height:o,opacity:At,pointerEvents:"none",transition:de?void 0:"opacity 0.2s",boxShadow:"inset 0 13px 10px -13px rgba(0, 0, 0, 0.2)"};return a.createElement(a.Fragment,null,jo>0&&a.createElement("div",{id:"shadow-x",style:S}),At>0&&a.createElement("div",{id:"shadow-y",style:Y}))},[jo,At,Ft,n,We,Ot,o,de]),li=a.useMemo(()=>({position:"absolute",top:0,left:0}),[]);return a.createElement(a.Fragment,null,a.createElement("canvas",{"data-testid":"data-grid-canvas",tabIndex:0,onKeyDown:Sr,onKeyUp:Mr,onFocus:k,onBlur:z,ref:oi,style:Uo},ii),a.createElement("canvas",{ref:mt,style:li}),Bt)},kd=a.memo(a.forwardRef(xd));function ir(e,t,n,o){return an(Math.round(t-(e.growOffset??0)),Math.ceil(n),Math.floor(o))}const Sd=e=>{const[t,n]=a.useState(),[o,r]=a.useState(),[i,l]=a.useState(),[s,c]=a.useState(),[f,d]=a.useState(!1),[p,w]=a.useState(),[g,h]=a.useState(),[m,C]=a.useState(),[b,y]=a.useState(!1),[k,z]=a.useState(),{onHeaderMenuClick:L,onHeaderIndicatorClick:H,getCellContent:A,onColumnMoved:_,onColumnResize:M,onColumnResizeStart:N,onColumnResizeEnd:O,gridRef:F,maxColumnWidth:E,minColumnWidth:R,onRowMoved:ce,lockColumns:te,onColumnProposeMove:le,onMouseDown:Ie,onMouseUp:be,onItemHovered:Z,onDragStart:K,canvasRef:me}=e,ne=(M??O??N)!==void 0,{columns:pe,selection:ue}=e,V=ue.columns,ve=a.useCallback(j=>{const[Ne,Fe]=j.location;i!==void 0&&s!==Ne&&Ne>=te?(d(!0),c(Ne)):g!==void 0&&Fe!==void 0?(y(!0),C(Math.max(0,Fe))):o===void 0&&!f&&!b&&(Z==null||Z(j))},[i,g,s,Z,te,o,f,b]),Ce=_!==void 0,Ke=a.useCallback(j=>{var Ne;if(j.button===0){const[Fe,De]=j.location;if(j.kind==="out-of-bounds"&&j.isEdge&&ne){const fe=(Ne=F==null?void 0:F.current)==null?void 0:Ne.getBounds(pe.length-1,-1);fe!==void 0&&(n(fe.x),r(pe.length-1))}else if(j.kind==="header"&&Fe>=te){const fe=me==null?void 0:me.current;if(j.isEdge&&ne&&fe){n(j.bounds.x),r(Fe);const $e=fe.getBoundingClientRect().width/fe.offsetWidth,We=j.bounds.width/$e;N==null||N(pe[Fe],We,Fe,We+(pe[Fe].growOffset??0))}else j.kind==="header"&&Ce&&(w(j.bounds.x),l(Fe))}else j.kind==="cell"&&te>0&&Fe===0&&De!==void 0&&ce!==void 0&&(z(j.bounds.y),h(De))}Ie==null||Ie(j)},[Ie,ne,te,ce,F,pe,Ce,N,me]),ot=a.useCallback((j,Ne)=>{f||b||L==null||L(j,Ne)},[f,b,L]),wt=a.useCallback((j,Ne)=>{f||b||H==null||H(j,Ne)},[f,b,H]),rt=a.useRef(-1),Be=a.useCallback(()=>{rt.current=-1,h(void 0),C(void 0),z(void 0),y(!1),l(void 0),c(void 0),w(void 0),d(!1),r(void 0),n(void 0)},[]),Ve=a.useCallback((j,Ne)=>{if(j.button===0){if(o!==void 0){if((V==null?void 0:V.hasIndex(o))===!0)for(const De of V){if(De===o)continue;const fe=pe[De],Ge=ir(fe,rt.current,R,E);M==null||M(fe,Ge,De,Ge+(fe.growOffset??0))}const Fe=ir(pe[o],rt.current,R,E);if(O==null||O(pe[o],Fe,o,Fe+(pe[o].growOffset??0)),V.hasIndex(o))for(const De of V){if(De===o)continue;const fe=pe[De],Ge=ir(fe,rt.current,R,E);O==null||O(fe,Ge,De,Ge+(fe.growOffset??0))}}Be(),i!==void 0&&s!==void 0&&(_==null||_(i,s)),g!==void 0&&m!==void 0&&(ce==null||ce(g,m))}be==null||be(j,Ne)},[be,o,i,s,g,m,V,O,pe,R,E,M,_,ce,Be]),Me=a.useMemo(()=>{if(!(i===void 0||s===void 0)&&i!==s&&(le==null?void 0:le(i,s))!==!1)return{src:i,dest:s}},[i,s,le]),yt=a.useCallback(j=>{const Ne=me==null?void 0:me.current;if(i!==void 0&&p!==void 0)Math.abs(j.clientX-p)>20&&d(!0);else if(g!==void 0&&k!==void 0)Math.abs(j.clientY-k)>20&&y(!0);else if(o!==void 0&&t!==void 0&&Ne){const De=Ne.getBoundingClientRect().width/Ne.offsetWidth,fe=(j.clientX-t)/De,Ge=pe[o],$e=ir(Ge,fe,R,E);if(M==null||M(Ge,$e,o,$e+(Ge.growOffset??0)),rt.current=fe,(V==null?void 0:V.first())===o)for(const We of V){if(We===o)continue;const de=pe[We],xe=ir(de,rt.current,R,E);M==null||M(de,xe,We,xe+(de.growOffset??0))}}},[i,p,g,k,o,t,pe,R,E,M,V,me]),dt=a.useCallback((j,Ne)=>{if(g===void 0||m===void 0)return A(j,Ne);let[Fe,De]=j;return De===m?De=g:(De>m&&(De-=1),De>=g&&(De+=1)),A([Fe,De],Ne)},[g,m,A]),Ze=a.useCallback(j=>{K==null||K(j),j.defaultPrevented()||Be()},[Be,K]);return a.createElement(kd,{accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,enableGroups:e.enableGroups,eventTargetRef:e.eventTargetRef,experimental:e.experimental,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,headerIcons:e.headerIcons,height:e.height,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,resizeColumn:o,isDraggable:e.isDraggable,isFilling:e.isFilling,isFocused:e.isFocused,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDrop:e.onDrop,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,resizeIndicator:e.resizeIndicator,verticalBorder:e.verticalBorder,width:e.width,getCellContent:dt,isResizing:o!==void 0,onHeaderMenuClick:ot,onHeaderIndicatorClick:wt,isDragging:f,onItemHovered:ve,onDragStart:Ze,onMouseDown:Ke,allowResize:ne,onMouseUp:Ve,dragAndDropState:Me,onMouseMoveRaw:yt,ref:F})},Md=Sd;function Rd(e){const t=a.useRef(null),[n,o]=a.useState({width:e==null?void 0:e[0],height:e==null?void 0:e[1]});return a.useLayoutEffect(()=>{const r=l=>{for(const s of l){const{width:c,height:f}=s&&s.contentRect||{};o(d=>d.width===c&&d.height===f?d:{width:c,height:f})}},i=new window.ResizeObserver(r);return t.current&&i.observe(t.current,void 0),()=>{i.disconnect()}},[t.current]),{ref:t,...n}}const Ed=(e,t,n)=>{const o=a.useRef(null),r=a.useRef(null),i=a.useRef(null),l=a.useRef(0),s=a.useRef(t);s.current=t;const c=n.current;a.useEffect(()=>{const f=()=>{var w,g;if(r.current===!1&&c!==null){const h=[c.scrollLeft,c.scrollTop];if(((w=i.current)==null?void 0:w[0])===h[0]&&((g=i.current)==null?void 0:g[1])===h[1])if(l.current>10){i.current=null,r.current=null;return}else l.current++;else l.current=0,s.current(h[0],h[1]),i.current=h;o.current=window.setTimeout(f,8.333333333333334)}},d=()=>{r.current=!0,i.current=null,o.current!==null&&(window.clearTimeout(o.current),o.current=null)},p=w=>{w.touches.length===0&&(r.current=!1,l.current=0,o.current=window.setTimeout(f,8.333333333333334))};if(e&&c!==null){const w=c;return w.addEventListener("touchstart",d),w.addEventListener("touchend",p),()=>{w.removeEventListener("touchstart",d),w.removeEventListener("touchend",p),o.current!==null&&window.clearTimeout(o.current)}}},[e,c])},Id=Ed,Fd=()=>e=>e.isSafari?"scroll":"auto",Dd=Wt("div")({name:"ScrollRegionStyle",class:"gdg-s1dgczr6",propsAsIs:!1,vars:{"s1dgczr6-0":[Fd()]}});function Hd(e){const[t,n]=a.useState(!1),o=typeof window>"u"?null:window,r=a.useRef(0);return $t("touchstart",a.useCallback(()=>{window.clearTimeout(r.current),n(!0)},[]),o,!0,!1),$t("touchend",a.useCallback(i=>{i.touches.length===0&&(r.current=window.setTimeout(()=>n(!1),e))},[e]),o,!0,!1),t}const Td=e=>{var ne,pe;const{children:t,clientHeight:n,scrollHeight:o,scrollWidth:r,update:i,draggable:l,className:s,preventDiagonalScrolling:c=!1,paddingBottom:f=0,paddingRight:d=0,rightElement:p,rightElementProps:w,kineticScrollPerfHack:g=!1,scrollRef:h,initialSize:m}=e,C=[],b=(w==null?void 0:w.sticky)??!1,y=(w==null?void 0:w.fill)??!1,k=a.useRef(0),z=a.useRef(0),L=a.useRef(null),H=typeof window>"u"?1:window.devicePixelRatio,A=a.useRef({scrollLeft:0,scrollTop:0,lockDirection:void 0}),_=a.useRef(null),M=Hd(200),[N,O]=a.useState(!0),F=a.useRef(0);a.useLayoutEffect(()=>{if(!N||M||A.current.lockDirection===void 0)return;const ue=L.current;if(ue===null)return;const[V,ve]=A.current.lockDirection;V!==void 0?ue.scrollLeft=V:ve!==void 0&&(ue.scrollTop=ve),A.current.lockDirection=void 0},[M,N]);const E=a.useCallback((ue,V)=>{var Ze;const ve=L.current;if(ve===null)return;V=V??ve.scrollTop,ue=ue??ve.scrollLeft;const Ce=A.current.scrollTop,Ke=A.current.scrollLeft,ot=ue-Ke,wt=V-Ce;M&&ot!==0&&wt!==0&&(Math.abs(ot)>3||Math.abs(wt)>3)&&c&&A.current.lockDirection===void 0&&(A.current.lockDirection=Math.abs(ot)<Math.abs(wt)?[Ke,void 0]:[void 0,Ce]);const rt=A.current.lockDirection;ue=(rt==null?void 0:rt[0])??ue,V=(rt==null?void 0:rt[1])??V,A.current.scrollLeft=ue,A.current.scrollTop=V;const Be=ve.clientWidth,Ve=ve.clientHeight,Me=V,yt=z.current-Me,dt=ve.scrollHeight-Ve;if(z.current=Me,dt>0&&(Math.abs(yt)>2e3||Me===0||Me===dt)&&o>ve.scrollHeight+5){const j=Me/dt,Ne=(o-Ve)*j;k.current=Ne-Me}rt!==void 0&&(window.clearTimeout(F.current),O(!1),F.current=window.setTimeout(()=>O(!0),200)),i({x:ue,y:Me+k.current,width:Be-d,height:Ve-f,paddingRight:((Ze=_.current)==null?void 0:Ze.clientWidth)??0})},[f,d,o,i,c,M]);Id(g&&Vr.value,E,L);const R=a.useRef(E);R.current=E;const ce=a.useRef(),te=a.useRef(!1);a.useLayoutEffect(()=>{te.current?E():te.current=!0},[E,f,d]);const le=a.useCallback(ue=>{L.current=ue,h!==void 0&&(h.current=ue)},[h]);let Ie=0,be=0;for(C.push(a.createElement("div",{key:Ie++,style:{width:r,height:0}}));be<o;){const ue=Math.min(5e6,o-be);C.push(a.createElement("div",{key:Ie++,style:{width:0,height:ue}})),be+=ue}const{ref:Z,width:K,height:me}=Rd(m);return typeof window<"u"&&(((ne=ce.current)==null?void 0:ne.height)!==me||((pe=ce.current)==null?void 0:pe.width)!==K)&&(window.setTimeout(()=>R.current(),0),ce.current={width:K,height:me}),(K??0)===0||(me??0)===0?a.createElement("div",{ref:Z}):a.createElement("div",{ref:Z},a.createElement(Dd,{isSafari:Vr.value},a.createElement("div",{className:"dvn-underlay"},t),a.createElement("div",{ref:le,style:ce.current,draggable:l,onDragStart:ue=>{l||(ue.stopPropagation(),ue.preventDefault())},className:"dvn-scroller "+(s??""),onScroll:()=>E()},a.createElement("div",{className:"dvn-scroll-inner"+(p===void 0?" dvn-hidden":"")},a.createElement("div",{className:"dvn-stack"},C),p!==void 0&&a.createElement(a.Fragment,null,!y&&a.createElement("div",{className:"dvn-spacer"}),a.createElement("div",{ref:_,style:{height:me,maxHeight:n-Math.ceil(H%1),position:"sticky",top:0,paddingLeft:1,marginBottom:-40,marginRight:d,flexGrow:y?1:void 0,right:b?d??0:void 0,pointerEvents:"auto"}},p))))))},Ad=e=>{const{columns:t,rows:n,rowHeight:o,headerHeight:r,groupHeaderHeight:i,enableGroups:l,freezeColumns:s,experimental:c,nonGrowWidth:f,clientSize:d,className:p,onVisibleRegionChanged:w,scrollRef:g,preventDiagonalScrolling:h,rightElement:m,rightElementProps:C,overscrollX:b,overscrollY:y,initialSize:k,smoothScrollX:z=!1,smoothScrollY:L=!1,isDraggable:H}=e,{paddingRight:A,paddingBottom:_}=c??{},[M,N]=d,O=a.useRef(),F=a.useRef(),E=a.useRef(),R=a.useRef(),ce=f+Math.max(0,b??0);let te=l?r+i:r;if(typeof o=="number")te+=n*o;else for(let Z=0;Z<n;Z++)te+=o(Z);y!==void 0&&(te+=y);const le=a.useRef(),Ie=a.useCallback(()=>{var wt,rt;if(le.current===void 0)return;const Z={...le.current};let K=0,me=Z.x<0?-Z.x:0,ne=0,pe=0;Z.x=Z.x<0?0:Z.x;let ue=0;for(let Be=0;Be<s;Be++)ue+=t[Be].width;for(const Be of t){const Ve=K-ue;if(Z.x>=Ve+Be.width)K+=Be.width,pe++,ne++;else if(Z.x>Ve)K+=Be.width,z?me+=Ve-Z.x:pe++,ne++;else if(Z.x+Z.width>Ve)K+=Be.width,ne++;else break}let V=0,ve=0,Ce=0;if(typeof o=="number")L?(ve=Math.floor(Z.y/o),V=ve*o-Z.y):ve=Math.ceil(Z.y/o),Ce=Math.ceil(Z.height/o)+ve,V<0&&Ce++;else{let Be=0;for(let Ve=0;Ve<n;Ve++){const Me=o(Ve),yt=Be+(L?0:Me/2);if(Z.y>=Be+Me)Be+=Me,ve++,Ce++;else if(Z.y>yt)Be+=Me,L?V+=yt-Z.y:ve++,Ce++;else if(Z.y+Z.height>Me/2+Be)Be+=Me,Ce++;else break}}const Ke={x:pe,y:ve,width:ne-pe,height:Ce-ve},ot=O.current;(ot===void 0||ot.y!==Ke.y||ot.x!==Ke.x||ot.height!==Ke.height||ot.width!==Ke.width||F.current!==me||E.current!==V||Z.width!==((wt=R.current)==null?void 0:wt[0])||Z.height!==((rt=R.current)==null?void 0:rt[1]))&&(w==null||w({x:pe,y:ve,width:ne-pe,height:Ce-ve},Z.width,Z.height,Z.paddingRight??0,me,V),O.current=Ke,F.current=me,E.current=V,R.current=[Z.width,Z.height])},[t,o,n,w,s,z,L]),be=a.useCallback(Z=>{le.current=Z,Ie()},[Ie]);return a.useEffect(()=>{Ie()},[Ie]),a.createElement(Td,{scrollRef:g,className:p,kineticScrollPerfHack:c==null?void 0:c.kineticScrollPerfHack,preventDiagonalScrolling:h,draggable:H===!0||typeof H=="string",scrollWidth:ce+(A??0),scrollHeight:te+(_??0),clientHeight:N,rightElement:m,paddingBottom:_,paddingRight:A,rightElementProps:C,update:be,initialSize:k},a.createElement(Md,{eventTargetRef:g,width:M,height:N,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,onColumnProposeMove:e.onColumnProposeMove,verticalBorder:e.verticalBorder,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}))},Bd=Ad,zd=Wt("div")({name:"SearchWrapper",class:"gdg-seveqep",propsAsIs:!1}),Ld=a.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},a.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),Pd=a.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},a.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),$d=a.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},a.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),Wd=10,Od=e=>{const{canvasRef:t,cellYOffset:n,rows:o,columns:r,searchInputRef:i,searchValue:l,searchResults:s,onSearchValueChange:c,getCellsForSelection:f,onSearchResultsChanged:d,showSearch:p=!1,onSearchClose:w}=e,[g]=a.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[h,m]=a.useState(""),C=l??h,b=a.useCallback(K=>{m(K),c==null||c(K)},[c]),[y,k]=a.useState(),z=a.useRef(y);z.current=y,a.useEffect(()=>{s!==void 0&&(s.length>0?k(K=>({rowsSearched:o,results:s.length,selectedIndex:(K==null?void 0:K.selectedIndex)??-1})):k(void 0))},[o,s]);const L=a.useRef();L.current===void 0&&(L.current=new AbortController);const H=a.useRef(),[A,_]=a.useState([]),M=s??A,N=a.useCallback(()=>{H.current!==void 0&&(window.cancelAnimationFrame(H.current),H.current=void 0,L.current.abort())},[]),O=a.useRef(n);O.current=n;const F=a.useCallback(K=>{const me=new RegExp(K.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let ne=O.current,pe=Math.min(10,o),ue=0;k(void 0),_([]);const V=[],ve=async()=>{var dt;if(f===void 0)return;const Ce=performance.now(),Ke=o-ue;let ot=f({x:0,y:ne,width:r.length,height:Math.min(pe,Ke,o-ne)},L.current.signal);typeof ot=="function"&&(ot=await ot());let wt=!1;for(const[Ze,j]of ot.entries())for(const[Ne,Fe]of j.entries()){let De;switch(Fe.kind){case U.Text:case U.Number:De=Fe.displayData;break;case U.Uri:case U.Markdown:De=Fe.data;break;case U.Boolean:De=typeof Fe.data=="boolean"?Fe.data.toString():void 0;break;case U.Image:case U.Bubble:De=Fe.data.join("🐳");break;case U.Custom:De=Fe.copyData;break}De!==void 0&&me.test(De)&&(V.push([Ne,Ze+ne]),wt=!0)}const rt=performance.now();wt&&_([...V]),ue+=ot.length,Jt(ue<=o);const Be=((dt=z.current)==null?void 0:dt.selectedIndex)??-1;k({results:V.length,rowsSearched:ue,selectedIndex:Be}),d==null||d(V,Be),ne+pe>=o?ne=0:ne+=pe;const Ve=rt-Ce,Me=Math.max(Ve,1),yt=Wd/Me;pe=Math.ceil(pe*yt),ue<o&&V.length<1e3&&(H.current=window.requestAnimationFrame(ve))};N(),H.current=window.requestAnimationFrame(ve)},[N,r.length,f,d,o]),E=a.useCallback(()=>{var K;w==null||w(),k(void 0),_([]),d==null||d([],-1),N(),(K=t==null?void 0:t.current)==null||K.focus()},[N,t,w,d]),R=a.useCallback(K=>{b(K.target.value),s===void 0&&(K.target.value===""?(k(void 0),_([]),N()):F(K.target.value))},[F,N,b,s]);a.useEffect(()=>{p&&i.current!==null&&(b(""),i.current.focus({preventScroll:!0}))},[p,i,b]);const ce=a.useCallback(K=>{var ne;if((ne=K==null?void 0:K.stopPropagation)==null||ne.call(K),y===void 0)return;const me=(y.selectedIndex+1)%y.results;k({...y,selectedIndex:me}),d==null||d(M,me)},[y,d,M]),te=a.useCallback(K=>{var ne;if((ne=K==null?void 0:K.stopPropagation)==null||ne.call(K),y===void 0)return;let me=(y.selectedIndex-1)%y.results;me<0&&(me+=y.results),k({...y,selectedIndex:me}),d==null||d(M,me)},[d,M,y]),le=a.useCallback(K=>{(K.ctrlKey||K.metaKey)&&K.nativeEvent.code==="KeyF"||K.key==="Escape"?(E(),K.stopPropagation(),K.preventDefault()):K.key==="Enter"&&(K.shiftKey?te():ce())},[E,ce,te]);a.useEffect(()=>()=>{N()},[N]);const[Ie,be]=a.useState(!1);a.useEffect(()=>{if(p)be(!0);else{const K=setTimeout(()=>be(!1),150);return()=>clearTimeout(K)}},[p]);const Z=a.useMemo(()=>{if(!p&&!Ie)return null;let K;y!==void 0&&(K=y.results>=1e3?"over 1000":`${y.results} result${y.results!==1?"s":""}`,y.selectedIndex>=0&&(K=`${y.selectedIndex+1} of ${K}`));const me=ue=>{ue.stopPropagation()},pe={width:`${Math.floor(((y==null?void 0:y.rowsSearched)??0)/o*100)}%`};return a.createElement(zd,{className:p?"":"out",onMouseDown:me,onMouseMove:me,onMouseUp:me,onClick:me},a.createElement("div",{className:"gdg-search-bar-inner"},a.createElement("input",{id:g,"aria-hidden":!p,"data-testid":"search-input",ref:i,onChange:R,value:C,tabIndex:p?void 0:-1,onKeyDownCapture:le}),a.createElement("button",{"aria-label":"Previous Result","aria-hidden":!p,tabIndex:p?void 0:-1,onClick:te,disabled:((y==null?void 0:y.results)??0)===0},Ld),a.createElement("button",{"aria-label":"Next Result","aria-hidden":!p,tabIndex:p?void 0:-1,onClick:ce,disabled:((y==null?void 0:y.results)??0)===0},Pd),w!==void 0&&a.createElement("button",{"aria-label":"Close Search","aria-hidden":!p,"data-testid":"search-close-button",tabIndex:p?void 0:-1,onClick:E},$d)),y!==void 0?a.createElement(a.Fragment,null,a.createElement("div",{className:"gdg-search-status"},a.createElement("div",{"data-testid":"search-result-area"},K)),a.createElement("div",{className:"gdg-search-progress",style:pe})):a.createElement("div",{className:"gdg-search-status"},a.createElement("label",{htmlFor:g},"Type to search")))},[p,Ie,y,o,g,i,R,C,le,te,ce,w,E]);return a.createElement(a.Fragment,null,a.createElement(Bd,{prelightCells:M,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,className:e.className,clientSize:e.clientSize,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,nonGrowWidth:e.nonGrowWidth,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,initialSize:e.initialSize,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,onVisibleRegionChanged:e.onVisibleRegionChanged,overscrollX:e.overscrollX,overscrollY:e.overscrollY,preventDiagonalScrolling:e.preventDiagonalScrolling,rightElement:e.rightElement,rightElementProps:e.rightElementProps,rowHeight:e.rowHeight,rows:e.rows,scrollRef:e.scrollRef,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,verticalBorder:e.verticalBorder,onColumnProposeMove:e.onColumnProposeMove,drawFocusRing:e.drawFocusRing,drawCell:e.drawCell,drawHeader:e.drawHeader,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}),Z)},Nd=Od;class Xd extends a.PureComponent{constructor(){super(...arguments);Oe(this,"wrapperRef",a.createRef());Oe(this,"clickOutside",n=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(n))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(n.target)){let o=n.target;for(;o!==null;){if(o.classList.contains("click-outside-ignore"))return;o=o.parentElement}this.props.onClickOutside()}})}componentDidMount(){document.addEventListener("touchend",this.clickOutside,!0),document.addEventListener("mousedown",this.clickOutside,!0),document.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){document.removeEventListener("touchend",this.clickOutside,!0),document.removeEventListener("mousedown",this.clickOutside,!0),document.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:n,isOutsideClick:o,...r}=this.props;return a.createElement("div",{...r,ref:this.wrapperRef},this.props.children)}}const Gd=()=>e=>Math.max(16,e.targetHeight-10),Ud=Wt("input")({name:"RenameInput",class:"gdg-r17m35ur",propsAsIs:!1,vars:{"r17m35ur-0":[Gd(),"px"]}}),Yd=e=>{const{bounds:t,group:n,onClose:o,canvasBounds:r,onFinish:i}=e,[l,s]=lt.useState(n);return lt.createElement(Xd,{style:{position:"absolute",left:t.x-r.left+1,top:t.y-r.top,width:t.width-2,height:t.height},className:"gdg-c1tqibwd",onClickOutside:o},lt.createElement(Ud,{targetHeight:t.height,"data-testid":"group-rename-input",value:l,onBlur:o,onFocus:c=>c.target.setSelectionRange(0,l.length),onChange:c=>s(c.target.value),onKeyDown:c=>{c.key==="Enter"?i(l):c.key==="Escape"&&o()},autoFocus:!0}))};function _d(e,t){return e===void 0?!1:e.length>1&&e.startsWith("_")?Number.parseInt(e.slice(1))===t.keyCode:e.length===1&&e>="a"&&e<="z"?e.toUpperCase().codePointAt(0)===t.keyCode:e===t.key}function Le(e,t,n){const o=Fs(e,t);return o&&(n.didMatch=!0),o}function Fs(e,t){if(e.length===0)return!1;if(e.includes("|")){const c=e.split("|");for(const f of c)if(Fs(f,t))return!0;return!1}let n=!1,o=!1,r=!1,i=!1;const l=e.split("+"),s=l.pop();if(!_d(s,t))return!1;if(l[0]==="any")return!0;for(const c of l)switch(c){case"ctrl":n=!0;break;case"shift":o=!0;break;case"alt":r=!0;break;case"meta":i=!0;break;case"primary":jr.value?i=!0:n=!0;break}return t.altKey===r&&t.ctrlKey===n&&t.shiftKey===o&&t.metaKey===i}function Kd(e,t,n,o,r,i,l){const s=lt.useCallback((d,p,w,g)=>{var k;(i==="cell"||i==="multi-cell")&&d!==void 0&&(d={...d,range:{x:d.cell[0],y:d.cell[1],width:1,height:1}}),!l&&d!==void 0&&d.range.width>1&&(d={...d,range:{...d.range,width:1,x:d.cell[0]}});const h=n==="mixed"&&(w||g==="drag"),m=o==="mixed"&&h,C=r==="mixed"&&h;let b={current:d===void 0?void 0:{...d,rangeStack:g==="drag"?((k=e.current)==null?void 0:k.rangeStack)??[]:[]},columns:m?e.columns:it.empty(),rows:C?e.rows:it.empty()};w&&(i==="multi-rect"||i==="multi-cell")&&b.current!==void 0&&e.current!==void 0&&(b={...b,current:{...b.current,rangeStack:[...e.current.rangeStack,e.current.range]}}),t(b,p)},[o,e,n,i,l,r,t]),c=lt.useCallback((d,p,w)=>{d=d??e.rows,p!==void 0&&(d=d.add(p));let g;if(r==="exclusive"&&d.length>0)g={current:void 0,columns:it.empty(),rows:d};else{const h=w&&n==="mixed",m=w&&o==="mixed";g={current:h?e.current:void 0,columns:m?e.columns:it.empty(),rows:d}}t(g,!1)},[o,e,n,r,t]),f=lt.useCallback((d,p,w)=>{d=d??e.columns,p!==void 0&&(d=d.add(p));let g;if(o==="exclusive"&&d.length>0)g={current:void 0,rows:it.empty(),columns:d};else{const h=w&&n==="mixed",m=w&&r==="mixed";g={current:h?e.current:void 0,rows:m?e.rows:it.empty(),columns:d}}t(g,!1)},[o,e,n,r,t]);return[s,c,f]}function Vd(e,t,n,o,r){const i=a.useCallback(f=>{if(e===!0){const d=[];for(let p=f.y;p<f.y+f.height;p++){const w=[];for(let g=f.x;g<f.x+f.width;g++)g<0||p>=r?w.push({kind:U.Loading,allowOverlay:!1}):w.push(t([g,p]));d.push(w)}return d}return(e==null?void 0:e(f,o.signal))??[]},[o.signal,t,e,r]),l=e!==void 0?i:void 0,s=a.useCallback(f=>{if(l===void 0)return[];const d={...f,x:f.x-n};if(d.x<0){d.x=0,d.width--;const p=l(d,o.signal);return typeof p=="function"?async()=>(await p()).map(w=>[{kind:U.Loading,allowOverlay:!1},...w]):p.map(w=>[{kind:U.Loading,allowOverlay:!1},...w])}return l(d,o.signal)},[o.signal,l,n]);return[e!==void 0?s:void 0,l]}function jd(e){if(e.copyData!==void 0)return{formatted:e.copyData,rawValue:e.copyData,format:"string"};switch(e.kind){case U.Boolean:return{formatted:e.data===!0?"TRUE":e.data===!1?"FALSE":e.data===Bi?"INDETERMINATE":"",rawValue:e.data,format:"boolean"};case U.Custom:return{formatted:e.copyData,rawValue:e.copyData,format:"string"};case U.Image:case U.Bubble:return{formatted:e.data,rawValue:e.data,format:"string-array"};case U.Drilldown:return{formatted:e.data.map(t=>t.text),rawValue:e.data.map(t=>t.text),format:"string-array"};case U.Text:return{formatted:e.displayData??e.data,rawValue:e.data,format:"string"};case U.Uri:return{formatted:e.displayData??e.data,rawValue:e.data,format:"url"};case U.Markdown:case U.RowID:return{formatted:e.data,rawValue:e.data,format:"string"};case U.Number:return{formatted:e.displayData,rawValue:e.data,format:"number"};case U.Loading:return{formatted:"#LOADING",rawValue:"",format:"string"};case U.Protected:return{formatted:"************",rawValue:"",format:"string"};default:ur()}}function qd(e,t){return e.map((o,r)=>{const i=t[r];return o.map(l=>l.span!==void 0&&l.span[0]!==i?{formatted:"",rawValue:"",format:"string"}:jd(l))})}function Ml(e,t){return(t?/[\t\n",]/:/[\t\n"]/).test(e)&&(e=`"${e.replace(/"/g,'""')}"`),e}function Zd(e){var n;const t=[];for(const o of e){const r=[];for(const i of o)i.format==="url"?r.push(((n=i.rawValue)==null?void 0:n.toString())??""):i.format==="string-array"?r.push(i.formatted.map(l=>Ml(l,!0)).join(",")):r.push(Ml(i.formatted,!1));t.push(r.join("	"))}return t.join(`
`)}function xi(e){return e.replace(/\t/g,"    ").replace(/ {2,}/g,t=>"<span> </span>".repeat(t.length))}function Rl(e){return'"'+e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"'}function Jd(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function Qd(e){var n;const t=[];t.push('<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>',"<table><tbody>");for(const o of e){t.push("<tr>");for(const r of o){const i=`gdg-format="${r.format}"`;r.format==="url"?t.push(`<td ${i}><a href="${r.rawValue}">${xi(r.formatted)}</a></td>`):r.format==="string-array"?t.push(`<td ${i}><ol>${r.formatted.map((l,s)=>`<li gdg-raw-value=${Rl(r.rawValue[s])}>`+xi(l)+"</li>").join("")}</ol></td>`):t.push(`<td gdg-raw-value=${Rl(((n=r.rawValue)==null?void 0:n.toString())??"")} ${i}>${xi(r.formatted)}</td>`)}t.push("</tr>")}return t.push("</tbody></table>"),t.join("")}function eu(e,t){const n=qd(e,t),o=Zd(n),r=Qd(n);return{textPlain:o,textHtml:r}}function El(e){var l;const t=document.createElement("html");t.innerHTML=e.replace(/&nbsp;/g," ");const n=t.querySelector("table");if(n===null)return;const o=[n],r=[];let i;for(;o.length>0;){const s=o.pop();if(s===void 0)break;if(s instanceof HTMLTableElement||s.nodeName==="TBODY")o.push(...[...s.children].reverse());else if(s instanceof HTMLTableRowElement)i!==void 0&&r.push(i),i=[],o.push(...[...s.children].reverse());else if(s instanceof HTMLTableCellElement){const c=s.cloneNode(!0),d=c.children.length===1&&c.children[0].nodeName==="P"?c.children[0]:null,p=(d==null?void 0:d.children.length)===1&&d.children[0].nodeName==="FONT",w=c.querySelectorAll("br");for(const m of w)m.replaceWith(`
`);const g=c.getAttribute("gdg-raw-value"),h=c.getAttribute("gdg-format")??"string";if(c.querySelector("a")!==null)i==null||i.push({rawValue:((l=c.querySelector("a"))==null?void 0:l.getAttribute("href"))??"",formatted:c.textContent??"",format:h});else if(c.querySelector("ol")!==null){const m=c.querySelectorAll("li");i==null||i.push({rawValue:[...m].map(C=>C.getAttribute("gdg-raw-value")??""),formatted:[...m].map(C=>C.textContent??""),format:"string-array"})}else if(g!==null)i==null||i.push({rawValue:Jd(g),formatted:c.textContent??"",format:h});else{let m=c.textContent??"";p&&(m=m.replace(/\n(?!\n)/g,"")),i==null||i.push({rawValue:m??"",formatted:m??"",format:h})}}}return i!==void 0&&r.push(i),r}function tu(e,t,n,o,r){var s;const i=e;if(o==="allowPartial"||e.current===void 0||t===void 0)return e;let l=!1;do{if((e==null?void 0:e.current)===void 0)break;const c=(s=e.current)==null?void 0:s.range,f=[];if(c.width>2){const w=t({x:c.x,y:c.y,width:1,height:c.height},r.signal);if(typeof w=="function")return i;f.push(...w);const g=t({x:c.x+c.width-1,y:c.y,width:1,height:c.height},r.signal);if(typeof g=="function")return i;f.push(...g)}else{const w=t({x:c.x,y:c.y,width:c.width,height:c.height},r.signal);if(typeof w=="function")return i;f.push(...w)}let d=c.x-n,p=c.x+c.width-1-n;for(const w of f)for(const g of w)g.span!==void 0&&(d=Math.min(g.span[0],d),p=Math.max(g.span[1],p));d===c.x-n&&p===c.x+c.width-1-n?l=!0:e={current:{cell:e.current.cell??[0,0],range:{x:d+n,y:c.y,width:p-d+1,height:c.height},rangeStack:e.current.rangeStack},columns:e.columns,rows:e.rows}}while(!l);return e}function Il(e){return e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1).replace(/""/g,'"')),e}function nu(e){let t;(function(s){s[s.None=0]="None",s[s.inString=1]="inString",s[s.inStringPostQuote=2]="inStringPostQuote"})(t||(t={}));const n=[];let o=[],r=0,i=t.None;e=e.replace(/\r\n/g,`
`);let l=0;for(const s of e){switch(i){case t.None:s==="	"||s===`
`?(o.push(e.slice(r,l)),r=l+1,s===`
`&&(n.push(o),o=[])):s==='"'&&(i=t.inString);break;case t.inString:s==='"'&&(i=t.inStringPostQuote);break;case t.inStringPostQuote:s==='"'?i=t.inString:((s==="	"||s===`
`)&&(o.push(Il(e.slice(r,l))),r=l+1,s===`
`&&(n.push(o),o=[])),i=t.None);break}l++}return r<e.length&&o.push(Il(e.slice(r,e.length))),n.push(o),n.map(s=>s.map(c=>({rawValue:c,formatted:c,format:"string"})))}function Fl(e,t,n){var s;const o=eu(e,t),r=c=>{var f;(f=window.navigator.clipboard)==null||f.writeText(c)},i=(c,f)=>{var d;return((d=window.navigator.clipboard)==null?void 0:d.write)===void 0?!1:(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([c],{type:"text/plain"}),"text/html":new Blob([f],{type:"text/html"})})]),!0)},l=(c,f)=>{var d,p;try{if(n===void 0||n.clipboardData===null)throw new Error("No clipboard data");(d=n==null?void 0:n.clipboardData)==null||d.setData("text/plain",c),(p=n==null?void 0:n.clipboardData)==null||p.setData("text/html",f)}catch{i(c,f)||r(c)}};((s=window.navigator.clipboard)==null?void 0:s.write)!==void 0||(n==null?void 0:n.clipboardData)!==void 0?l(o.textPlain,o.textHtml):r(o.textPlain),n==null||n.preventDefault()}function Ds(e){return e!==!0}function Dl(e){return typeof e=="string"?e:`${e}px`}const ou=()=>e=>e.innerWidth,ru=()=>e=>e.innerHeight,iu=Wt("div")({name:"Wrapper",class:"gdg-wmyidgi",propsAsIs:!1,vars:{"wmyidgi-0":[ou()],"wmyidgi-1":[ru()]}}),lu=e=>{const{inWidth:t,inHeight:n,children:o,...r}=e;return a.createElement(iu,{innerHeight:Dl(n),innerWidth:Dl(t),...r},o)},su=2,au=1300;function cu(e,t,n){const o=lt.useRef(0),[r,i]=e??[0,0];lt.useEffect(()=>{if(r===0&&i===0){o.current=0;return}let l=!1,s=0;const c=f=>{var d;if(!l){if(s===0)s=f;else{const p=f-s;o.current=Math.min(1,o.current+p/au);const w=o.current**1.618*p*su;(d=t.current)==null||d.scrollBy(r*w,i*w),s=f,n==null||n()}window.requestAnimationFrame(c)}};return window.requestAnimationFrame(c),()=>{l=!0}},[t,r,i,n])}function du({rowHeight:e,headerHeight:t,groupHeaderHeight:n,theme:o,overscrollX:r,overscrollY:i,scaleToRem:l,remSize:s}){const[c,f,d,p,w,g]=lt.useMemo(()=>{if(!l||s===16)return[e,t,n,o,r,i];const h=s/16,m=e,C=ps();return[typeof m=="number"?m*h:b=>Math.ceil(m(b)*h),Math.ceil(t*h),Math.ceil(n*h),{...o,headerIconSize:((o==null?void 0:o.headerIconSize)??C.headerIconSize)*h,cellHorizontalPadding:((o==null?void 0:o.cellHorizontalPadding)??C.cellHorizontalPadding)*h,cellVerticalPadding:((o==null?void 0:o.cellVerticalPadding)??C.cellVerticalPadding)*h},Math.ceil((r??0)*h),Math.ceil((i??0)*h)]},[n,t,r,i,s,e,l,o]);return{rowHeight:c,headerHeight:f,groupHeaderHeight:d,theme:p,overscrollX:w,overscrollY:g}}const Jn={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function Pe(e,t){return e===!0?t:e===!1?"":e}function Hl(e){const t=jr.value;return{activateCell:Pe(e.activateCell," |Enter|shift+Enter"),clear:Pe(e.clear,"any+Escape"),closeOverlay:Pe(e.closeOverlay,"any+Escape"),acceptOverlayDown:Pe(e.acceptOverlayDown,"Enter"),acceptOverlayUp:Pe(e.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:Pe(e.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:Pe(e.acceptOverlayRight,"Tab"),copy:e.copy,cut:e.cut,delete:Pe(e.delete,t?"Backspace|Delete":"Delete"),downFill:Pe(e.downFill,"primary+_68"),scrollToSelectedCell:Pe(e.scrollToSelectedCell,"primary+Enter"),goDownCell:Pe(e.goDownCell,"ArrowDown"),goDownCellRetainSelection:Pe(e.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:Pe(e.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:Pe(e.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:Pe(e.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:Pe(e.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:Pe(e.goUpCell,"ArrowUp"),goUpCellRetainSelection:Pe(e.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:Pe(e.goToFirstCell,"primary+Home"),goToFirstColumn:Pe(e.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:Pe(e.goToFirstRow,"primary+ArrowUp"),goToLastCell:Pe(e.goToLastCell,"primary+End"),goToLastColumn:Pe(e.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:Pe(e.goToLastRow,"primary+ArrowDown"),goToNextPage:Pe(e.goToNextPage,"PageDown"),goToPreviousPage:Pe(e.goToPreviousPage,"PageUp"),paste:e.paste,rightFill:Pe(e.rightFill,"primary+_82"),search:Pe(e.search,"primary+f"),selectAll:Pe(e.selectAll,"primary+a"),selectColumn:Pe(e.selectColumn,"ctrl+ "),selectGrowDown:Pe(e.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:Pe(e.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:Pe(e.selectGrowRight,"shift+ArrowRight"),selectGrowUp:Pe(e.selectGrowUp,"shift+ArrowUp"),selectRow:Pe(e.selectRow,"shift+ "),selectToFirstCell:Pe(e.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:Pe(e.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:Pe(e.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:Pe(e.selectToLastCell,"primary+shift+End"),selectToLastColumn:Pe(e.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:Pe(e.selectToLastRow,"primary+shift+ArrowDown")}}function uu(e){const t=Va(e);return lt.useMemo(()=>{if(t===void 0)return Hl(Jn);const n={...t,goToNextPage:(t==null?void 0:t.goToNextPage)??(t==null?void 0:t.pageDown)??Jn.goToNextPage,goToPreviousPage:(t==null?void 0:t.goToPreviousPage)??(t==null?void 0:t.pageUp)??Jn.goToPreviousPage,goToFirstCell:(t==null?void 0:t.goToFirstCell)??(t==null?void 0:t.first)??Jn.goToFirstCell,goToLastCell:(t==null?void 0:t.goToLastCell)??(t==null?void 0:t.last)??Jn.goToLastCell,selectToFirstCell:(t==null?void 0:t.selectToFirstCell)??(t==null?void 0:t.first)??Jn.selectToFirstCell,selectToLastCell:(t==null?void 0:t.selectToLastCell)??(t==null?void 0:t.last)??Jn.selectToLastCell};return Hl({...Jn,...n})},[t])}function fu(e){function t(o,r,i){if(typeof o=="number")return{headerIndex:o,isCollapsed:!1,depth:r,path:i};const l={headerIndex:o.headerIndex,isCollapsed:o.isCollapsed,depth:r,path:i};return o.subGroups!==void 0&&(l.subGroups=o.subGroups.map((s,c)=>t(s,r+1,[...i,c])).sort((s,c)=>s.headerIndex-c.headerIndex)),l}return e.map((o,r)=>t(o,0,[r])).sort((o,r)=>o.headerIndex-r.headerIndex)}function Gi(e,t){const n=[];function o(l,s,c=!1){let f=s!==null?s-l.headerIndex:t-l.headerIndex;if(l.subGroups!==void 0&&(f=l.subGroups[0].headerIndex-l.headerIndex),f--,n.push({headerIndex:l.headerIndex,contentIndex:-1,skip:c,isCollapsed:l.isCollapsed,depth:l.depth,path:l.path,rows:f}),l.subGroups)for(let d=0;d<l.subGroups.length;d++){const p=d<l.subGroups.length-1?l.subGroups[d+1].headerIndex:s;o(l.subGroups[d],p,c||l.isCollapsed)}}const r=fu(e.groups);for(let l=0;l<r.length;l++){const s=l<r.length-1?r[l+1].headerIndex:null;o(r[l],s)}let i=0;for(const l of n)l.contentIndex=i,i+=l.rows;return n.filter(l=>l.skip===!1).map(l=>{const{skip:s,...c}=l;return c})}function Zr(e,t){if(t===void 0||Gi.length===0)return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1};let n=e;for(const o of t){if(n===0)return{path:[...o.path,-1],originalIndex:o.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:o.rows};if(n--,!o.isCollapsed){if(n<o.rows)return{path:[...o.path,n],originalIndex:o.headerIndex+n,isGroupHeader:!1,groupIndex:n,contentIndex:o.contentIndex+n,groupRows:o.rows};n-=o.rows}}return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1}}function hu(e,t,n,o){const r=lt.useMemo(()=>e===void 0?void 0:Gi(e,t),[e,t]),i=lt.useMemo(()=>r===void 0?t:r.reduce((f,d)=>f+(d.isCollapsed?1:d.rows+1),0),[r,t]),l=lt.useMemo(()=>e===void 0||typeof n=="number"&&e.height===n?n:f=>{const{isGroupHeader:d}=Zr(f,r);return d?e.height:typeof n=="number"?n:n(f)},[r,e,n]),s=lt.useCallback(f=>{if(r===void 0)return f;let d=f;for(const p of r){if(d===0)return;if(d--,!p.isCollapsed){if(d<p.rows)return p.contentIndex+d;d-=p.rows}}return f},[r]),c=go(o??(e==null?void 0:e.themeOverride),lt.useCallback(f=>{if(e===void 0)return o==null?void 0:o(f,f,f);if(o===void 0&&(e==null?void 0:e.themeOverride)===void 0)return;const{isGroupHeader:d,contentIndex:p,groupIndex:w}=Zr(f,r);return d?e.themeOverride:o==null?void 0:o(f,w,p)},[r,o,e]));return e===void 0?{rowHeight:l,rows:t,rowNumberMapper:s,getRowThemeOverride:c}:{rowHeight:l,rows:i,rowNumberMapper:s,getRowThemeOverride:c}}function gu(e,t){const n=lt.useMemo(()=>e===void 0?void 0:Gi(e,t),[e,t]);return{getRowGroupingForPath:Ts,updateRowGroupingByPath:Hs,mapper:lt.useCallback(o=>{if(typeof o=="number")return Zr(o,n);const r=Zr(o[1],n);return{...r,originalIndex:[o[0],r.originalIndex]}},[n])}}function Hs(e,t,n){const[o,...r]=t;return r[0]===-1?e.map((i,l)=>l===o?{...i,...n}:i):e.map((i,l)=>l===o?{...i,subGroups:Hs(i.subGroups??[],r,n)}:i)}function Ts(e,t){const[n,...o]=t;return o[0]===-1?e[n]:Ts(e[n].subGroups??[],o)}function mu(e,t){const[n]=a.useState(()=>({value:e,callback:t,facade:{get current(){return n.value},set current(o){const r=n.value;r!==o&&(n.value=o,n.callback(o,r))}}}));return n.callback=t,n.facade}function pu(e,t,n,o,r){const[i,l]=a.useMemo(()=>[t!==void 0&&typeof n=="number"?Math.floor(t/n):0,t!==void 0&&typeof n=="number"?-(t%n):0],[t,n]),s=a.useMemo(()=>({x:o.current.x,y:i,width:o.current.width??1,height:o.current.height??1,ty:l}),[o,l,i]),[c,f,d]=Ka(s),p=a.useRef(r);p.current=r;const w=mu(null,m=>{m!==null&&t!==void 0?m.scrollTop=t:m!==null&&e!==void 0&&(m.scrollLeft=e)}),g=(c.height??1)>1;a.useLayoutEffect(()=>{if(t!==void 0&&w.current!==null&&g){if(w.current.scrollTop===t)return;w.current.scrollTop=t,w.current.scrollTop!==t&&d(),p.current()}},[t,g,d,w]);const h=(c.width??1)>1;return a.useLayoutEffect(()=>{if(e!==void 0&&w.current!==null&&h){if(w.current.scrollLeft===e)return;w.current.scrollLeft=e,w.current.scrollLeft!==e&&d(),p.current()}},[e,h,d,w]),{visibleRegion:c,setVisibleRegion:f,scrollRef:w}}const wu=a.lazy(async()=>await Ql(()=>import("./data-grid-overlay-editor-9aO4-koH.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]),import.meta.url));let yu=0;function bu(e){return za(sl(sl(e).filter(t=>t.span!==void 0).map(t=>{var n,o;return In((((n=t.span)==null?void 0:n[0])??0)+1,(((o=t.span)==null?void 0:o[1])??0)+1)})))}function Xr(e,t){return e===void 0||t===0||e.columns.length===0&&e.current===void 0?e:{current:e.current===void 0?void 0:{cell:[e.current.cell[0]+t,e.current.cell[1]],range:{...e.current.range,x:e.current.range.x+t},rangeStack:e.current.rangeStack.map(n=>({...n,x:n.x+t}))},rows:e.rows,columns:e.columns.offset(t)}}const Gr={kind:U.Loading,allowOverlay:!1},Ur={columns:it.empty(),rows:it.empty(),current:void 0},Cu=(e,t)=>{var rl,il,ll;const[n,o]=a.useState(Ur),[r,i]=a.useState(),l=a.useRef(null),s=a.useRef(null),[c,f]=a.useState(),d=a.useRef(),p=typeof window>"u"?null:window,{imageEditorOverride:w,getRowThemeOverride:g,markdownDivCreateNode:h,width:m,height:C,columns:b,rows:y,getCellContent:k,onCellClicked:z,onCellActivated:L,onFillPattern:H,onFinishedEditing:A,coercePasteValue:_,drawHeader:M,drawCell:N,editorBloom:O,onHeaderClicked:F,onColumnProposeMove:E,rangeSelectionColumnSpanning:R=!0,spanRangeBehavior:ce="default",onGroupHeaderClicked:te,onCellContextMenu:le,className:Ie,onHeaderContextMenu:be,getCellsForSelection:Z,onGroupHeaderContextMenu:K,onGroupHeaderRenamed:me,onCellEdited:ne,onCellsEdited:pe,onSearchResultsChanged:ue,searchResults:V,onSearchValueChange:ve,searchValue:Ce,onKeyDown:Ke,onKeyUp:ot,keybindings:wt,editOnType:rt=!0,onRowAppended:Be,onColumnMoved:Ve,validateCell:Me,highlightRegions:yt,rangeSelect:dt="rect",columnSelect:Ze="multi",rowSelect:j="multi",rangeSelectionBlending:Ne="exclusive",columnSelectionBlending:Fe="exclusive",rowSelectionBlending:De="exclusive",onDelete:fe,onDragStart:Ge,onMouseMove:$e,onPaste:We,copyHeaders:de=!1,freezeColumns:xe=0,cellActivationBehavior:tt="second-click",rowSelectionMode:Ue="auto",onHeaderMenuClick:_e,onHeaderIndicatorClick:ut,getGroupDetails:Je,rowGrouping:Te,onSearchClose:kt,onItemHovered:zt,onSelectionCleared:Ct,showSearch:St,onVisibleRegionChanged:Pt,gridSelection:gt,onGridSelectionChange:bn,minColumnWidth:On=50,maxColumnWidth:st=500,maxColumnAutoWidth:Dn,provideEditor:un,trailingRowOptions:ye,freezeTrailingRows:mt=0,allowedFillDirections:Cn="orthogonal",scrollOffsetX:en,scrollOffsetY:tn,verticalBorder:ze,onDragOverCell:Mt,onDrop:ft,onColumnResize:Ot,onColumnResizeEnd:Tt,onColumnResizeStart:Yt,customRenderers:Nn,fillHandle:Rt,experimental:Ft,fixedShadowX:Dt,fixedShadowY:Lt,headerIcons:Hn,imageWindowLoader:mr,initialSize:Xn,isDraggable:Tn,onDragLeave:An,onRowMoved:vn,overscrollX:pr,overscrollY:wr,preventDiagonalScrolling:bo,rightElement:Co,rightElementProps:vo,trapFocus:oo=!1,smoothScrollX:ro,smoothScrollY:Gn,scaleToRem:ei=!1,rowHeight:yr=34,headerHeight:br=36,groupHeaderHeight:ti=br,theme:xo,isOutsideClick:Un,renderers:No,resizeIndicator:ni,scrollToActiveCell:Xo=!0,drawFocusRing:Go=!0}=e,io=Go==="no-editor"?r===void 0:Go,vt=typeof e.rowMarkers=="string"?void 0:e.rowMarkers,_t=(vt==null?void 0:vt.kind)??e.rowMarkers??"none",Uo=(vt==null?void 0:vt.width)??e.rowMarkerWidth,Yo=(vt==null?void 0:vt.startIndex)??e.rowMarkerStartIndex??1,ko=(vt==null?void 0:vt.theme)??e.rowMarkerTheme,Bn=vt==null?void 0:vt.headerTheme,zn=vt==null?void 0:vt.headerAlwaysVisible,So=j!=="multi",xn=(vt==null?void 0:vt.checkboxStyle)??"square",kn=Math.max(On,20),lo=Math.max(st,kn),Cr=Math.max(Dn??lo,kn),_o=a.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),{rows:Re,rowNumberMapper:vr,rowHeight:xr,getRowThemeOverride:nn}=hu(Te,y,yr,g),kr=a.useMemo(()=>Number.parseFloat(_o.fontSize),[_o]),{rowHeight:fn,headerHeight:Ko,groupHeaderHeight:Sr,theme:Mr,overscrollX:oi,overscrollY:ri}=du({groupHeaderHeight:ti,headerHeight:br,overscrollX:pr,overscrollY:wr,remSize:kr,rowHeight:xr,scaleToRem:ei,theme:xo}),on=uu(wt),Yn=Uo??(y>1e4?48:y>1e3?44:y>100?36:32),rn=_t!=="none",T=rn?1:0,pt=Be!==void 0,_n=(ye==null?void 0:ye.sticky)===!0,[Mo,Ro]=a.useState(!1),Vo=St??Mo,ii=a.useCallback(()=>{kt!==void 0?kt():Ro(!1)},[kt]),P=a.useMemo(()=>gt===void 0?void 0:Xr(gt,T),[gt,T])??n,At=a.useRef();At.current===void 0&&(At.current=new AbortController),a.useEffect(()=>()=>At==null?void 0:At.current.abort(),[]);const[Bt,li]=Vd(Z,k,T,At.current,Re),S=a.useCallback((u,x,v)=>{if(Me===void 0)return!0;const D=[u[0]-T,u[1]];return Me==null?void 0:Me(D,x,v)},[T,Me]),Y=a.useRef(gt),ee=a.useCallback((u,x)=>{x&&(u=tu(u,Bt,T,ce,At.current)),bn!==void 0?(Y.current=Xr(u,-T),bn(Y.current)):o(u)},[bn,Bt,T,ce]),oe=go(Ot,a.useCallback((u,x,v,D)=>{Ot==null||Ot(b[v-T],x,v-T,D)},[Ot,T,b])),q=go(Tt,a.useCallback((u,x,v,D)=>{Tt==null||Tt(b[v-T],x,v-T,D)},[Tt,T,b])),ie=go(Yt,a.useCallback((u,x,v,D)=>{Yt==null||Yt(b[v-T],x,v-T,D)},[Yt,T,b])),He=go(M,a.useCallback((u,x)=>(M==null?void 0:M({...u,columnIndex:u.columnIndex-T},x))??!1,[M,T])),Ae=go(N,a.useCallback((u,x)=>(N==null?void 0:N({...u,col:u.col-T},x))??!1,[N,T])),se=a.useCallback(u=>{if(fe!==void 0){const x=fe(Xr(u,-T));return typeof x=="boolean"?x:Xr(x,T)}return!0},[fe,T]),[Qe,re,Ee]=Kd(P,ee,Ne,Fe,De,dt,R),ke=a.useMemo(()=>Wn(ps(),Mr),[Mr]),[Xe,Ht]=a.useState([0,0,0]),Kt=a.useMemo(()=>{if(No===void 0)return{};const u={};for(const x of No)u[x.kind]=x;return u},[No]),je=a.useCallback(u=>u.kind!==U.Custom?Kt[u.kind]:Nn==null?void 0:Nn.find(x=>x.isMatch(u)),[Nn,Kt]);let{sizedColumns:bt,nonGrowWidth:hn}=Cc(b,Re,li,Xe[0]-(T===0?0:Yn)-Xe[2],kn,Cr,ke,je,At.current);_t!=="none"&&(hn+=Yn);const Gt=a.useMemo(()=>bt.some(u=>u.group!==void 0),[bt]),nt=Gt?Ko+Sr:Ko,Vt=P.rows.length,qt=_t==="none"?void 0:Vt===0?!1:Vt===Re?!0:void 0,qe=a.useMemo(()=>_t==="none"?bt:[{title:"",width:Yn,icon:void 0,hasMenu:!1,style:"normal",themeOverride:ko,rowMarker:xn,rowMarkerChecked:qt,headerRowMarkerTheme:Bn,headerRowMarkerAlwaysVisible:zn,headerRowMarkerDisabled:So},...bt],[_t,bt,Yn,ko,xn,qt,Bn,zn,So]),xt=a.useRef({height:1,width:1,x:0,y:0}),Kn=a.useRef(!1),{setVisibleRegion:Vn,visibleRegion:so,scrollRef:at}=pu(en,tn,fn,xt,()=>Kn.current=!0);xt.current=so;const Os=so.x+T,Rr=so.y,jt=a.useRef(null),Ut=a.useCallback(u=>{var x;u===!0?(x=jt.current)==null||x.focus():window.requestAnimationFrame(()=>{var v;(v=jt.current)==null||v.focus()})},[]),Nt=pt?Re+1:Re,ln=a.useCallback(u=>{const x=T===0?u:u.map(D=>({...D,location:[D.location[0]-T,D.location[1]]})),v=pe==null?void 0:pe(x);if(v!==!0)for(const D of x)ne==null||ne(D.location,D.value);return v},[ne,pe,T]),[ao,si]=a.useState(),Er=P.current!==void 0&&P.current.range.width*P.current.range.height>1?P.current.range:void 0,Eo=io?(rl=P.current)==null?void 0:rl.cell:void 0,Ir=Eo==null?void 0:Eo[0],Fr=Eo==null?void 0:Eo[1],Ns=a.useMemo(()=>{if((yt===void 0||yt.length===0)&&(Er??Ir??Fr??ao)===void 0)return;const u=[];if(yt!==void 0)for(const x of yt){const v=qe.length-x.range.x-T;v>0&&u.push({color:x.color,range:{...x.range,x:x.range.x+T,width:Math.min(v,x.range.width)},style:x.style})}return ao!==void 0&&u.push({color:wo(ke.accentColor,0),range:ao,style:"dashed"}),Er!==void 0&&u.push({color:wo(ke.accentColor,.5),range:Er,style:"solid-outline"}),Ir!==void 0&&Fr!==void 0&&u.push({color:ke.accentColor,range:{x:Ir,y:Fr,width:1,height:1},style:"solid-outline"}),u.length>0?u:void 0},[ao,Er,Ir,Fr,yt,qe.length,ke.accentColor,T]),Ui=a.useRef(qe);Ui.current=qe;const Zt=a.useCallback(([u,x],v=!1)=>{var W,B,$,X,G,J,he;const D=pt&&x===Nt-1;if(u===0&&rn){if(D)return Gr;const Q=vr(x);return Q===void 0?Gr:{kind:dn.Marker,allowOverlay:!1,checkboxStyle:xn,checked:(P==null?void 0:P.rows.hasIndex(x))===!0,markerKind:_t==="clickable-number"?"number":_t,row:Yo+Q,drawHandle:vn!==void 0,cursor:_t==="clickable-number"?"pointer":void 0}}else if(D){const we=u===T?(ye==null?void 0:ye.hint)??"":"",ae=Ui.current[u];if(((W=ae==null?void 0:ae.trailingRowOptions)==null?void 0:W.disabled)===!0)return Gr;{const Ye=((B=ae==null?void 0:ae.trailingRowOptions)==null?void 0:B.hint)??we,Se=(($=ae==null?void 0:ae.trailingRowOptions)==null?void 0:$.addIcon)??(ye==null?void 0:ye.addIcon);return{kind:dn.NewRow,hint:Ye,allowOverlay:!1,icon:Se}}}else{const Q=u-T;if(v||(Ft==null?void 0:Ft.strict)===!0){const ae=xt.current,Ye=ae.x>Q||Q>ae.x+ae.width||ae.y>x||x>ae.y+ae.height||x>=ci.current,Se=Q===((G=(X=ae.extras)==null?void 0:X.selected)==null?void 0:G[0])&&x===((J=ae.extras)==null?void 0:J.selected[1]);let ge=!1;if(((he=ae.extras)==null?void 0:he.freezeRegions)!==void 0){for(const et of ae.extras.freezeRegions)if(po(et,Q,x)){ge=!0;break}}if(Ye&&!Se&&!ge)return Gr}let we=k([Q,x]);return T!==0&&we.span!==void 0&&(we={...we,span:[we.span[0]+T,we.span[1]+T]}),we}},[pt,Nt,rn,vr,xn,P==null?void 0:P.rows,_t,Yo,vn,T,ye==null?void 0:ye.hint,ye==null?void 0:ye.addIcon,Ft==null?void 0:Ft.strict,k]),ai=a.useCallback(u=>{let x=(Je==null?void 0:Je(u))??{name:u};return me!==void 0&&u!==""&&(x={icon:x.icon,name:x.name,overrideTheme:x.overrideTheme,actions:[...x.actions??[],{title:"Rename",icon:"renameIcon",onClick:v=>ui({group:x.name,bounds:v.bounds})}]}),x},[Je,me]),Dr=a.useCallback(u=>{var $;const[x,v]=u.cell,D=qe[x],I=(D==null?void 0:D.group)!==void 0?($=ai(D.group))==null?void 0:$.overrideTheme:void 0,W=D==null?void 0:D.themeOverride,B=nn==null?void 0:nn(v);i({...u,theme:Wn(ke,I,W,B,u.content.themeOverride)})},[nn,qe,ai,ke]),Io=a.useCallback((u,x,v)=>{var B;if(P.current===void 0)return;const[D,I]=P.current.cell,W=Zt([D,I]);if(W.kind!==U.Boolean&&W.allowOverlay){let $=W;if(v!==void 0)switch($.kind){case U.Number:{const X=La(()=>v==="-"?-0:Number.parseFloat(v),0);$={...$,data:Number.isNaN(X)?0:X};break}case U.Text:case U.Markdown:case U.Uri:$={...$,data:v};break}Dr({target:u,content:$,initialValue:v,cell:[D,I],highlight:v===void 0,forceEditMode:v!==void 0})}else W.kind===U.Boolean&&x&&W.readonly!==!0&&(ln([{location:P.current.cell,value:{...W,data:Ds(W.data)}}]),(B=jt.current)==null||B.damage([{cell:P.current.cell}]))},[Zt,P,ln,Dr]),Yi=a.useCallback((u,x)=>{var I;const v=(I=jt.current)==null?void 0:I.getBounds(u,x);if(v===void 0||at.current===null)return;const D=Zt([u,x]);D.allowOverlay&&Dr({target:v,content:D,initialValue:void 0,highlight:!0,cell:[u,x],forceEditMode:!0})},[Zt,at,Dr]),Et=a.useCallback((u,x,v="both",D=0,I=0,W=void 0)=>{if(at.current!==null){const B=jt.current,$=s.current,X=typeof u!="number"?u.unit==="cell"?u.amount:void 0:u,G=typeof x!="number"?x.unit==="cell"?x.amount:void 0:x,J=typeof u!="number"&&u.unit==="px"?u.amount:void 0,he=typeof x!="number"&&x.unit==="px"?x.amount:void 0;if(B!==null&&$!==null){let Q={x:0,y:0,width:0,height:0},we=0,ae=0;if((X!==void 0||G!==void 0)&&(Q=B.getBounds((X??0)+T,G??0)??Q,Q.width===0||Q.height===0))return;const Ye=$.getBoundingClientRect(),Se=Ye.width/$.offsetWidth;if(J!==void 0&&(Q={...Q,x:J-Ye.left-at.current.scrollLeft,width:1}),he!==void 0&&(Q={...Q,y:he+Ye.top-at.current.scrollTop,height:1}),Q!==void 0){const ge={x:Q.x-D,y:Q.y-I,width:Q.width+2*D,height:Q.height+2*I};let et=0;for(let yi=0;yi<xe;yi++)et+=bt[yi].width;let ht=0;const It=mt+(_n?1:0);It>0&&(ht=yo(Nt,It,fn));let pn=et*Se+Ye.left+T*Yn*Se,Mn=Ye.right,wn=Ye.top+nt*Se,Rn=Ye.bottom-ht*Se;const Pr=Q.width+D*2;switch(W==null?void 0:W.hAlign){case"start":Mn=pn+Pr;break;case"end":pn=Mn-Pr;break;case"center":pn=Math.floor((pn+Mn)/2)-Pr/2,Mn=pn+Pr;break}const $r=Q.height+I*2;switch(W==null?void 0:W.vAlign){case"start":Rn=wn+$r;break;case"end":wn=Rn-$r;break;case"center":wn=Math.floor((wn+Rn)/2)-$r/2,Rn=wn+$r;break}pn>ge.x?we=ge.x-pn:Mn<ge.x+ge.width&&(we=ge.x+ge.width-Mn),wn>ge.y?ae=ge.y-wn:Rn<ge.y+ge.height&&(ae=ge.y+ge.height-Rn),v==="vertical"||typeof u=="number"&&u<xe?we=0:(v==="horizontal"||typeof x=="number"&&x>=Nt-It)&&(ae=0),(we!==0||ae!==0)&&(Se!==1&&(we/=Se,ae/=Se),at.current.scrollTo(we+at.current.scrollLeft,ae+at.current.scrollTop))}}}},[T,mt,Yn,at,nt,xe,bt,Nt,_n,fn]),_i=a.useRef(Yi),Ki=a.useRef(k),ci=a.useRef(Re);_i.current=Yi,Ki.current=k,ci.current=Re;const Fo=a.useCallback(async(u,x=!0)=>{var X;const v=qe[u];if(((X=v==null?void 0:v.trailingRowOptions)==null?void 0:X.disabled)===!0)return;const D=Be==null?void 0:Be();let I,W=!0;D!==void 0&&(I=await D,I==="top"&&(W=!1),typeof I=="number"&&(W=!1));let B=0;const $=()=>{if(ci.current<=Re){B<500&&window.setTimeout($,B),B=50+B*2;return}const G=typeof I=="number"?I:W?Re:0;Lr.current(u-T,G),Qe({cell:[u,G],range:{x:u,y:G,width:1,height:1}},!1,!1,"edit");const J=Ki.current([u-T,G]);J.allowOverlay&&lr(J)&&J.readonly!==!0&&x&&window.setTimeout(()=>{_i.current(u,G)},0)};$()},[qe,Be,T,Re,Qe]),Hr=a.useCallback(u=>{var v,D;const x=((D=(v=bt[u])==null?void 0:v.trailingRowOptions)==null?void 0:D.targetColumn)??(ye==null?void 0:ye.targetColumn);if(typeof x=="number")return x+(rn?1:0);if(typeof x=="object"){const I=b.indexOf(x);if(I>=0)return I+(rn?1:0)}},[bt,b,rn,ye==null?void 0:ye.targetColumn]),jn=a.useRef(),Do=a.useRef(),qo=a.useCallback((u,x)=>{var I;const[v,D]=x;return Wn(ke,(I=qe[v])==null?void 0:I.themeOverride,nn==null?void 0:nn(D),u.themeOverride)},[nn,qe,ke]),{mapper:co}=gu(Te,y),gn=Te==null?void 0:Te.navigationBehavior,Zo=a.useCallback(u=>{var J,he,Q;const x=jr.value?u.metaKey:u.ctrlKey,v=x&&j==="multi",D=x&&Ze==="multi",[I,W]=u.location,B=P.columns,$=P.rows,[X,G]=((J=P.current)==null?void 0:J.cell)??[];if(u.kind==="cell"){if(Do.current=void 0,uo.current=[I,W],I===0&&rn){if(pt===!0&&W===Re||_t==="number"||j==="none")return;const we=Zt(u.location);if(we.kind!==dn.Marker)return;if(vn!==void 0){const Se=je(we);Jt((Se==null?void 0:Se.kind)===dn.Marker);const ge=(he=Se==null?void 0:Se.onClick)==null?void 0:he.call(Se,{...u,cell:we,posX:u.localEventX,posY:u.localEventY,bounds:u.bounds,theme:qo(we,u.location),preventDefault:()=>{}});if(ge===void 0||ge.checked===we.checked)return}i(void 0),Ut();const ae=$.hasIndex(W),Ye=jn.current;if(j==="multi"&&(u.shiftKey||u.isLongTouch===!0)&&Ye!==void 0&&$.hasIndex(Ye)){const Se=[Math.min(Ye,W),Math.max(Ye,W)+1];v||Ue==="multi"?re(void 0,Se,!0):re(it.fromSingleSelection(Se),void 0,v)}else j==="multi"&&(v||u.isTouch||Ue==="multi")?ae?re($.remove(W),void 0,!0):(re(void 0,W,!0),jn.current=W):ae&&$.length===1?re(it.empty(),void 0,x):(re(it.fromSingleSelection(W),void 0,x),jn.current=W)}else if(I>=T&&pt&&W===Re){const we=Hr(I);Fo(we??I)}else if(X!==I||G!==W){const we=Zt(u.location),ae=je(we);if((ae==null?void 0:ae.onSelect)!==void 0){let ge=!1;if(ae.onSelect({...u,cell:we,posX:u.localEventX,posY:u.localEventY,bounds:u.bounds,preventDefault:()=>ge=!0,theme:qo(we,u.location)}),ge)return}if(gn==="block"&&co(W).isGroupHeader)return;const Ye=_n&&W===Re,Se=_n&&P!==void 0&&((Q=P.current)==null?void 0:Q.cell[1])===Re;if((u.shiftKey||u.isLongTouch===!0)&&X!==void 0&&G!==void 0&&P.current!==void 0&&!Se){if(Ye)return;const ge=Math.min(I,X),et=Math.max(I,X),ht=Math.min(W,G),It=Math.max(W,G);Qe({...P.current,range:{x:ge,y:ht,width:et-ge+1,height:It-ht+1}},!0,x,"click"),jn.current=void 0,Ut()}else Qe({cell:[I,W],range:{x:I,y:W,width:1,height:1}},!0,x,"click"),jn.current=void 0,i(void 0),Ut()}}else if(u.kind==="header")if(uo.current=[I,W],i(void 0),rn&&I===0)jn.current=void 0,Do.current=void 0,j==="multi"&&($.length!==Re?re(it.fromSingleSelection([0,Re]),void 0,x):re(it.empty(),void 0,x),Ut());else{const we=Do.current;if(Ze==="multi"&&(u.shiftKey||u.isLongTouch===!0)&&we!==void 0&&B.hasIndex(we)){const ae=[Math.min(we,I),Math.max(we,I)+1];D?Ee(void 0,ae,x):Ee(it.fromSingleSelection(ae),void 0,x)}else D?(B.hasIndex(I)?Ee(B.remove(I),void 0,x):Ee(void 0,I,x),Do.current=I):Ze!=="none"&&(Ee(it.fromSingleSelection(I),void 0,x),Do.current=I);jn.current=void 0,Ut()}else u.kind===cn?uo.current=[I,W]:u.kind===qr&&!u.isMaybeScrollbar&&(ee(Ur,!1),i(void 0),Ut(),Ct==null||Ct(),jn.current=void 0,Do.current=void 0)},[j,Ze,P,rn,T,pt,Re,_t,Zt,vn,Ut,Ue,je,qo,re,Hr,Fo,gn,co,_n,Qe,Ee,ee,Ct]),Jo=a.useRef(!1),uo=a.useRef(),Vi=a.useRef(so),sn=a.useRef(),Xs=a.useCallback(u=>{if(Ho.current=!1,Vi.current=xt.current,u.button!==0&&u.button!==1){sn.current=void 0;return}const x=performance.now();sn.current={button:u.button,time:x,location:u.location},(u==null?void 0:u.kind)==="header"&&(Jo.current=!0);const v=u.kind==="cell"&&u.isFillHandle;!v&&u.kind!=="cell"&&u.isEdge||(f({previousSelection:P,fillHandle:v}),uo.current=void 0,!u.isTouch&&u.button===0&&!v?Zo(u):!u.isTouch&&u.button===1&&(uo.current=u.location))},[P,Zo]),[di,ui]=a.useState(),ji=a.useCallback(u=>{if(u.kind!==cn||Ze!=="multi")return;const x=jr.value?u.metaKey:u.ctrlKey,[v]=u.location,D=P.columns;if(v<T)return;const I=qe[v];let W=v,B=v;for(let $=v-1;$>=T&&fr(I.group,qe[$].group);$--)W--;for(let $=v+1;$<qe.length&&fr(I.group,qe[$].group);$++)B++;if(Ut(),x)if(D.hasAll([W,B+1])){let $=D;for(let X=W;X<=B;X++)$=$.remove(X);Ee($,void 0,x)}else Ee(void 0,[W,B+1],x);else Ee(it.fromSingleSelection([W,B+1]),void 0,x)},[Ze,Ut,P.columns,qe,T,Ee]),Ho=a.useRef(!1),Tr=a.useCallback(async u=>{if(Bt!==void 0&&oe!==void 0){const x=xt.current.y,v=xt.current.height;let D=Bt({x:u,y:x,width:1,height:Math.min(v,Re-x)},At.current.signal);typeof D!="object"&&(D=await D());const I=bt[u-T],B=document.createElement("canvas").getContext("2d",{alpha:!1});if(B!==null){B.font=ke.baseFontFull;const $=ws(B,ke,I,0,D,kn,lo,!1,je);oe==null||oe(I,$.width,u,$.width)}}},[bt,Bt,lo,ke,kn,oe,T,Re,je]),[Gs,fi]=a.useState(),To=a.useCallback(async(u,x)=>{var $,X;const v=($=u.current)==null?void 0:$.range;if(v===void 0||Bt===void 0||x.current===void 0)return;const D=x.current.range;if(H!==void 0){let G=!1;if(H({fillDestination:{...D,x:D.x-T},patternSource:{...v,x:v.x-T},preventDefault:()=>G=!0}),G)return}let I=Bt(v,At.current.signal);typeof I!="object"&&(I=await I());const W=I,B=[];for(let G=0;G<D.width;G++)for(let J=0;J<D.height;J++){const he=[D.x+G,D.y+J];if(ls(he,v))continue;const Q=W[J%v.height][G%v.width];Bo(Q)||!lr(Q)||B.push({location:he,value:{...Q}})}ln(B),(X=jt.current)==null||X.damage(B.map(G=>({cell:G.location})))},[Bt,ln,H,T]),qi=a.useCallback(()=>{if(P.current===void 0||P.current.range.width<=1)return;const u={...P,current:{...P.current,range:{...P.current.range,width:1}}};To(u,P)},[To,P]),Zi=a.useCallback(()=>{if(P.current===void 0||P.current.range.height<=1)return;const u={...P,current:{...P.current,range:{...P.current.range,height:1}}};To(u,P)},[To,P]),Us=a.useCallback((u,x)=>{var J,he;const v=c;if(f(void 0),si(void 0),fi(void 0),Jo.current=!1,x)return;if((v==null?void 0:v.fillHandle)===!0&&P.current!==void 0&&((J=v.previousSelection)==null?void 0:J.current)!==void 0){if(ao===void 0)return;const Q={...P,current:{...P.current,range:xs(v.previousSelection.current.range,ao)}};To(v.previousSelection,Q),ee(Q,!0);return}const[D,I]=u.location,[W,B]=uo.current??[],$=()=>{Ho.current=!0},X=Q=>{var ae,Ye,Se;const we=Q.isTouch||W===D&&B===I;if(we&&(z==null||z([D-T,I],{...Q,preventDefault:$})),Q.button===1)return!Ho.current;if(!Ho.current){const ge=Zt(u.location),et=je(ge);if(et!==void 0&&et.onClick!==void 0&&we){const It=et.onClick({...Q,cell:ge,posX:Q.localEventX,posY:Q.localEventY,bounds:Q.bounds,theme:qo(ge,u.location),preventDefault:$});It!==void 0&&!Bo(It)&&eo(It)&&(ln([{location:Q.location,value:It}]),(ae=jt.current)==null||ae.damage([{cell:Q.location}]))}if(Ho.current||P.current===void 0)return!1;let ht=!1;switch(ge.activationBehaviorOverride??tt){case"double-click":case"second-click":{if(((Se=(Ye=v==null?void 0:v.previousSelection)==null?void 0:Ye.current)==null?void 0:Se.cell)===void 0)break;const[It,pn]=P.current.cell,[Mn,wn]=v.previousSelection.current.cell;ht=D===It&&D===Mn&&I===pn&&I===wn&&(Q.isDoubleClick===!0||tt==="second-click");break}case"single-click":{ht=!0;break}}if(ht)return L==null||L([D-T,I]),Io(Q.bounds,!1),!0}return!1},G=u.location[0]-T;if(u.isTouch){const Q=xt.current,we=Vi.current;if(Q.x!==we.x||Q.y!==we.y)return;if(u.isLongTouch===!0){if(u.kind==="cell"&&sr((he=P.current)==null?void 0:he.cell,u.location)){le==null||le([G,u.location[1]],{...u,preventDefault:$});return}else if(u.kind==="header"&&P.columns.hasIndex(D)){be==null||be(G,{...u,preventDefault:$});return}else if(u.kind===cn){if(G<0)return;K==null||K(G,{...u,preventDefault:$});return}}u.kind==="cell"?X(u)||Zo(u):u.kind===cn?te==null||te(G,{...u,preventDefault:$}):(u.kind===Qn&&(F==null||F(G,{...u,preventDefault:$})),Zo(u));return}if(u.kind==="header"){if(G<0)return;u.isEdge?u.isDoubleClick===!0&&Tr(D):u.button===0&&D===W&&I===B&&(F==null||F(G,{...u,preventDefault:$}))}if(u.kind===cn){if(G<0)return;u.button===0&&D===W&&I===B&&(te==null||te(G,{...u,preventDefault:$}),Ho.current||ji(u))}u.kind==="cell"&&(u.button===0||u.button===1)&&X(u),uo.current=void 0},[c,P,T,ao,To,ee,z,Zt,je,tt,qo,ln,L,Io,le,be,K,Zo,te,F,Tr,ji]),Ys=a.useCallback(u=>{const x={...u,location:[u.location[0]-T,u.location[1]]};$e==null||$e(x),c!==void 0&&u.buttons===0&&(f(void 0),si(void 0),fi(void 0),Jo.current=!1),fi(v=>{var D;return Jo.current?[u.scrollEdge[0],0]:u.scrollEdge[0]===(v==null?void 0:v[0])&&u.scrollEdge[1]===v[1]?v:c===void 0||(((D=sn.current)==null?void 0:D.location[0])??0)<T?void 0:u.scrollEdge})},[c,$e,T]),_s=a.useCallback((u,x)=>{_e==null||_e(u-T,x)},[_e,T]),Ks=a.useCallback((u,x)=>{ut==null||ut(u-T,x)},[ut,T]),Sn=(il=P==null?void 0:P.current)==null?void 0:il.cell,Vs=a.useCallback((u,x,v,D,I,W)=>{Kn.current=!1;let B=Sn;B!==void 0&&(B=[B[0]-T,B[1]]);const $=xe===0?void 0:{x:0,y:u.y,width:xe,height:u.height},X=[];$!==void 0&&X.push($),mt>0&&(X.push({x:u.x-T,y:Re-mt,width:u.width,height:mt}),xe>0&&X.push({x:0,y:Re-mt,width:xe,height:mt}));const G={x:u.x-T,y:u.y,width:u.width,height:pt&&u.y+u.height>=Re?u.height-1:u.height,tx:I,ty:W,extras:{selected:B,freezeRegion:$,freezeRegions:X}};xt.current=G,Vn(G),Ht([x,v,D]),Pt==null||Pt(G,G.tx,G.ty,G.extras)},[Sn,T,pt,Re,xe,mt,Vn,Pt]),js=go(Ve,a.useCallback((u,x)=>{Ve==null||Ve(u-T,x-T),Ze!=="none"&&Ee(it.fromSingleSelection(x),void 0,!0)},[Ze,Ve,T,Ee])),hi=a.useRef(!1),qs=a.useCallback(u=>{if(u.location[0]===0&&T>0){u.preventDefault();return}Ge==null||Ge({...u,location:[u.location[0]-T,u.location[1]]}),u.defaultPrevented()||(hi.current=!0),f(void 0)},[Ge,T]),Zs=a.useCallback(()=>{hi.current=!1},[]),Ji=Te==null?void 0:Te.selectionBehavior,Ar=a.useCallback(u=>{if(Ji!=="block-spanning")return;const{isGroupHeader:x,path:v,groupRows:D}=co(u);if(x)return[u,u];const I=v[v.length-1],W=u-I,B=u+D-I-1;return[W,B]},[co,Ji]),gi=a.useRef(),mi=a.useCallback(u=>{var x,v,D;if(!Is(u,gi.current)&&(gi.current=u,!(((x=sn==null?void 0:sn.current)==null?void 0:x.button)!==void 0&&sn.current.button>=1))){if(u.buttons!==0&&c!==void 0&&((v=sn.current)==null?void 0:v.location[0])===0&&u.location[0]===0&&T===1&&j==="multi"&&c.previousSelection&&!c.previousSelection.rows.hasIndex(sn.current.location[1])&&P.rows.hasIndex(sn.current.location[1])){const I=Math.min(sn.current.location[1],u.location[1]),W=Math.max(sn.current.location[1],u.location[1])+1;re(it.fromSingleSelection([I,W]),void 0,!1)}if(u.buttons!==0&&c!==void 0&&P.current!==void 0&&!hi.current&&!Jo.current&&(dt==="rect"||dt==="multi-rect")){const[I,W]=P.current.cell;let[B,$]=u.location;if($<0&&($=xt.current.y),c.fillHandle===!0&&((D=c.previousSelection)==null?void 0:D.current)!==void 0){const X=c.previousSelection.current.range;$=Math.min($,pt?Re-1:Re);const G=Jc(X,B,$,Cn);si(G)}else{if(pt&&W===Re)return;if(pt&&$===Re)if(u.kind===qr)$--;else return;B=Math.max(B,T);const J=Ar(W);$=J===void 0?$:an($,J[0],J[1]);const he=B-I,Q=$-W,we={x:he>=0?I:B,y:Q>=0?W:$,width:Math.abs(he)+1,height:Math.abs(Q)+1};Qe({...P.current,range:we},!0,!1,"drag")}}zt==null||zt({...u,location:[u.location[0]-T,u.location[1]]})}},[c,T,j,P,dt,zt,re,pt,Re,Cn,Ar,Qe]),Js=a.useCallback(()=>{var B,$;const u=gi.current;if(u===void 0)return;const[x,v]=u.scrollEdge;let[D,I]=u.location;const W=xt.current;x===-1?D=(($=(B=W.extras)==null?void 0:B.freezeRegion)==null?void 0:$.x)??W.x:x===1&&(D=W.x+W.width),v===-1?I=Math.max(0,W.y):v===1&&(I=Math.min(Re-1,W.y+W.height)),D=an(D,0,qe.length-1),I=an(I,0,Re-1),mi({...u,location:[D,I]})},[qe.length,mi,Re]);cu(Gs,at,Js);const mn=a.useCallback(u=>{if(P.current===void 0)return;const[x,v]=u,[D,I]=P.current.cell,W=P.current.range;let B=W.x,$=W.x+W.width,X=W.y,G=W.y+W.height;const[J,he]=Ar(I)??[0,Re-1],Q=he+1;if(v!==0)switch(v){case 2:{G=Q,X=I,Et(0,G,"vertical");break}case-2:{X=J,G=I+1,Et(0,X,"vertical");break}case 1:{X<I?(X++,Et(0,X,"vertical")):(G=Math.min(Q,G+1),Et(0,G,"vertical"));break}case-1:{G>I+1?(G--,Et(0,G,"vertical")):(X=Math.max(J,X-1),Et(0,X,"vertical"));break}default:ur()}if(x!==0)if(x===2)$=qe.length,B=D,Et($-1-T,0,"horizontal");else if(x===-2)B=T,$=D+1,Et(B-T,0,"horizontal");else{let we=[];if(Bt!==void 0){const ae=Bt({x:B,y:X,width:$-B-T,height:G-X},At.current.signal);typeof ae=="object"&&(we=bu(ae))}if(x===1){let ae=!1;if(B<D){if(we.length>0){const Ye=In(B+1,D+1).find(Se=>!we.includes(Se-T));Ye!==void 0&&(B=Ye,ae=!0)}else B++,ae=!0;ae&&Et(B,0,"horizontal")}ae||($=Math.min(qe.length,$+1),Et($-1-T,0,"horizontal"))}else if(x===-1){let ae=!1;if($>D+1){if(we.length>0){const Ye=In($-1,D,-1).find(Se=>!we.includes(Se-T));Ye!==void 0&&($=Ye,ae=!0)}else $--,ae=!0;ae&&Et($-T,0,"horizontal")}ae||(B=Math.max(T,B-1),Et(B-T,0,"horizontal"))}else ur()}Qe({cell:P.current.cell,range:{x:B,y:X,width:$-B,height:G-X}},!0,!1,"keyboard-select")},[Bt,Ar,P,qe.length,T,Re,Et,Qe]),pi=a.useRef(Xo);pi.current=Xo;const qn=a.useCallback((u,x,v,D)=>{const I=Nt-(v?0:1);u=an(u,T,bt.length-1+T),x=an(x,0,I);const W=Sn==null?void 0:Sn[0],B=Sn==null?void 0:Sn[1];if(u===W&&x===B)return!1;if(D&&P.current!==void 0){const $=[...P.current.rangeStack];(P.current.range.width>1||P.current.range.height>1)&&$.push(P.current.range),ee({...P,current:{cell:[u,x],range:{x:u,y:x,width:1,height:1},rangeStack:$}},!0)}else Qe({cell:[u,x],range:{x:u,y:x,width:1,height:1}},!0,!1,"keyboard-nav");return d.current!==void 0&&d.current[0]===u&&d.current[1]===x&&(d.current=void 0),pi.current&&Et(u-T,x),!0},[Nt,T,bt.length,Sn,P,Et,ee,Qe]),Qs=a.useCallback((u,x)=>{(r==null?void 0:r.cell)!==void 0&&u!==void 0&&eo(u)&&(ln([{location:r.cell,value:u}]),window.requestAnimationFrame(()=>{var I;(I=jt.current)==null||I.damage([{cell:r.cell}])})),Ut(!0),i(void 0);const[v,D]=x;if(P.current!==void 0&&(v!==0||D!==0)){const I=P.current.cell[1]===Nt-1&&u!==void 0;qn(an(P.current.cell[0]+v,0,qe.length-1),an(P.current.cell[1]+D,0,Nt-1),I,!1)}A==null||A(u,x)},[r==null?void 0:r.cell,Ut,P,A,ln,Nt,qn,qe.length]),ea=a.useMemo(()=>`gdg-overlay-${yu++}`,[]),fo=a.useCallback(u=>{var v,D,I,W;Ut();const x=[];for(let B=u.x;B<u.x+u.width;B++)for(let $=u.y;$<u.y+u.height;$++){const X=k([B-T,$]);if(!X.allowOverlay&&X.kind!==U.Boolean)continue;let G;if(X.kind===U.Custom){const J=je(X),he=(v=J==null?void 0:J.provideEditor)==null?void 0:v.call(J,X);(J==null?void 0:J.onDelete)!==void 0?G=J.onDelete(X):$a(he)&&(G=(D=he==null?void 0:he.deletedValue)==null?void 0:D.call(he,X))}else if(eo(X)&&X.allowOverlay||X.kind===U.Boolean){const J=je(X);G=(I=J==null?void 0:J.onDelete)==null?void 0:I.call(J,X)}G!==void 0&&!Bo(G)&&eo(G)&&x.push({location:[B,$],value:G})}ln(x),(W=jt.current)==null||W.damage(x.map(B=>({cell:B.location})))},[Ut,k,je,ln,T]),Qo=r!==void 0,Qi=a.useCallback(u=>{var Ye,Se;const x=()=>{u.stopPropagation(),u.preventDefault()},v={didMatch:!1},{bounds:D}=u,I=P.columns,W=P.rows,B=on;if(!Qo&&Le(B.clear,u,v))ee(Ur,!1),Ct==null||Ct();else if(!Qo&&Le(B.selectAll,u,v))ee({columns:it.empty(),rows:it.empty(),current:{cell:((Ye=P.current)==null?void 0:Ye.cell)??[T,0],range:{x:T,y:0,width:b.length,height:Re},rangeStack:[]}},!1);else if(Le(B.search,u,v))(Se=l==null?void 0:l.current)==null||Se.focus({preventScroll:!0}),Ro(!0);else if(Le(B.delete,u,v)){const ge=(se==null?void 0:se(P))??!0;if(ge!==!1){const et=ge===!0?P:ge;if(et.current!==void 0){fo(et.current.range);for(const ht of et.current.rangeStack)fo(ht)}for(const ht of et.rows)fo({x:T,y:ht,width:b.length,height:1});for(const ht of et.columns)fo({x:ht,y:0,width:1,height:Re})}}if(v.didMatch)return x(),!0;if(P.current===void 0)return!1;let[$,X]=P.current.cell;const[,G]=P.current.cell;let J=!1,he=!1;if(Le(B.scrollToSelectedCell,u,v)?Lr.current($-T,X):Ze!=="none"&&Le(B.selectColumn,u,v)?I.hasIndex($)?Ee(I.remove($),void 0,!0):Ze==="single"?Ee(it.fromSingleSelection($),void 0,!0):Ee(void 0,$,!0):j!=="none"&&Le(B.selectRow,u,v)?W.hasIndex(X)?re(W.remove(X),void 0,!0):j==="single"?re(it.fromSingleSelection(X),void 0,!0):re(void 0,X,!0):!Qo&&D!==void 0&&Le(B.activateCell,u,v)?X===Re&&pt?window.setTimeout(()=>{const ge=Hr($);Fo(ge??$)},0):(L==null||L([$-T,X]),Io(D,!0)):P.current.range.height>1&&Le(B.downFill,u,v)?Zi():P.current.range.width>1&&Le(B.rightFill,u,v)?qi():Le(B.goToNextPage,u,v)?X+=Math.max(1,xt.current.height-4):Le(B.goToPreviousPage,u,v)?X-=Math.max(1,xt.current.height-4):Le(B.goToFirstCell,u,v)?(i(void 0),X=0,$=0):Le(B.goToLastCell,u,v)?(i(void 0),X=Number.MAX_SAFE_INTEGER,$=Number.MAX_SAFE_INTEGER):Le(B.selectToFirstCell,u,v)?(i(void 0),mn([-2,-2])):Le(B.selectToLastCell,u,v)?(i(void 0),mn([2,2])):Qo?(Le(B.closeOverlay,u,v)&&i(void 0),Le(B.acceptOverlayDown,u,v)&&(i(void 0),X++),Le(B.acceptOverlayUp,u,v)&&(i(void 0),X--),Le(B.acceptOverlayLeft,u,v)&&(i(void 0),$--),Le(B.acceptOverlayRight,u,v)&&(i(void 0),$++)):(Le(B.goDownCell,u,v)?X+=1:Le(B.goUpCell,u,v)?X-=1:Le(B.goRightCell,u,v)?$+=1:Le(B.goLeftCell,u,v)?$-=1:Le(B.goDownCellRetainSelection,u,v)?(X+=1,J=!0):Le(B.goUpCellRetainSelection,u,v)?(X-=1,J=!0):Le(B.goRightCellRetainSelection,u,v)?($+=1,J=!0):Le(B.goLeftCellRetainSelection,u,v)?($-=1,J=!0):Le(B.goToLastRow,u,v)?X=Re-1:Le(B.goToFirstRow,u,v)?X=Number.MIN_SAFE_INTEGER:Le(B.goToLastColumn,u,v)?$=Number.MAX_SAFE_INTEGER:Le(B.goToFirstColumn,u,v)?$=Number.MIN_SAFE_INTEGER:(dt==="rect"||dt==="multi-rect")&&(Le(B.selectGrowDown,u,v)?mn([0,1]):Le(B.selectGrowUp,u,v)?mn([0,-1]):Le(B.selectGrowRight,u,v)?mn([1,0]):Le(B.selectGrowLeft,u,v)?mn([-1,0]):Le(B.selectToLastRow,u,v)?mn([0,2]):Le(B.selectToFirstRow,u,v)?mn([0,-2]):Le(B.selectToLastColumn,u,v)?mn([2,0]):Le(B.selectToFirstColumn,u,v)&&mn([-2,0])),he=v.didMatch),gn!==void 0&&gn!=="normal"&&X!==G){const ge=gn==="skip-up"||gn==="skip"||gn==="block",et=gn==="skip-down"||gn==="skip"||gn==="block",ht=X<G;if(ht&&ge){for(;X>=0&&co(X).isGroupHeader;)X--;X<0&&(X=G)}else if(!ht&&et){for(;X<Re&&co(X).isGroupHeader;)X++;X>=Re&&(X=G)}}const we=qn($,X,!1,J),ae=v.didMatch;return ae&&(we||!he||oo)&&x(),ae},[gn,Qo,P,on,Ze,j,dt,T,co,Re,qn,ee,Ct,b.length,se,oo,fo,Ee,re,pt,Hr,Fo,L,Io,Zi,qi,mn]),er=a.useCallback(u=>{let x=!1;if(Ke!==void 0&&Ke({...u,cancel:()=>{x=!0}}),x||Qi(u)||P.current===void 0)return;const[v,D]=P.current.cell,I=xt.current;if(rt&&!u.metaKey&&!u.ctrlKey&&P.current!==void 0&&u.key.length===1&&/[ -~]/g.test(u.key)&&u.bounds!==void 0&&lr(k([v-T,Math.max(0,Math.min(D,Re-1))]))){if((!pt||D!==Re)&&(I.y>D||D>I.y+I.height||I.x>v||v>I.x+I.width))return;Io(u.bounds,!0,u.key),u.stopPropagation(),u.preventDefault()}},[rt,Ke,Qi,P,k,T,Re,pt,Io]),ta=a.useCallback((u,x)=>{const v=u.location[0]-T;if(u.kind==="header"&&(be==null||be(v,{...u,preventDefault:x})),u.kind===cn){if(v<0)return;K==null||K(v,{...u,preventDefault:x})}if(u.kind==="cell"){const[D,I]=u.location;le==null||le([v,I],{...u,preventDefault:x}),oc(P,u.location)||qn(D,I,!1,!1)}},[P,le,K,be,T,qn]),wi=a.useCallback(async u=>{var B,$,X;if(!on.paste)return;function x(G,J,he,Q){var ae,Ye;const we=typeof he=="object"?(he==null?void 0:he.join(`
`))??"":(he==null?void 0:he.toString())??"";if(!Bo(G)&&lr(G)&&G.readonly!==!0){const Se=_==null?void 0:_(we,G);if(Se!==void 0&&eo(Se))return{location:J,value:Se};const ge=je(G);if(ge===void 0)return;if(ge.kind===U.Custom){Jt(G.kind===U.Custom);const et=(ae=ge.onPaste)==null?void 0:ae.call(ge,we,G.data);return et===void 0?void 0:{location:J,value:{...G,data:et}}}else{const et=(Ye=ge.onPaste)==null?void 0:Ye.call(ge,we,G,{formatted:Q,formattedString:typeof Q=="string"?Q:Q==null?void 0:Q.join(`
`),rawValue:he});return et===void 0?void 0:(Jt(et.kind===G.kind),{location:J,value:et})}}}const v=P.columns,D=P.rows,I=((B=at.current)==null?void 0:B.contains(document.activeElement))===!0||(($=s.current)==null?void 0:$.contains(document.activeElement))===!0;let W;if(P.current!==void 0?W=[P.current.range.x,P.current.range.y]:v.length===1?W=[v.first()??0,0]:D.length===1&&(W=[T,D.first()??0]),I&&W!==void 0){let G,J;const he="text/plain",Q="text/html";if(navigator.clipboard.read!==void 0){const Se=await navigator.clipboard.read();for(const ge of Se){if(ge.types.includes(Q)){const ht=await(await ge.getType(Q)).text(),It=El(ht);if(It!==void 0){G=It;break}}ge.types.includes(he)&&(J=await(await ge.getType(he)).text())}}else if(navigator.clipboard.readText!==void 0)J=await navigator.clipboard.readText();else if(u!==void 0&&(u==null?void 0:u.clipboardData)!==null){if(u.clipboardData.types.includes(Q)){const Se=u.clipboardData.getData(Q);G=El(Se)}G===void 0&&u.clipboardData.types.includes(he)&&(J=u.clipboardData.getData(he))}else return;const[we,ae]=W,Ye=[];do{if(We===void 0){const Se=Zt(W),ge=J??(G==null?void 0:G.map(ht=>ht.map(It=>It.rawValue).join("	")).join("	"))??"",et=x(Se,W,ge,void 0);et!==void 0&&Ye.push(et);break}if(G===void 0){if(J===void 0)return;G=nu(J)}if(We===!1||typeof We=="function"&&(We==null?void 0:We([W[0]-T,W[1]],G.map(Se=>Se.map(ge=>{var et;return((et=ge.rawValue)==null?void 0:et.toString())??""}))))!==!0)return;for(const[Se,ge]of G.entries()){if(Se+ae>=Re)break;for(const[et,ht]of ge.entries()){const It=[et+we,Se+ae],[pn,Mn]=It;if(pn>=qe.length||Mn>=Nt)continue;const wn=Zt(It),Rn=x(wn,It,ht.rawValue,ht.formatted);Rn!==void 0&&Ye.push(Rn)}}}while(!1);ln(Ye),(X=jt.current)==null||X.damage(Ye.map(Se=>({cell:Se.location})))}},[_,je,Zt,P,on.paste,at,qe.length,ln,Nt,We,T,Re]);$t("paste",wi,p,!1,!0);const tr=a.useCallback(async(u,x)=>{var B,$;if(!on.copy)return;const v=x===!0||((B=at.current)==null?void 0:B.contains(document.activeElement))===!0||(($=s.current)==null?void 0:$.contains(document.activeElement))===!0,D=P.columns,I=P.rows,W=(X,G)=>{if(!de)Fl(X,G,u);else{const J=G.map(he=>({kind:U.Text,data:b[he].title,displayData:b[he].title,allowOverlay:!1}));Fl([J,...X],G,u)}};if(v&&Bt!==void 0){if(P.current!==void 0){let X=Bt(P.current.range,At.current.signal);typeof X!="object"&&(X=await X()),W(X,In(P.current.range.x-T,P.current.range.x+P.current.range.width-T))}else if(I!==void 0&&I.length>0){const G=[...I].map(J=>{const he=Bt({x:T,y:J,width:b.length,height:1},At.current.signal);return typeof he=="object"?he[0]:he().then(Q=>Q[0])});if(G.some(J=>J instanceof Promise)){const J=await Promise.all(G);W(J,In(b.length))}else W(G,In(b.length))}else if(D.length>0){const X=[],G=[];for(const J of D){let he=Bt({x:J,y:0,width:1,height:Re},At.current.signal);typeof he!="object"&&(he=await he()),X.push(he),G.push(J-T)}if(X.length===1)W(X[0],G);else{const J=X.reduce((he,Q)=>he.map((we,ae)=>[...we,...Q[ae]]));W(J,G)}}}},[b,Bt,P,on.copy,T,at,Re,de]);$t("copy",tr,p,!1,!1);const na=a.useCallback(async u=>{var v,D;if(!(!on.cut||!(((v=at.current)==null?void 0:v.contains(document.activeElement))===!0||((D=s.current)==null?void 0:D.contains(document.activeElement))===!0))&&(await tr(u),P.current!==void 0)){let I={current:{cell:P.current.cell,range:P.current.range,rangeStack:[]},rows:it.empty(),columns:it.empty()};const W=se==null?void 0:se(I);if(W===!1||(I=W===!0?I:W,I.current===void 0))return;fo(I.current.range)}},[fo,P,on.cut,tr,at,se]);$t("cut",na,p,!1,!1);const oa=a.useCallback((u,x)=>{if(ue!==void 0){T!==0&&(u=u.map(I=>[I[0]-T,I[1]])),ue(u,x);return}if(u.length===0||x===-1)return;const[v,D]=u[x];d.current!==void 0&&d.current[0]===v&&d.current[1]===D||(d.current=[v,D],qn(v,D,!1,!1))},[ue,T,qn]),[Br,zr]=((ll=gt==null?void 0:gt.current)==null?void 0:ll.cell)??[],Lr=a.useRef(Et);Lr.current=Et,a.useLayoutEffect(()=>{var u,x,v,D;pi.current&&!Kn.current&&Br!==void 0&&zr!==void 0&&(Br!==((x=(u=Y.current)==null?void 0:u.current)==null?void 0:x.cell[0])||zr!==((D=(v=Y.current)==null?void 0:v.current)==null?void 0:D.cell[1]))&&Lr.current(Br,zr),Kn.current=!1},[Br,zr]);const el=P.current!==void 0&&(P.current.cell[0]>=qe.length||P.current.cell[1]>=Nt);a.useLayoutEffect(()=>{el&&ee(Ur,!1)},[el,ee]);const ra=a.useMemo(()=>pt===!0&&(ye==null?void 0:ye.tint)===!0?it.fromSingleSelection(Nt-1):it.empty(),[Nt,pt,ye==null?void 0:ye.tint]),ia=a.useCallback(u=>typeof ze=="boolean"?ze:(ze==null?void 0:ze(u-T))??!0,[T,ze]),la=a.useMemo(()=>{if(di===void 0||s.current===null)return null;const{bounds:u,group:x}=di,v=s.current.getBoundingClientRect();return a.createElement(Yd,{bounds:u,group:x,canvasBounds:v,onClose:()=>ui(void 0),onFinish:D=>{ui(void 0),me==null||me(x,D)}})},[me,di]),sa=Math.min(qe.length,xe+(rn?1:0));a.useImperativeHandle(t,()=>({appendRow:(u,x)=>Fo(u+T,x),updateCells:u=>{var x;return T!==0&&(u=u.map(v=>({cell:[v.cell[0]+T,v.cell[1]]}))),(x=jt.current)==null?void 0:x.damage(u)},getBounds:(u,x)=>{var v;if(!((s==null?void 0:s.current)===null||(at==null?void 0:at.current)===null)){if(u===void 0&&x===void 0){const D=s.current.getBoundingClientRect(),I=D.width/at.current.clientWidth;return{x:D.x-at.current.scrollLeft*I,y:D.y-at.current.scrollTop*I,width:at.current.scrollWidth*I,height:at.current.scrollHeight*I}}return(v=jt.current)==null?void 0:v.getBounds((u??0)+T,x)}},focus:()=>{var u;return(u=jt.current)==null?void 0:u.focus()},emit:async u=>{switch(u){case"delete":er({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":er({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":er({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await tr(void 0,!0);break;case"paste":await wi();break}},scrollTo:Et,remeasureColumns:u=>{for(const x of u)Tr(x+T)}}),[Fo,Tr,at,tr,er,wi,T,Et]);const[tl,nl]=Sn??[],aa=a.useCallback(u=>{const[x,v]=u;if(v===-1){Ze!=="none"&&(Ee(it.fromSingleSelection(x),void 0,!1),Ut());return}tl===x&&nl===v||(Qe({cell:u,range:{x,y:v,width:1,height:1}},!0,!1,"keyboard-nav"),Et(x,v))},[Ze,Ut,Et,tl,nl,Qe,Ee]),[ca,da]=a.useState(!1),ol=a.useRef(Jl(u=>{da(u)},5)),ua=a.useCallback(()=>{ol.current(!0),P.current===void 0&&P.columns.length===0&&P.rows.length===0&&c===void 0&&Qe({cell:[T,Rr],range:{x:T,y:Rr,width:1,height:1}},!0,!1,"keyboard-select")},[Rr,P,c,T,Qe]),fa=a.useCallback(()=>{ol.current(!1)},[]),[ha,ga]=a.useMemo(()=>{let u;const x=(Ft==null?void 0:Ft.scrollbarWidthOverride)??Ii(),v=Re+(pt?1:0);if(typeof fn=="number")u=nt+v*fn;else{let I=0;const W=Math.min(v,10);for(let B=0;B<W;B++)I+=fn(B);I=Math.floor(I/W),u=nt+v*I}u+=x;const D=qe.reduce((I,W)=>W.width+I,0)+x;return[`${Math.min(1e5,D)}px`,`${Math.min(1e5,u)}px`]},[qe,Ft==null?void 0:Ft.scrollbarWidthOverride,fn,Re,pt,nt]),ma=a.useMemo(()=>wc(ke),[ke]);return a.createElement(yc.Provider,{value:ke},a.createElement(lu,{style:ma,className:Ie,inWidth:m??ha,inHeight:C??ga},a.createElement(Nd,{fillHandle:Rt,drawFocusRing:io,experimental:Ft,fixedShadowX:Dt,fixedShadowY:Lt,getRowThemeOverride:nn,headerIcons:Hn,imageWindowLoader:mr,initialSize:Xn,isDraggable:Tn,onDragLeave:An,onRowMoved:vn,overscrollX:oi,overscrollY:ri,preventDiagonalScrolling:bo,rightElement:Co,rightElementProps:vo,smoothScrollX:ro,smoothScrollY:Gn,className:Ie,enableGroups:Gt,onCanvasFocused:ua,onCanvasBlur:fa,canvasRef:s,onContextMenu:ta,theme:ke,cellXOffset:Os,cellYOffset:Rr,accessibilityHeight:so.height,onDragEnd:Zs,columns:qe,nonGrowWidth:hn,drawHeader:He,onColumnProposeMove:E,drawCell:Ae,disabledRows:ra,freezeColumns:sa,lockColumns:T,firstColAccessible:T===0,getCellContent:Zt,minColumnWidth:kn,maxColumnWidth:lo,searchInputRef:l,showSearch:Vo,onSearchClose:ii,highlightRegions:Ns,getCellsForSelection:Bt,getGroupDetails:ai,headerHeight:Ko,isFocused:ca,groupHeaderHeight:Gt?Sr:0,freezeTrailingRows:mt+(pt&&(ye==null?void 0:ye.sticky)===!0?1:0),hasAppendRow:pt,onColumnResize:oe,onColumnResizeEnd:q,onColumnResizeStart:ie,onCellFocused:aa,onColumnMoved:js,onDragStart:qs,onHeaderMenuClick:_s,onHeaderIndicatorClick:Ks,onItemHovered:mi,isFilling:(c==null?void 0:c.fillHandle)===!0,onMouseMove:Ys,onKeyDown:er,onKeyUp:ot,onMouseDown:Xs,onMouseUp:Us,onDragOverCell:Mt,onDrop:ft,onSearchResultsChanged:oa,onVisibleRegionChanged:Vs,clientSize:Xe,rowHeight:fn,searchResults:V,searchValue:Ce,onSearchValueChange:ve,rows:Nt,scrollRef:at,selection:P,translateX:so.tx,translateY:so.ty,verticalBorder:ia,gridRef:jt,getCellRenderer:je,resizeIndicator:ni}),la,r!==void 0&&a.createElement(a.Suspense,{fallback:null},a.createElement(wu,{...r,validateCell:S,bloom:O,id:ea,getCellRenderer:je,className:(Ft==null?void 0:Ft.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:un,imageEditorOverride:w,onFinishEditing:Qs,markdownDivCreateNode:h,isOutsideClick:Un}))))},vu=a.forwardRef(Cu),As=20;function Tl(e){const{cell:t,posX:n,posY:o,bounds:r,theme:i}=e,{width:l,height:s,x:c,y:f}=r,d=t.maxSize??As,p=Math.floor(r.y+s/2),w=os(d,s,i.cellVerticalPadding),g=ns(t.contentAlign??"center",c,l,i.cellHorizontalPadding,w),h=ts(g,p,w),m=rs(c+n,f+o,h);return zi(t)&&m}const xu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??"false"},kind:U.Boolean,needsHover:!0,useLabel:!1,needsHoverPosition:!0,measure:()=>50,draw:e=>ku(e,e.cell.data,zi(e.cell),e.cell.maxSize??As,e.cell.hoverEffectIntensity??.35),onDelete:e=>({...e,data:!1}),onSelect:e=>{Tl(e)&&e.preventDefault()},onClick:e=>{if(Tl(e))return{...e.cell,data:Ds(e.cell.data)}},onPaste:(e,t)=>{let n=_r;return e.toLowerCase()==="true"?n=!0:e.toLowerCase()==="false"?n=!1:e.toLowerCase()==="indeterminate"&&(n=Bi),n===t.data?void 0:{...t,data:n}}};function ku(e,t,n,o,r){if(!n&&t===_r)return;const{ctx:i,hoverAmount:l,theme:s,rect:c,highlighted:f,hoverX:d,hoverY:p,cell:{contentAlign:w}}=e,{x:g,y:h,width:m,height:C}=c;let b=!1;if(r>0){let y=n?1-r+r*l:.4;if(t===_r&&(y*=l),y===0)return;y<1&&(b=!0,i.globalAlpha=y)}Ni(i,s,t,g,h,m,C,f,d,p,o,w),b&&(i.globalAlpha=1)}const Su=Wt("div")({name:"BubblesOverlayEditorStyle",class:"gdg-b1ygi5by",propsAsIs:!1}),Mu=e=>{const{bubbles:t}=e;return a.createElement(Su,null,t.map((n,o)=>a.createElement("div",{key:o,className:"boe-bubble"},n)),a.createElement("textarea",{className:"gdg-input",autoFocus:!0}))},Ru=Mu,Eu={getAccessibilityString:e=>is(e.data),kind:U.Bubble,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,r)=>e.measureText(r).width+o+20,0)+2*n.cellHorizontalPadding-4,draw:e=>Fu(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return a.createElement(Ru,{bubbles:t.data})},onPaste:()=>{}},Iu=4;function Fu(e,t){const{rect:n,theme:o,ctx:r,highlighted:i}=e,{x:l,y:s,width:c,height:f}=n,d=20,p=8,w=Iu;let g=l+o.cellHorizontalPadding;const h=[];for(const m of t){if(g>l+c)break;const C=Oo(m,r,o.baseFontFull).width;h.push({x:g,width:C}),g+=C+p*2+w}r.beginPath();for(const m of h)Fn(r,m.x,s+(f-d)/2,m.width+p*2,d,o.roundingRadius??d/2);r.fillStyle=i?o.bgBubbleSelected:o.bgBubble,r.fill();for(const[m,C]of h.entries())r.beginPath(),r.fillStyle=o.textBubble,r.fillText(t[m],C.x+p,s+f/2+to(r,o))}const Du=Wt("div")({name:"DrilldownOverlayEditorStyle",class:"gdg-d4zsq0x",propsAsIs:!1}),Hu=e=>{const{drilldowns:t}=e;return a.createElement(Du,null,t.map((n,o)=>a.createElement("div",{key:o,className:"doe-bubble"},n.img!==void 0&&a.createElement("img",{src:n.img}),a.createElement("div",null,n.text))))},Tu=Hu,Au={getAccessibilityString:e=>is(e.data.map(t=>t.text)),kind:U.Drilldown,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,r)=>e.measureText(r.text).width+o+20+(r.img!==void 0?18:0),0)+2*n.cellHorizontalPadding-4,draw:e=>Lu(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return a.createElement(Tu,{drilldowns:t.data})},onPaste:()=>{}},Bu=4,ki={};function zu(e,t,n,o){const r=Math.ceil(window.devicePixelRatio),i=5,l=n-i*2,s=4,c=n*r,f=o+i,d=o*3,p=(d+i*2)*r,w=`${e},${t},${r},${n}`;if(ki[w]!==void 0)return{el:ki[w],height:c,width:p,middleWidth:s*r,sideWidth:f*r,padding:i*r,dpr:r};const g=document.createElement("canvas"),h=g.getContext("2d");return h===null?null:(g.width=p,g.height=c,h.scale(r,r),ki[w]=g,h.beginPath(),Fn(h,i,i,d,l,o),h.shadowColor="rgba(24, 25, 34, 0.4)",h.shadowBlur=1,h.fillStyle=e,h.fill(),h.shadowColor="rgba(24, 25, 34, 0.3)",h.shadowOffsetY=1,h.shadowBlur=5,h.fillStyle=e,h.fill(),h.shadowOffsetY=0,h.shadowBlur=0,h.shadowBlur=0,h.beginPath(),Fn(h,i+.5,i+.5,d,l,o),h.strokeStyle=t,h.lineWidth=1,h.stroke(),{el:g,height:c,width:p,sideWidth:f*r,middleWidth:o*r,padding:i*r,dpr:r})}function Lu(e,t){const{rect:n,theme:o,ctx:r,imageLoader:i,col:l,row:s}=e,{x:c,width:f}=n,d=o.baseFontFull,p=fs(r,d),w=Math.min(n.height,Math.max(16,Math.ceil(p*o.lineHeight)*2)),g=Math.floor(n.y+(n.height-w)/2),h=w-10,m=8,C=Bu;let b=c+o.cellHorizontalPadding;const y=o.roundingRadius??6,k=zu(o.bgCell,o.drilldownBorder,w,y),z=[];for(const L of t){if(b>c+f)break;const A=Oo(L.text,r,d).width;let _=0;L.img!==void 0&&i.loadOrGetImage(L.img,l,s)!==void 0&&(_=h-8+4);const M=A+_+m*2;z.push({x:b,width:M}),b+=M+C}if(k!==null){const{el:L,height:H,middleWidth:A,sideWidth:_,width:M,dpr:N,padding:O}=k,F=_/N,E=O/N;for(const R of z){const ce=Math.floor(R.x),te=Math.floor(R.width),le=te-(F-E)*2;r.imageSmoothingEnabled=!1,r.drawImage(L,0,0,_,H,ce-E,g,F,w),le>0&&r.drawImage(L,_,0,A,H,ce+(F-E),g,le,w),r.drawImage(L,M-_,0,_,H,ce+te-(F-E),g,F,w),r.imageSmoothingEnabled=!0}}r.beginPath();for(const[L,H]of z.entries()){const A=t[L];let _=H.x+m;if(A.img!==void 0){const M=i.loadOrGetImage(A.img,l,s);if(M!==void 0){const N=h-8;let O=0,F=0,E=M.width,R=M.height;E>R?(O+=(E-R)/2,E=R):R>E&&(F+=(R-E)/2,R=E),r.beginPath(),Fn(r,_,g+w/2-N/2,N,N,o.roundingRadius??3),r.save(),r.clip(),r.drawImage(M,O,F,E,R,_,g+w/2-N/2,N,N),r.restore(),_+=N+4}}r.beginPath(),r.fillStyle=o.textBubble,r.fillText(A.text,_,g+w/2+to(r,o))}}const Pu={getAccessibilityString:e=>e.data.join(", "),kind:U.Image,needsHover:!1,useLabel:!1,needsHoverPosition:!1,draw:e=>$u(e,e.cell.displayData??e.cell.data,e.cell.rounding??e.theme.roundingRadius??4,e.cell.contentAlign),measure:(e,t)=>t.data.length*50,onDelete:e=>({...e,data:[]}),provideEditor:()=>e=>{const{value:t,onFinishedEditing:n,imageEditorOverride:o}=e,r=o??ja;return a.createElement(r,{urls:t.data,canWrite:t.readonly!==!0,onCancel:n,onChange:i=>{n({...t,data:[i]})}})},onPaste:(e,t)=>{e=e.trim();const o=e.split(",").map(r=>{try{return new URL(r),r}catch{return}}).filter(r=>r!==void 0);if(!(o.length===t.data.length&&o.every((r,i)=>r===t.data[i])))return{...t,data:o}}},Si=4;function $u(e,t,n,o){const{rect:r,col:i,row:l,theme:s,ctx:c,imageLoader:f}=e,{x:d,y:p,height:w,width:g}=r,h=w-s.cellVerticalPadding*2,m=[];let C=0;for(let y=0;y<t.length;y++){const k=t[y];if(k.length===0)continue;const z=f.loadOrGetImage(k,i,l);if(z!==void 0){m[y]=z;const L=z.width*(h/z.height);C+=L+Si}}if(C===0)return;C-=Si;let b=d+s.cellHorizontalPadding;o==="right"?b=Math.floor(d+g-s.cellHorizontalPadding-C):o==="center"&&(b=Math.floor(d+g/2-C/2));for(const y of m){if(y===void 0)continue;const k=y.width*(h/y.height);n>0&&(c.beginPath(),Fn(c,b,p+s.cellVerticalPadding,k,h,n),c.save(),c.clip()),c.drawImage(y,b,p+s.cellVerticalPadding,k,h),n>0&&c.restore(),b+=k+Si}}function Wu(e,t){let n=e*49632+t*325176;return n^=n<<13,n^=n>>17,n^=n<<5,n/4294967295*2}const Ou={getAccessibilityString:()=>"",kind:U.Loading,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:()=>120,draw:e=>{const{cell:t,col:n,row:o,ctx:r,rect:i,theme:l}=e;if(t.skeletonWidth===void 0||t.skeletonWidth===0)return;let s=t.skeletonWidth;t.skeletonWidthVariability!==void 0&&t.skeletonWidthVariability>0&&(s+=Math.round(Wu(n,o)*t.skeletonWidthVariability));const c=l.cellHorizontalPadding;s+c*2>=i.width&&(s=i.width-c*2-1);const f=t.skeletonHeight??Math.min(18,i.height-2*l.cellVerticalPadding);Fn(r,i.x+c,i.y+(i.height-f)/2,s,f,l.roundingRadius??3),r.fillStyle=wo(l.textDark,.1),r.fill()},onPaste:()=>{}},Nu=()=>e=>e.targetWidth,Al=Wt("div")({name:"MarkdownOverlayEditorStyle",class:"gdg-m1pnx84e",propsAsIs:!1,vars:{"m1pnx84e-0":[Nu(),"px"]}}),Xu=e=>{const{value:t,onChange:n,forceEditMode:o,createNode:r,targetRect:i,onFinish:l,validatedSelection:s}=e,c=t.data,f=t.readonly===!0,[d,p]=a.useState(c===""||o),w=a.useCallback(()=>{p(h=>!h)},[]),g=c?"gdg-ml-6":"";return d?a.createElement(Al,{targetWidth:i.width-20},a.createElement(Jr,{autoFocus:!0,highlight:!1,validatedSelection:s,value:c,onKeyDown:h=>{h.key==="Enter"&&h.stopPropagation()},onChange:n}),a.createElement("div",{className:`gdg-edit-icon gdg-checkmark-hover ${g}`,onClick:()=>l(t)},a.createElement(Xa,null))):a.createElement(Al,{targetWidth:i.width},a.createElement(Za,{contents:c,createNode:r}),!f&&a.createElement(a.Fragment,null,a.createElement("div",{className:"spacer"}),a.createElement("div",{className:`gdg-edit-icon gdg-edit-hover ${g}`,onClick:w},a.createElement(Li,null))),a.createElement("textarea",{className:"gdg-md-edit-textarea gdg-input",autoFocus:!0}))},Gu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:U.Markdown,needsHover:!1,needsHoverPosition:!1,drawPrep:gr,measure:(e,t,n)=>{const o=t.data.split(`
`)[0];return e.measureText(o).width+2*n.cellHorizontalPadding},draw:e=>$n(e,e.cell.data,e.cell.contentAlign),onDelete:e=>({...e,data:""}),provideEditor:()=>e=>{const{onChange:t,value:n,target:o,onFinishedEditing:r,markdownDivCreateNode:i,forceEditMode:l,validatedSelection:s}=e;return a.createElement(Xu,{onFinish:r,targetRect:o,value:n,validatedSelection:s,onChange:c=>t({...n,data:c.target.value}),forceEditMode:l,createNode:i})},onPaste:(e,t)=>e===t.data?void 0:{...t,data:e}},Uu={getAccessibilityString:e=>e.row.toString(),kind:dn.Marker,needsHover:!0,needsHoverPosition:!1,drawPrep:Yu,measure:()=>44,draw:e=>Ku(e,e.cell.row,e.cell.checked,e.cell.markerKind,e.cell.drawHandle,e.cell.checkboxStyle),onClick:e=>{const{bounds:t,cell:n,posX:o,posY:r}=e,{width:i,height:l}=t,s=n.drawHandle?7+(i-7)/2:i/2,c=l/2;if(Math.abs(o-s)<=10&&Math.abs(r-c)<=10)return{...n,checked:!n.checked}},onPaste:()=>{}};function Yu(e,t){const{ctx:n,theme:o}=e,r=o.markerFontFull,i=t??{};return(i==null?void 0:i.font)!==r&&(n.font=r,i.font=r),i.deprep=_u,n.textAlign="center",i}function _u(e){const{ctx:t}=e;t.textAlign="start"}function Ku(e,t,n,o,r,i){const{ctx:l,rect:s,hoverAmount:c,theme:f}=e,{x:d,y:p,width:w,height:g}=s,h=n?1:o==="checkbox-visible"?.6+.4*c:c;if(o!=="number"&&h>0){l.globalAlpha=h;const m=7*(n?c:1);if(Ni(l,f,n,r?d+m:d,p,r?w-m:w,g,!0,void 0,void 0,18,"center",i),r){l.globalAlpha=c,l.beginPath();for(const C of[3,6])for(const b of[-5,-1,3])l.rect(d+C,p+g/2+b,2,2);l.fillStyle=f.textLight,l.fill(),l.beginPath()}l.globalAlpha=1}if(o==="number"||o==="both"&&!n){const m=t.toString(),C=f.markerFontFull,b=d+w/2;o==="both"&&c!==0&&(l.globalAlpha=1-c),l.fillStyle=f.textLight,l.font=C,l.fillText(m,b,p+g/2+to(l,C)),c!==0&&(l.globalAlpha=1)}}const Vu={getAccessibilityString:()=>"",kind:dn.NewRow,needsHover:!0,needsHoverPosition:!1,measure:()=>200,draw:e=>ju(e,e.cell.hint,e.cell.icon),onPaste:()=>{}};function ju(e,t,n){const{ctx:o,rect:r,hoverAmount:i,theme:l,spriteManager:s}=e,{x:c,y:f,width:d,height:p}=r;o.beginPath(),o.globalAlpha=i,o.rect(c+1,f+1,d,p-2),o.fillStyle=l.bgHeaderHovered,o.fill(),o.globalAlpha=1,o.beginPath();const w=t!=="";let g=0;if(n!==void 0){const m=p-8,C=c+8/2,b=f+8/2;s.drawSprite(n,"normal",o,C,b,m,l,w?1:i),g=m}else{g=24;const h=12,m=w?h:i*h,C=w?0:(1-i)*h*.5,b=l.cellHorizontalPadding+4;m>0&&(o.moveTo(c+b+C,f+p/2),o.lineTo(c+b+C+m,f+p/2),o.moveTo(c+b+C+m*.5,f+p/2-m*.5),o.lineTo(c+b+C+m*.5,f+p/2+m*.5),o.lineWidth=2,o.strokeStyle=l.bgIconHeader,o.lineCap="round",o.stroke())}o.fillStyle=l.textMedium,o.fillText(t,g+c+l.cellHorizontalPadding+.5,f+p/2+to(o,l)),o.beginPath()}function Bs(e,t,n,o,r,i,l){e.textBaseline="alphabetic";const s=qu(e,r,o,t,(n==null?void 0:n.fullSize)??!1);e.beginPath(),Fn(e,s.x,s.y,s.width,s.height,t.roundingRadius??4),e.globalAlpha=i,e.fillStyle=(n==null?void 0:n.bgColor)??wo(t.textDark,.1),e.fill(),e.globalAlpha=1,e.fillStyle=t.textDark,e.textBaseline="middle",l==null||l("text")}function qu(e,t,n,o,r){const i=o.cellHorizontalPadding,l=o.cellVerticalPadding;if(r)return{x:t.x+i/2,y:t.y+l/2+1,width:t.width-i,height:t.height-l-1};const s=Oo(n,e,o.baseFontFull,"alphabetic"),c=t.height-l,f=Math.min(c,s.actualBoundingBoxAscent*2.5);return{x:t.x+i/2,y:t.y+(t.height-f)/2+1,width:s.width+i*3,height:f-1}}const Zu=a.lazy(async()=>await Ql(()=>import("./number-overlay-editor-kjHXBjr2.js"),__vite__mapDeps([10,1,3,11]),import.meta.url)),Ju={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:U.Number,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,useLabel:!0,drawPrep:gr,draw:e=>{const{hoverAmount:t,cell:n,ctx:o,theme:r,rect:i,overrideCursor:l}=e,{hoverEffect:s,displayData:c,hoverEffectTheme:f}=n;s===!0&&t>0&&Bs(o,r,f,c,i,t,l),$n(e,e.cell.displayData,e.cell.contentAlign)},measure:(e,t,n)=>e.measureText(t.displayData).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:void 0}),provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:r}=e;return a.createElement(a.Suspense,{fallback:null},a.createElement(Zu,{highlight:t,disabled:o.readonly===!0,value:o.data,fixedDecimals:o.fixedDecimals,allowNegative:o.allowNegative,thousandSeparator:o.thousandSeparator,decimalSeparator:o.decimalSeparator,validatedSelection:r,onChange:i=>n({...o,data:Number.isNaN(i.floatValue??0)?0:i.floatValue})}))},onPaste:(e,t,n)=>{const o=typeof n.rawValue=="number"?n.rawValue:Number.parseFloat(typeof n.rawValue=="string"?n.rawValue:e);if(!(Number.isNaN(o)||t.data===o))return{...t,data:o,displayData:n.formattedString??t.displayData}}},Qu={getAccessibilityString:()=>"",measure:()=>108,kind:U.Protected,needsHover:!1,needsHoverPosition:!1,draw:ef,onPaste:()=>{}};function ef(e){const{ctx:t,theme:n,rect:o}=e,{x:r,y:i,height:l}=o;t.beginPath();const s=2.5;let c=r+n.cellHorizontalPadding+s;const f=i+l/2,d=Math.cos(ul(30))*s,p=Math.sin(ul(30))*s;for(let w=0;w<12;w++)t.moveTo(c,f-s),t.lineTo(c,f+s),t.moveTo(c+d,f-p),t.lineTo(c-d,f+p),t.moveTo(c-d,f-p),t.lineTo(c+d,f+p),c+=8;t.lineWidth=1.1,t.lineCap="square",t.strokeStyle=n.textLight,t.stroke()}const tf={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:U.RowID,needsHover:!1,needsHoverPosition:!1,drawPrep:(e,t)=>gr(e,t,e.theme.textLight),draw:e=>$n(e,e.cell.data,e.cell.contentAlign),measure:(e,t,n)=>e.measureText(t.data).width+n.cellHorizontalPadding*2,provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:r}=e;return lt.createElement(Jr,{highlight:t,autoFocus:o.readonly!==!0,disabled:o.readonly!==!1,value:o.data,validatedSelection:r,onChange:i=>n({...o,data:i.target.value})})},onPaste:()=>{}},nf={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:U.Text,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,drawPrep:gr,useLabel:!0,draw:e=>{const{cell:t,hoverAmount:n,hyperWrapping:o,ctx:r,rect:i,theme:l,overrideCursor:s}=e,{displayData:c,contentAlign:f,hoverEffect:d,allowWrapping:p,hoverEffectTheme:w}=t;d===!0&&n>0&&Bs(r,l,w,c,i,n,s),$n(e,c,f,p,o)},measure:(e,t,n)=>{const o=t.displayData.split(`
`,t.allowWrapping===!0?void 0:1);let r=0;for(const i of o)r=Math.max(r,e.measureText(i).width);return r+2*n.cellHorizontalPadding},onDelete:e=>({...e,data:""}),provideEditor:e=>({disablePadding:e.allowWrapping===!0,editor:t=>{const{isHighlighted:n,onChange:o,value:r,validatedSelection:i}=t;return a.createElement(Jr,{style:e.allowWrapping===!0?{padding:"3px 8.5px"}:void 0,highlight:n,autoFocus:r.readonly!==!0,disabled:r.readonly===!0,altNewline:!0,value:r.data,validatedSelection:i,onChange:l=>o({...r,data:l.target.value})})}}),onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},of=Wt("div")({name:"UriOverlayEditorStyle",class:"gdg-u1rrojo",propsAsIs:!1}),rf=e=>{const{uri:t,onChange:n,forceEditMode:o,readonly:r,validatedSelection:i,preview:l}=e,[s,c]=a.useState(!r&&(t===""||o)),f=a.useCallback(()=>{c(!0)},[]);return s?a.createElement(Jr,{validatedSelection:i,highlight:!0,autoFocus:!0,value:t,onChange:n}):a.createElement(of,null,a.createElement("a",{className:"gdg-link-area",href:t,target:"_blank",rel:"noopener noreferrer"},l),!r&&a.createElement("div",{className:"gdg-edit-icon",onClick:f},a.createElement(Li,null)),a.createElement("textarea",{className:"gdg-input",autoFocus:!0}))},lf=rf;function zs(e,t,n,o){let r=n.cellHorizontalPadding;const i=t.height/2-e.actualBoundingBoxAscent/2,l=e.width,s=e.actualBoundingBoxAscent;return o==="right"?r=t.width-l-n.cellHorizontalPadding:o==="center"&&(r=t.width/2-l/2),{x:r,y:i,width:l,height:s}}function Bl(e){const{cell:t,bounds:n,posX:o,posY:r,theme:i}=e,l=t.displayData??t.data;if(t.hoverEffect!==!0||t.onClickUri===void 0)return!1;const s=ds(l,i.baseFontFull);if(s===void 0)return!1;const c=zs(s,n,i,t.contentAlign);return po({x:c.x-4,y:c.y-4,width:c.width+8,height:c.height+8},o,r)}const sf={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:U.Uri,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!0,useLabel:!0,drawPrep:gr,draw:e=>{const{cell:t,theme:n,overrideCursor:o,hoverX:r,hoverY:i,rect:l,ctx:s}=e,c=t.displayData??t.data,f=t.hoverEffect===!0;if(o!==void 0&&f&&r!==void 0&&i!==void 0){const d=Oo(c,s,n.baseFontFull),p=zs(d,l,n,t.contentAlign),{x:w,y:g,width:h,height:m}=p;if(r>=w-4&&r<=w-4+h+8&&i>=g-4&&i<=g-4+m+8){const C=to(s,n.baseFontFull);o("pointer");const b=5,y=g-C;s.beginPath(),s.moveTo(l.x+w,Math.floor(l.y+y+m+b)+.5),s.lineTo(l.x+w+h,Math.floor(l.y+y+m+b)+.5),s.strokeStyle=n.linkColor,s.stroke(),s.save(),s.fillStyle=e.cellFillColor,$n({...e,rect:{...l,x:l.x-1}},c,t.contentAlign),$n({...e,rect:{...l,x:l.x-2}},c,t.contentAlign),$n({...e,rect:{...l,x:l.x+1}},c,t.contentAlign),$n({...e,rect:{...l,x:l.x+2}},c,t.contentAlign),s.restore()}}s.fillStyle=f?n.linkColor:n.textDark,$n(e,c,t.contentAlign)},onSelect:e=>{Bl(e)&&e.preventDefault()},onClick:e=>{var o;const{cell:t}=e;Bl(e)&&((o=t.onClickUri)==null||o.call(t,e))},measure:(e,t,n)=>e.measureText(t.displayData??t.data).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:""}),provideEditor:e=>t=>{const{onChange:n,value:o,forceEditMode:r,validatedSelection:i}=t;return a.createElement(lf,{forceEditMode:o.readonly!==!0&&(r||e.hoverEffect===!0&&e.onClickUri!==void 0),uri:o.data,preview:o.displayData??o.data,validatedSelection:i,readonly:o.readonly===!0,onChange:l=>n({...o,data:l.target.value})})},onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},af=[Uu,Vu,xu,Eu,Au,Pu,Ou,Gu,Ju,Qu,tf,nf,sf],Mi=[];class cf extends gs{constructor(){super(...arguments);Oe(this,"imageLoaded",()=>{});Oe(this,"loadedLocations",[]);Oe(this,"cache",{});Oe(this,"sendLoaded",Aa(()=>{this.imageLoaded(new cr(this.loadedLocations)),this.loadedLocations=[]},20));Oe(this,"clearOutOfWindow",()=>{const n=Object.keys(this.cache);for(const o of n){const r=this.cache[o];let i=!1;for(let l=0;l<r.cells.length;l++){const s=r.cells[l];if(this.isInWindow(s)){i=!0;break}}i?r.cells=r.cells.filter(this.isInWindow):(r.cancel(),delete this.cache[o])}})}setCallback(n){this.imageLoaded=n}loadImage(n,o,r,i){let l=!1;const s=Mi.pop()??new Image;let c=!1;const f={img:void 0,cells:[yn(o,r)],url:n,cancel:()=>{c||(c=!0,Mi.length<12?Mi.unshift(s):l||(s.src=""))}},d=new Promise(p=>s.addEventListener("load",()=>p(null)));requestAnimationFrame(async()=>{try{s.src=n,await d,await s.decode();const p=this.cache[i];if(p!==void 0&&!c){p.img=s;for(const w of p.cells)this.loadedLocations.push(Oi(w));l=!0,this.sendLoaded()}}catch{f.cancel()}}),this.cache[i]=f}loadOrGetImage(n,o,r){const i=n,l=this.cache[i];if(l!==void 0){const s=yn(o,r);return l.cells.includes(s)||l.cells.push(s),l.img}else this.loadImage(n,o,r,i)}}const df=cf,uf=(e,t)=>{const n=a.useMemo(()=>({...jc,...e.headerIcons}),[e.headerIcons]),o=a.useMemo(()=>e.imageWindowLoader??new df,[e.imageWindowLoader]);return a.createElement(vu,{...e,renderers:af,headerIcons:n,ref:t,imageWindowLoader:o})},Ls=a.forwardRef(uf);function ff(e){const[t,n]=lt.useState([]),[o,r]=lt.useState(void 0),{columns:i,onGroupHeaderClicked:l,onGridSelectionChange:s,getGroupDetails:c,gridSelection:f,freezeColumns:d=0,theme:p}=e,w=f??o,g=lt.useMemo(()=>{const y=[];let k=[-1,-1],z;for(let L=d;L<i.length;L++){const A=i[L].group??"",_=t.includes(A);z!==A&&k[0]!==-1&&(y.push(k),k=[-1,-1]),_&&k[0]!==-1?k[1]+=1:_?k=[L,1]:k[0]!==-1&&(y.push(k),k=[-1,-1]),z=A}return k[0]!==-1&&y.push(k),y},[t,i,d]),h=lt.useMemo(()=>g.length===0?i:i.map((y,k)=>{for(const[z,L]of g)if(k>=z&&k<z+L){let H=8;return k===z+L-1&&(H=36),{...y,width:H,themeOverride:{bgCell:p.bgCellMedium}}}return y}),[i,g,p.bgCellMedium]),m=lt.useCallback((y,k)=>{var L;l==null||l(y,k);const z=((L=h[y])==null?void 0:L.group)??"";z!==""&&(k.preventDefault(),n(H=>H.includes(z)?H.filter(A=>A!==z):[...H,z]))},[h,l]),C=lt.useCallback(y=>{if(y.current!==void 0){const k=y.current.cell[0],z=h[k];n(L=>L.includes((z==null?void 0:z.group)??"")?L.filter(H=>H!==z.group):L)}s!==void 0?s(y):r(y)},[h,s]),b=lt.useCallback(y=>({...c==null?void 0:c(y),name:y,overrideTheme:t.includes(y??"")?{bgHeader:p.bgHeaderHasFocus}:void 0}),[t,c,p.bgHeaderHasFocus]);return{columns:h,onGroupHeaderClicked:m,onGridSelectionChange:C,getGroupDetails:b,gridSelection:w}}var hf=Ba,gf=va;function mf(e,t){var n=-1,o=gf(e)?Array(e.length):[];return hf(e,function(r,i,l){o[++n]=t(r,i,l)}),o}var pf=mf;function wf(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}var yf=wf,zl=xa;function bf(e,t){if(e!==t){var n=e!==void 0,o=e===null,r=e===e,i=zl(e),l=t!==void 0,s=t===null,c=t===t,f=zl(t);if(!s&&!f&&!i&&e>t||i&&l&&c&&!s&&!f||o&&l&&c||!n&&c||!r)return 1;if(!o&&!i&&!f&&e<t||f&&n&&r&&!o&&!i||s&&n&&r||!l&&r||!c)return-1}return 0}var Cf=bf,vf=Cf;function xf(e,t,n){for(var o=-1,r=e.criteria,i=t.criteria,l=r.length,s=n.length;++o<l;){var c=vf(r[o],i[o]);if(c){if(o>=s)return c;var f=n[o];return c*(f=="desc"?-1:1)}}return e.index-t.index}var kf=xf,Ri=ka,Sf=Ma,Mf=Ea,Rf=pf,Ef=yf,If=Ra,Ff=kf,Df=Sa,Hf=Zl;function Tf(e,t,n){t.length?t=Ri(t,function(i){return Hf(i)?function(l){return Sf(l,i.length===1?i[0]:i)}:i}):t=[Df];var o=-1;t=Ri(t,If(Mf));var r=Rf(e,function(i,l,s){var c=Ri(t,function(f){return f(i)});return{criteria:c,index:++o,value:i}});return Ef(r,function(i,l){return Ff(i,l,n)})}var Af=Tf,Bf=Af,Ll=Zl;function zf(e,t,n,o){return e==null?[]:(Ll(t)||(t=t==null?[]:[t]),n=o?void 0:n,Ll(n)||(n=n==null?[]:[n]),Bf(e,t,n))}var Lf=zf;const Pl=ba(Lf);function dr(e){return e.id??`${e.group??""}/${e.title}`}function $l(e,t){return typeof t=="string"?dr(e)===t:dr(e)===dr(t)}function Wl(e,t,n){const o=t.indexOf(e);if(o===-1)return Number.MAX_SAFE_INTEGER;const r=n.findIndex(i=>$l(e,i));if(r!==-1)return r;for(let i=o;i>=0;i--){const l=n.findIndex(s=>$l(t[i],s));if(l!==-1)return l+.5}return-1}function Pf(e){const{columns:t,getCellContent:n,onColumnMoved:o}=e,[r,i]=a.useState(()=>t.map(dr)),l=a.useMemo(()=>Pl(t,d=>Wl(d,t,r)),[r,t]),s=a.useRef(o);s.current=o;const c=a.useCallback((d,p)=>{var w;i(g=>{const h=[...g],[m]=h.splice(d,1);return h.splice(p,0,m),h}),(w=s.current)==null||w.call(s,d,p)},[]);a.useEffect(()=>{i(d=>Pl(t,p=>Wl(p,t,d)).map(dr))},[t]);const f=a.useCallback(d=>{const[p,w]=d,g=l[p],h=t.indexOf(g);return n([h,w])},[l,t,n]);return{columns:l,onColumnMoved:c,getCellContent:f}}function $f(e){var t,n;switch(e.kind){case U.Number:return((t=e.data)==null?void 0:t.toString())??"";case U.Boolean:return((n=e.data)==null?void 0:n.toString())??"";case U.Markdown:case U.RowID:case U.Text:case U.Uri:return e.data??"";case U.Bubble:case U.Image:return e.data.join("");case U.Drilldown:return e.data.map(o=>o.text).join("");case U.Protected:case U.Loading:return"";case U.Custom:return e.copyData}}function Ol(e){if(typeof e=="number")return e;if(e.length>0){const t=Number(e);isNaN(t)||(e=t)}return e}function Wf(e,t){return e=Ol(e),t=Ol(t),typeof e=="string"&&typeof t=="string"?e.localeCompare(t):typeof e=="number"&&typeof t=="number"?e===t?0:e>t?1:-1:e==t?0:e>t?1:-1}function Of(e,t){return e>t?1:e===t?0:-1}function Nf(e){const{sort:t,rows:n,getCellContent:o}=e;let r=t===void 0?void 0:e.columns.findIndex(f=>t.column===f||f.id!==void 0&&t.column.id===f.id);r===-1&&(r=void 0);const i=(t==null?void 0:t.direction)??"asc",l=a.useMemo(()=>{if(r===void 0)return;const f=new Array(n),d=[r,0];for(let w=0;w<n;w++)d[1]=w,f[w]=$f(o(d));let p;return(t==null?void 0:t.mode)==="raw"?p=In(n).sort((w,g)=>Of(f[w],f[g])):(t==null?void 0:t.mode)==="smart"?p=In(n).sort((w,g)=>Wf(f[w],f[g])):p=In(n).sort((w,g)=>f[w].localeCompare(f[g])),i==="desc"&&p.reverse(),p},[o,n,t==null?void 0:t.mode,i,r]),s=a.useCallback(f=>l===void 0?f:l[f],[l]),c=a.useCallback(([f,d])=>l===void 0?o([f,d]):(d=l[d],o([f,d])),[o,l]);return l===void 0?{getCellContent:e.getCellContent,getOriginalIndex:s}:{getOriginalIndex:s,getCellContent:c}}const Xf={undoHistory:[],redoHistory:[],canUndo:!1,canRedo:!1,isApplyingUndo:!1,isApplyingRedo:!1};function Gf(e,t){const n={...e};switch(t.type){case"undo":if(e.canUndo){n.undoHistory=[...e.undoHistory];const o=n.undoHistory.pop();return n.operation=o,n.canUndo=n.undoHistory.length>0,n.isApplyingUndo=!0,n}return e;case"redo":if(e.canRedo){n.redoHistory=[...e.redoHistory];const o=n.redoHistory.pop();return n.operation=o,n.canRedo=n.redoHistory.length>0,n.isApplyingRedo=!0,n}return e;case"operationApplied":return n.operation=void 0,n.isApplyingRedo=!1,n.isApplyingUndo=!1,n;case"edit":return!e.isApplyingRedo&&!e.isApplyingUndo&&(n.undoHistory=[...e.undoHistory,t.batch],n.redoHistory=[],n.canUndo=!0,n.canRedo=!1),e.isApplyingUndo&&(n.redoHistory=[...e.redoHistory,t.batch],n.canRedo=!0),e.isApplyingRedo&&(n.undoHistory=[...e.undoHistory,t.batch],n.canUndo=!0),n;default:throw new Error("Invalid action")}}function Uf(e,t,n,o){const[r,i]=a.useReducer(Gf,Xf),l=a.useRef(null),s=a.useRef(null),c=a.useRef(!1),f=a.useRef(!1);a.useEffect(()=>{c.current=r.isApplyingUndo,f.current=r.isApplyingRedo},[r.isApplyingUndo,r.isApplyingRedo]);const[d,p]=a.useState(null),w=a.useRef(null),g=a.useCallback(b=>{o&&o(b),p(b),w.current=b},[o]),h=a.useCallback((b,y)=>{if(!(c.current||f.current)&&w.current){clearTimeout(s.current);const z=t(b);l.current===null&&(l.current={edits:[],selection:w.current}),l.current.edits.push({cell:b,newValue:z}),s.current=setTimeout(()=>{l.current&&(i({type:"edit",batch:l.current}),l.current=null)},0)}n(b,y)},[n,t]),m=a.useCallback(()=>{i({type:"undo"})},[i]),C=a.useCallback(()=>{i({type:"redo"})},[i]);return a.useEffect(()=>{if(r.operation&&w.current&&e.current){const b=[],y={edits:[],selection:w.current};for(const k of r.operation.edits){const z=t(k.cell);y.edits.push({cell:k.cell,newValue:z}),n(k.cell,k.newValue),b.push({cell:k.cell})}p(r.operation.selection),w.current=r.operation.selection,e.current.updateCells(b),i({type:"edit",batch:y}),i({type:"operationApplied"})}},[r.operation,e,n,p,t]),a.useEffect(()=>{const b=y=>{y.key==="z"&&(y.metaKey||y.ctrlKey)&&(y.shiftKey?C():m()),y.key==="y"&&(y.metaKey||y.ctrlKey)&&C()};return window.addEventListener("keydown",b),()=>{window.removeEventListener("keydown",b)}},[m,C]),a.useMemo(()=>({undo:m,redo:C,canUndo:r.canUndo,canRedo:r.canRedo,onCellEdited:h,onGridSelectionChange:g,gridSelection:d}),[m,C,h,r.canUndo,r.canRedo,g,d])}En.seed(1337);function Yf(e){return!!e}function _f(e,t){var o;const n=e.data;if(typeof n==typeof t.data)return{...t,data:n};switch(t.kind){case U.Uri:return Wr(n)?{...t,data:n[0]}:{...t,data:(n==null?void 0:n.toString())??""};case U.Boolean:return Wr(n)?{...t,data:n[0]!==void 0}:e.kind===U.Boolean?{...t,data:e.data}:{...t,data:!!Yf(n)};case U.Image:return Wr(n)?{...t,data:[n[0]]}:{...t,data:[(n==null?void 0:n.toString())??""]};case U.Number:return{...t,data:0};case U.Text:case U.Markdown:return Wr(n)?{...t,data:n[0].toString()??""}:{...t,data:((o=e.data)==null?void 0:o.toString())??""};case U.Custom:return t}Jf()}function Kf(e){const{getContent:t,...n}=e;return n}function Nl(e,t){const n=[{title:"First name",id:"First name",group:t?"Name":void 0,icon:Pn.HeaderString,hasMenu:!1,getContent:()=>{const i=En.name.firstName();return{kind:U.Text,displayData:i,data:i,allowOverlay:!0,readonly:!0}}},{title:"Last name",id:"Last name",group:t?"Name":void 0,icon:Pn.HeaderString,hasMenu:!1,getContent:()=>{const i=En.name.lastName();return{kind:U.Text,displayData:i,data:i,allowOverlay:!0,readonly:!0}}},{title:"Avatar",id:"Avatar",group:t?"Info":void 0,icon:Pn.HeaderImage,hasMenu:!1,getContent:()=>{const i=Math.round(Math.random()*100);return{kind:U.Image,data:[`https://picsum.photos/id/${i}/900/900`],displayData:[`https://picsum.photos/id/${i}/40/40`],allowOverlay:!0,readonly:!0}}},{title:"Email",id:"Email",group:t?"Info":void 0,icon:Pn.HeaderString,hasMenu:!1,getContent:()=>{const i=En.internet.email();return{kind:U.Text,displayData:i,data:i,allowOverlay:!0,readonly:!0}}},{title:"Title",id:"Title",group:t?"Info":void 0,icon:Pn.HeaderString,hasMenu:!1,getContent:()=>{const i=En.name.jobTitle();return{kind:U.Text,displayData:i,data:i,allowOverlay:!0,readonly:!0}}},{title:"More Info",id:"More Info",group:t?"Info":void 0,icon:Pn.HeaderUri,hasMenu:!1,getContent:()=>{const i=En.internet.url();return{kind:U.Uri,displayData:i,data:i,allowOverlay:!0,readonly:!0}}}];if(e<n.length)return n.slice(0,e);const o=e-n.length,r=[...new Array(o)].map((i,l)=>Vf(l+n.length,t));return[...n,...r]}function Vf(e,t){return{title:`Column ${e}`,id:`Column ${e}`,group:t?`Group ${Math.round(e/3)}`:void 0,icon:Pn.HeaderString,hasMenu:!1,getContent:()=>{const n=En.lorem.word();return{kind:U.Text,data:n,displayData:n,allowOverlay:!0,readonly:!0}}}}class jf{constructor(){Oe(this,"cachedContent",new Map)}get(t,n){const o=this.cachedContent.get(t);if(o!==void 0)return o[n]}set(t,n,o){let r=this.cachedContent.get(t);r===void 0&&this.cachedContent.set(t,r=[]),r[n]=o}}function qf(e,t=!0,n=!1){const o=a.useRef(new jf),[r,i]=a.useState(()=>Nl(e,n));a.useEffect(()=>{i(Nl(e,n))},[n,e]);const l=a.useCallback((g,h)=>{i(m=>{const C=m.findIndex(y=>y.title===g.title),b=[...m];return b.splice(C,1,{...m[C],width:h}),b})},[]),s=a.useMemo(()=>r.map(Kf),[r]),c=a.useRef(r);c.current=r;const f=a.useCallback(([g,h])=>{let m=o.current.get(g,h);return m===void 0&&(m=c.current[g].getContent(),!t&&Pa(m)&&(m={...m,readonly:t}),o.current.set(g,h,m)),m},[t]),d=a.useCallback(g=>{const h=[];for(let m=g.y;m<g.y+g.height;m++){const C=[];for(let b=g.x;b<g.x+g.width;b++)C.push(f([b,m]));h.push(C)}return h},[f]),p=a.useCallback(([g,h],m)=>{o.current.set(g,h,m)},[]),w=a.useCallback(([g,h],m)=>{let C=o.current.get(g,h);if(C===void 0&&(C=r[g].getContent()),eo(m)&&eo(C)){const b=_f(m,C);o.current.set(g,h,{...b,displayData:typeof b.data=="string"?b.data:b.displayData,lastUpdated:performance.now()})}},[r]);return{cols:s,getCellContent:f,onColumnResize:l,setCellValue:w,getCellsForSelection:d,setCellValueRaw:p}}function Zf(e="This should not happen"){throw new Error(e)}function Jf(e){return Zf("Hell froze over")}En.seed(1337);const Qf=Wt("div")({name:"SimpleWrapper",class:"ss4kmn3",propsAsIs:!1}),eh=e=>Xt(Qf,{children:Xt("div",{className:"content",children:e.children})}),th={title:"Extra Packages/Source",decorators:[e=>Xt(eh,{children:Xt(e,{})})]},nh=Wt("div")({name:"BeautifulStyle",class:"bkh67gx",propsAsIs:!1}),Ps=e=>{const{title:t,children:n,description:o}=e,{ref:r,width:i,height:l}=Ca();return Ei(nh,{children:[Xt("h1",{children:t}),o,Xt("div",{className:"sizer",children:Xt("div",{className:"sizer-clip",ref:r,children:Xt("div",{style:{position:"relative",width:i??100,height:l??100},children:n})})})]})},$s=Wt("p")({name:"Description",class:"d1deot3s",propsAsIs:!1}),mo=Wt("p")({name:"MoreInfo",class:"m1ml0sw1",propsAsIs:!1}),Ws={smoothScrollX:!0,smoothScrollY:!0,isDraggable:!1,rowMarkers:"none",width:"100%"},oh={accentColor:"#4F5DFF",accentFg:"#FFFFFF",accentLight:"rgba(62, 116, 253, 0.1)",textDark:"#313139",textMedium:"#737383",textLight:"#B2B2C0",textBubble:"#313139",bgIconHeader:"#737383",fgIconHeader:"#FFFFFF",textHeader:"#313139",textGroupHeader:"#313139BB",textHeaderSelected:"#FFFFFF",bgCell:"#FFFFFF",bgCellMedium:"#FAFAFB",bgHeader:"#F7F7F8",bgHeaderHasFocus:"#E9E9EB",bgHeaderHovered:"#EFEFF1",bgBubble:"#EDEDF3",bgBubbleSelected:"#FFFFFF",headerIconSize:20,markerFontStyle:"13px",bgSearchResult:"#fff9e3",borderColor:"rgba(115, 116, 131, 0.16)",horizontalBorderColor:"rgba(115, 116, 131, 0.16)",drilldownBorder:"rgba(0, 0, 0, 0)",linkColor:"#4F5DFF",cellHorizontalPadding:8,cellVerticalPadding:3,headerFontStyle:"600 13px",baseFontStyle:"13px",editorFontSize:"13px",lineHeight:1.4,fontFamily:"Inter, Roboto, -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, noto, arial, sans-serif"},rh=[{title:"A",width:200,group:"Group 1"},{title:"B",width:200,group:"Group 1"},{title:"C",width:200,group:"Group 2"},{title:"D",width:200,group:"Group 2"},{title:"E",width:200,group:"Group 2"}],Lo=()=>{const e=a.useRef({}),t=1e5,n=Pf({columns:rh,getCellContent:a.useCallback(([c,f])=>{if(c===0)return{kind:U.Text,allowOverlay:!0,data:`${f}`,displayData:`${f}`};const d=`${c},${f}`;e.current[d]===void 0&&(e.current[d]=En.name.firstName()+" "+En.name.lastName());const p=e.current[d];return{kind:U.Text,allowOverlay:!0,data:p,displayData:p}},[])}),[o,r]=a.useState(),i=Nf({columns:n.columns,getCellContent:n.getCellContent,rows:t,sort:o===void 0?void 0:{column:n.columns[o],direction:"desc",mode:"smart"}}),l=ff({columns:n.columns,theme:oh,freezeColumns:0}),s=a.useCallback(c=>{r(c)},[]);return Xt(Ps,{title:"Custom source extensions",description:Xt($s,{children:"Fixme."}),children:Xt(Ls,{...Ws,...n,...i,...l,rows:t,onColumnMoved:n.onColumnMoved,onHeaderClicked:s})})};Lo.parameters={options:{showPanel:!1}};const Po=()=>{const{cols:e,getCellContent:t,setCellValue:n}=qf(6),o=a.useRef(null),{gridSelection:r,onCellEdited:i,onGridSelectionChange:l,undo:s,canRedo:c,canUndo:f,redo:d}=Uf(o,t,n);return Xt(Ps,{title:"Undo / Redo Support",description:Ei($s,{children:["A simple undo/redo implementation",Ei(mo,{children:["Use keyboard shortcuts CMD+Z and CMD+SHIFT+Z / CTRL+Z and CTRL+Y. Or click these buttons:",Xt("button",{onClick:s,disabled:!f,style:{opacity:f?1:.4},children:"Undo"}),Xt("button",{onClick:d,disabled:!c,style:{opacity:c?1:.4},children:"Redo"})]}),Xt(mo,{children:"It works by taking a snapshot of the content of a cell before it is edited and replaying any edits back."})]}),children:Xt(Ls,{...Ws,ref:o,onCellEdited:i,getCellContent:t,gridSelection:r??void 0,onGridSelectionChange:l,columns:e,rows:1e3})})};Po.parameters={options:{showPanel:!1}};var Xl,Gl,Ul;mo.parameters={...mo.parameters,docs:{...(Xl=mo.parameters)==null?void 0:Xl.docs,source:{originalSource:`styled.p\`
    font-size: 14px;
    flex-shrink: 0;
    margin: 0 0 20px 0;

    button {
        background-color: #f4f4f4;
        color: #2b2b2b;
        padding: 2px 6px;
        font-family: monospace;
        font-size: 14px;
        border-radius: 4px;
        box-shadow: 0px 1px 2px #00000040;
        margin: 0 0.1em;
        border: none;
        cursor: pointer;
    }
\``,...(Ul=(Gl=mo.parameters)==null?void 0:Gl.docs)==null?void 0:Ul.source}}};var Yl,_l,Kl;Lo.parameters={...Lo.parameters,docs:{...(Yl=Lo.parameters)==null?void 0:Yl.docs,source:{originalSource:`() => {
  const cache = React.useRef<Record<string, string>>({});
  const rows = 100_000;
  const moveArgs = useMoveableColumns({
    columns: cols,
    getCellContent: React.useCallback(([col, row]) => {
      if (col === 0) {
        return {
          kind: GridCellKind.Text,
          allowOverlay: true,
          data: \`\${row}\`,
          displayData: \`\${row}\`
        };
      }
      const key = \`\${col},\${row}\`;
      if (cache.current[key] === undefined) {
        cache.current[key] = faker.name.firstName() + " " + faker.name.lastName();
      }
      const d = cache.current[key];
      return {
        kind: GridCellKind.Text,
        allowOverlay: true,
        data: d,
        displayData: d
      };
    }, [])
  });
  const [sort, setSort] = React.useState<number>();
  const sortArgs = useColumnSort({
    columns: moveArgs.columns,
    getCellContent: moveArgs.getCellContent,
    rows,
    sort: sort === undefined ? undefined : {
      column: moveArgs.columns[sort],
      direction: "desc",
      mode: "smart"
    }
  });
  const collapseArgs = useCollapsingGroups({
    columns: moveArgs.columns,
    theme: testTheme,
    freezeColumns: 0
  });
  const onHeaderClick = React.useCallback((index: number) => {
    setSort(index);
  }, []);
  return <BeautifulWrapper title="Custom source extensions" description={<Description>Fixme.</Description>}>
            <DataEditor {...defaultProps} {...moveArgs} {...sortArgs} {...collapseArgs} rows={rows} onColumnMoved={moveArgs.onColumnMoved} onHeaderClicked={onHeaderClick} />
        </BeautifulWrapper>;
}`,...(Kl=(_l=Lo.parameters)==null?void 0:_l.docs)==null?void 0:Kl.source}}};var Vl,jl,ql;Po.parameters={...Po.parameters,docs:{...(Vl=Po.parameters)==null?void 0:Vl.docs,source:{originalSource:`() => {
  const {
    cols: columns,
    getCellContent,
    setCellValue
  } = useMockDataGenerator(6);
  const gridRef = React.useRef<DataEditorRef>(null);
  const {
    gridSelection,
    onCellEdited,
    onGridSelectionChange,
    undo,
    canRedo,
    canUndo,
    redo
  } = useUndoRedo(gridRef, getCellContent, setCellValue);
  return <BeautifulWrapper title="Undo / Redo Support" description={<Description>
                    A simple undo/redo implementation
                    <MoreInfo>
                        Use keyboard shortcuts CMD+Z and CMD+SHIFT+Z / CTRL+Z and CTRL+Y. Or click these buttons:
                        <button onClick={undo} disabled={!canUndo} style={{
        opacity: canUndo ? 1 : 0.4
      }}>
                            Undo
                        </button>
                        <button onClick={redo} disabled={!canRedo} style={{
        opacity: canRedo ? 1 : 0.4
      }}>
                            Redo
                        </button>
                    </MoreInfo>
                    <MoreInfo>
                        It works by taking a snapshot of the content of a cell before it is edited and replaying any
                        edits back.
                    </MoreInfo>
                </Description>}>
            <DataEditor {...defaultProps} ref={gridRef} onCellEdited={onCellEdited} getCellContent={getCellContent} gridSelection={gridSelection ?? undefined} onGridSelectionChange={onGridSelectionChange} columns={columns} rows={1000} />
        </BeautifulWrapper>;
}`,...(ql=(jl=Po.parameters)==null?void 0:jl.docs)==null?void 0:ql.source}}};const ih=["MoreInfo","UseDataSource","UndoRedo"],mh=Object.freeze(Object.defineProperty({__proto__:null,MoreInfo:mo,UndoRedo:Po,UseDataSource:Lo,__namedExportsOrder:ih,default:th},Symbol.toStringTag,{value:"Module"}));export{Xd as C,yc as T,Bo as a,$a as b,eo as i,wc as m,mh as u};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./data-grid-overlay-editor-9aO4-koH.js","./index-BMVQvedj.js","./index-wocATsGp.js","./marked.esm-0svxPciP.js","./index.esm-Ejw8GwRl.js","./index-PWBWJyi_.js","./_baseIteratee-WTHxv43n.js","./throttle-7EuXLZa7.js","./iframe-vTKsg95g.js","./flatten-qRvRBp6y.js","./number-overlay-editor-kjHXBjr2.js","./react-number-format.es-2Vaki8Uh.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}